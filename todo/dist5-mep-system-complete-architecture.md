# dist5 MEPç³»ç»Ÿå®Œæ•´æ¶æ„åˆ†ææ–‡æ¡£

> **æ–‡æ¡£ç‰ˆæœ¬**: v1.0  
> **ç”Ÿæˆæ—¥æœŸ**: 2026-01-23  
> **åˆ†æèŒƒå›´**: dist5/static/-fe-pub-cmn-micro-tool-base/micros/kujiale-bim-tool-page-mep-kaf-plugin/  
> **æ•°æ®æ¥æº**: çœŸå®æºç åˆ†æï¼ˆä»…åŸºäºdist5ç›®å½•ï¼‰

---

## ğŸ“‹ ç›®å½•

1. [ç³»ç»Ÿæ¦‚è§ˆ](#1-ç³»ç»Ÿæ¦‚è§ˆ)
2. [å¼ºç”µç³»ç»Ÿæ¶æ„](#2-å¼ºç”µç³»ç»Ÿæ¶æ„)
3. [å¼±ç”µç³»ç»Ÿæ¶æ„](#3-å¼±ç”µç³»ç»Ÿæ¶æ„)
4. [ç»™æ’æ°´ç³»ç»Ÿæ¶æ„](#4-ç»™æ’æ°´ç³»ç»Ÿæ¶æ„)
5. [é‡‡æš–ç³»ç»Ÿæ¶æ„](#5-é‡‡æš–ç³»ç»Ÿæ¶æ„)
6. [åœ°æš–ç³»ç»Ÿæ¶æ„](#6-åœ°æš–ç³»ç»Ÿæ¶æ„)
7. [æ–°é£ç³»ç»Ÿæ¶æ„](#7-æ–°é£ç³»ç»Ÿæ¶æ„)
8. [æ’é£ç³»ç»Ÿæ¶æ„](#8-æ’é£ç³»ç»Ÿæ¶æ„)
9. [ç©ºè°ƒåˆ¶å†·ç³»ç»Ÿæ¶æ„](#9-ç©ºè°ƒåˆ¶å†·ç³»ç»Ÿæ¶æ„)
10. [ç®¡é“ç¢°æ’æ£€æµ‹æœºåˆ¶](#10-ç®¡é“ç¢°æ’æ£€æµ‹æœºåˆ¶)
11. [ç®¡é“é¿è®©ç®—æ³•](#11-ç®¡é“é¿è®©ç®—æ³•)
12. [AIè·¯å¾„æœç´¢ç”Ÿæˆ](#12-aiè·¯å¾„æœç´¢ç”Ÿæˆ)
13. [å›½æ ‡éªŒè¯ç³»ç»Ÿ](#13-å›½æ ‡éªŒè¯ç³»ç»Ÿ)
14. [è‡ªæ£€ç³»ç»Ÿ](#14-è‡ªæ£€ç³»ç»Ÿ)
15. [ç³»ç»Ÿç±»å‹æšä¸¾å®Œæ•´å®šä¹‰](#15-ç³»ç»Ÿç±»å‹æšä¸¾å®Œæ•´å®šä¹‰)

---

## 1. ç³»ç»Ÿæ¦‚è§ˆ

### 1.1 MEPç³»ç»Ÿæ€»æ¶æ„

**ä¸»å…¥å£æ–‡ä»¶**: `entry.3c01bf67dc49a68b970b_dewebpack.js`

**æ ¸å¿ƒæ¨¡å—åˆ†å¸ƒ**:
```
kujiale-bim-tool-page-mep-kaf-plugin/
â”œâ”€â”€ ç¢°æ’æ£€æµ‹æ¨¡å— (module_uocc.js) - 1916è¡Œ
â”œâ”€â”€ Bridgeé¿è®©ç®—æ³• (module_9ikq.js) - 366è¡Œ
â”œâ”€â”€ Lintelé¿è®©ç®—æ³• (module_3rch.js) - 404è¡Œ
â”œâ”€â”€ éªŒè¯ç³»ç»Ÿ (module_pckm.js) - 1860è¡Œ+
â”œâ”€â”€ æ•°æ®æ£€æŸ¥ (module_yy3l.js) - 39è¡Œ
â”œâ”€â”€ è¿æ¥å™¨ç®¡ç† (module_qffn.js) - 187è¡Œ
â””â”€â”€ ç³»ç»Ÿç±»å‹å®šä¹‰ (module_9wif.js, module_xbta.js)
```

### 1.2 9å¤§å­ç³»ç»Ÿåˆ†ç±»

| åºå· | ç³»ç»Ÿåç§° | ç³»ç»Ÿä»£ç  | ç®¡é“ç±»å‹æ•° | ä¸»è¦è®¾å¤‡ |
|-----|---------|---------|-----------|---------|
| 1 | âš¡ å¼ºç”µç³»ç»Ÿ | PowerCircuit | 14ç§ | å¼€å…³ã€æ’åº§ã€é…ç”µç®± |
| 2 | ğŸ”Œ å¼±ç”µç³»ç»Ÿ | WeakCurrent | 14ç§ | å¼±ç”µæ’åº§ã€é…ç”µç®± |
| 3 | ğŸ’§ ç»™æ’æ°´ç³»ç»Ÿ | Pipe | 20ç§ | æ°´æºè®¾å¤‡ã€é˜€é—¨ |
| 4 | ğŸ”¥ é‡‡æš–ç³»ç»Ÿ | DomesticHotWater | - | é‡‡æš–ç‚‰ã€åˆ†é›†æ°´å™¨ã€æ•£çƒ­å™¨ |
| 5 | ğŸŒ¡ï¸ åœ°æš–ç³»ç»Ÿ | FloorHeating | 10ç§ | åœ°æš–ç®¡é“ã€åˆ†æ°´å™¨ |
| 6 | ğŸŒªï¸ æ–°é£ç³»ç»Ÿ | VentilationFresh | 10ç§ | æ–°é£æœºã€ç®¡é“ |
| 7 | ğŸ’¨ æ’é£ç³»ç»Ÿ | VentilationDirty | 10ç§ | æ’é£ç®¡é“ |
| 8 | â„ï¸ ç©ºè°ƒåˆ¶å†·ç³»ç»Ÿ | Refrigerant | 13ç§ | åˆ¶å†·å‰‚ç®¡é“ã€åˆ†æ”¯å™¨ |
| 9 | ğŸ’¦ æ°´ç©ºè°ƒç³»ç»Ÿ | WaterAirCondition | 10ç§ | æ°´ç©ºè°ƒç®¡é“ |

---

## 2. å¼ºç”µç³»ç»Ÿæ¶æ„

### 2.1 ç³»ç»Ÿç±»å‹å®šä¹‰

**æºç ä½ç½®**: [`module_xbta.js:58-59`](dist5/static/-fe-pub-cmn-micro-tool-base/micros/kujiale-bim-tool-page-mep-kaf-plugin/entry.3c01bf67dc49a68b970b_dewebpack/module_xbta.js:58)

```javascript
(m[(m.PowerCircuit = 1)] = "PowerCircuit"),
(m[(m.Controls = 2)] = "Controls"),
```

### 2.2 ç®¡é“ç±»å‹æšä¸¾

**æºç ä½ç½®**: [`module_9wif.js:29`](dist5/static/-fe-pub-cmn-micro-tool-base/micros/kujiale-bim-tool-page-mep-kaf-plugin/entry.3c01bf67dc49a68b970b_dewebpack/module_9wif.js:29)

```javascript
// å¼ºç”µç®¡çº¿ç±»å‹
(A[(A.Conduit = 1)] = "Conduit")
```

**14ç§å¼ºç”µç®¡é“ç±»å‹** (ä»£ç 100-113):
1. `ConduitGeneral (100)` - ä¸€èˆ¬ç®¡çº¿
2. `ConduitLine (101)` - ç›´çº¿ç®¡
3. `ConduitElbow (102)` - å¼¯å¤´
4. `ConduitTee (103)` - ä¸‰é€š
5. `ConduitCross (104)` - å››é€š
6. `ConduitJointBox (105)` - æ¥çº¿ç›’
7. `ConduitLighting (106)` - ç…§æ˜çº¿
8. `ConduitPanelBox (107)` - é…ç”µç®±è¿æ¥
9. `ConduitStraightJoint (108)` - ç›´æ¥å¤´
10. `ConduitBridge (109)` - æ¡¥æ¶
11. `ConduitConnectorBox (110)` - è¿æ¥ç›’
12. `ConduitVirtualLine (111)` - è™šæ‹Ÿçº¿
13. `ConduitLintel (112)` - è¿‡æ¢
14. `ConduitBridge (109)` - æ¡¥æ¥

### 2.3 æ§åˆ¶çº¿è·¯ç³»ç»Ÿ

**æºç ä½ç½®**: [`module_xbta.js:100`](dist5/static/-fe-pub-cmn-micro-tool-base/micros/kujiale-bim-tool-page-mep-kaf-plugin/entry.3c01bf67dc49a68b970b_dewebpack/module_xbta.js:100)

```javascript
(m[(m.ControlLine = 1003)] = "ControlLine"),
(m[(m.PowerCircuitLine = 1004)] = "PowerCircuitLine"),
```

**æ§åˆ¶çº¿è·¯ç±»å‹**:
- `ControlLine (1003)` - æ§åˆ¶ä¿¡å·çº¿
- `PowerCircuitLine (1004)` - ç”µåŠ›å›è·¯çº¿

---

## 3. å¼±ç”µç³»ç»Ÿæ¶æ„

### 3.1 ç³»ç»Ÿç±»å‹å®šä¹‰

**æºç ä½ç½®**: [`module_xbta.js:69`](dist5/static/-fe-pub-cmn-micro-tool-base/micros/kujiale-bim-tool-page-mep-kaf-plugin/entry.3c01bf67dc49a68b970b_dewebpack/module_xbta.js:69)

```javascript
(m[(m.WeakCurrent = 14)] = "WeakCurrent"),
```

### 3.2 å®‰é˜²è®¾å¤‡åˆ†ç±»

**æºç ä½ç½®**: [`module_tm.js:109-114`](dist5/static/-fe-pub-cmn-micro-tool-base/micros/kujiale-bim-tool-page-mep-kaf-plugin/entry.3c01bf67dc49a68b970b_dewebpack/module_tm.js:109)

```javascript
(n[(n.SecurityOther = 4422)] = "SecurityOther"),
(n[(n.EmergencyButton = 3268)] = "EmergencyButton"),
(n[(n.Mixpad = 3928)] = "Mixpad"),
```

**9ç§å®‰é˜²æ™ºèƒ½è®¾å¤‡**:
1. æ‘„åƒå¤´
2. é—¨ç¦ç³»ç»Ÿ
3. æŠ¥è­¦å™¨
4. å¯¹è®²æœº
5. é—¨é“ƒ
6. ç´§æ€¥æŒ‰é’® (EmergencyButton = 3268)
7. æ™ºèƒ½é¢æ¿ (Mixpad = 3928)
8. è§¦æ‘¸é¢æ¿
9. å…¶ä»–å®‰é˜²è®¾å¤‡ (SecurityOther = 4422)

---

## 4. ç»™æ’æ°´ç³»ç»Ÿæ¶æ„

### 4.1 ç³»ç»Ÿç±»å‹å®šä¹‰

**æºç ä½ç½®**: [`module_xbta.js:60-62`](dist5/static/-fe-pub-cmn-micro-tool-base/micros/kujiale-bim-tool-page-mep-kaf-plugin/entry.3c01bf67dc49a68b970b_dewebpack/module_xbta.js:60)

```javascript
(m[(m.DomesticHotWater = 4)] = "DomesticHotWater"),        // ç”Ÿæ´»çƒ­æ°´
(m[(m.DomesticColdWater = 5)] = "DomesticColdWater"),      // ç”Ÿæ´»å†·æ°´
(m[(m.DomesticWater = 7)] = "DomesticWater"),              // ç”Ÿæ´»ç”¨æ°´
(m[(m.DrainWater = 17)] = "DrainWater"),                   // æ’æ°´
```

### 4.2 ç®¡é“ç±»å‹æšä¸¾

**20ç§ç»™æ°´ç®¡é“ç±»å‹** (ä»£ç 200-220):

**æºç ä½ç½®**: [`module_9wif.js:84-104`](dist5/static/-fe-pub-cmn-micro-tool-base/micros/kujiale-bim-tool-page-mep-kaf-plugin/entry.3c01bf67dc49a68b970b_dewebpack/module_9wif.js:84)

1. `PipeGeneral (200)` - é€šç”¨ç®¡é“
2. `PipeLine (201)` - ç›´ç®¡
3. `PipeElbow (202)` - 90Â°å¼¯å¤´
4. `PipeElbow45 (203)` - 45Â°å¼¯å¤´
5. `PipeTee (204)` - ä¸‰é€š
6. `PipeUnion (205)` - æ´»æ¥
7. `PipeBridge (206)` - æ¡¥æ¥
8. `PipeCap (207)` - ç®¡å¸½
9. `PipeThreadedElbow (208)` - èºçº¹å¼¯å¤´
10. `PipeThreadedCap (209)` - èºçº¹ç®¡å¸½
11. `PipeThreadedUnion (210)` - èºçº¹æ´»æ¥
12. `PipeThreadedTee (211)` - èºçº¹ä¸‰é€š
13. `PipeTransition (212)` - å˜å¾„
14. `PipeBallValve (213)` - çƒé˜€
15. `PipeKitzValue (214)` - æˆªæ­¢é˜€
16. `PipeThreadedElbowWithCap (215)` - å¸¦å¸½èºçº¹å¼¯å¤´
17. `PipeVirtualLine (216)` - è™šæ‹Ÿçº¿
18. `PipeVirtualBox (217)` - è™šæ‹Ÿç›’
19. `PipeConnectorBox (218)` - è¿æ¥ç›’
20. `PipeStraightJoint (219)` - ç›´æ¥å¤´
21. `PipeLintel (220)` - è¿‡æ¢

### 4.3 æ°´æºè®¾å¤‡åˆ†ç±»

**æºç ä½ç½®**: [`module_tm.js:141-159`](dist5/static/-fe-pub-cmn-micro-tool-base/micros/kujiale-bim-tool-page-mep-kaf-plugin/entry.3c01bf67dc49a68b970b_dewebpack/module_tm.js:141)

```javascript
// å‡€æ°´è®¾å¤‡
(n[(n.WPKitchenWaterPurifier = 3244)] = "WPKitchenWaterPurifier"),
(n[(n.WPPipelineMachine = 3245)] = "WPPipelineMachine"),
(n[(n.WPWaterDistributor = 3246)] = "WPWaterDistributor"),

// æ°´ç©ºè°ƒè®¾å¤‡
(n[(n.WaterAirCondition = 3612)] = "WaterAirCondition"),
(n[(n.WaterAirConditionIn = 3613)] = "WaterAirConditionIn"),
(n[(n.WaterAirConditionOut = 3614)] = "WaterAirConditionOut"),
(n[(n.WaterPump = 3615)] = "WaterPump"),
```

**6ç§æ°´æºè®¾å¤‡**:
1. å¨æˆ¿å‡€æ°´å™¨ (WPKitchenWaterPurifier = 3244)
2. ç®¡çº¿æœº (WPPipelineMachine = 3245)
3. åˆ†æ°´å™¨ (WPWaterDistributor = 3246)
4. æ°´ç©ºè°ƒ (WaterAirCondition = 3612)
5. æ°´ç©ºè°ƒè¿›æ°´ (WaterAirConditionIn = 3613)
6. æ°´ç©ºè°ƒå‡ºæ°´ (WaterAirConditionOut = 3614)
7. æ°´æ³µ (WaterPump = 3615)

---

## 5. é‡‡æš–ç³»ç»Ÿæ¶æ„

### 5.1 ç³»ç»Ÿç±»å‹å®šä¹‰

**æºç ä½ç½®**: [`module_xbta.js:60`](dist5/static/-fe-pub-cmn-micro-tool-base/micros/kujiale-bim-tool-page-mep-kaf-plugin/entry.3c01bf67dc49a68b970b_dewebpack/module_xbta.js:60)

```javascript
(m[(m.DomesticHotWater = 4)] = "DomesticHotWater"),
```

### 5.2 é‡‡æš–è®¾å¤‡åˆ†ç±»

**æºç ä½ç½®**: [`module_tm.js:110-137`](dist5/static/-fe-pub-cmn-micro-tool-base/micros/kujiale-bim-tool-page-mep-kaf-plugin/entry.3c01bf67dc49a68b970b_dewebpack/module_tm.js:110)

```javascript
// é‡‡æš–ç‚‰
(n[(n.FloorHeatingStove = 3258)] = "FloorHeatingStove"),

// åˆ†é›†æ°´å™¨
(n[(n.FloorHeatingDistributionManifold = 3259)] = "FloorHeatingDistributionManifold"),

// æ•£çƒ­å™¨
(n[(n.FloorHeatingRadiator = 3260)] = "FloorHeatingRadiator"),

// å…¶ä»–é‡‡æš–è®¾å¤‡
(n[(n.FloorHeatingHydraulicModule = 4269)] = "FloorHeatingHydraulicModule"),
(n[(n.FloorHeatingAirSourceHeatPump = 4260)] = "FloorHeatingAirSourceHeatPump"),
(n[(n.FloorHeatingWaterHeater = 4263)] = "FloorHeatingWaterHeater"),
(n[(n.FloorHeatingWaterTank = 4264)] = "FloorHeatingWaterTank"),
(n[(n.FloorHeatingGroundSourceHeatPump = 4261)] = "FloorHeatingGroundSourceHeatPump"),
(n[(n.FloorHeatingWaterSourceHeatPump = 4262)] = "FloorHeatingWaterSourceHeatPump"),
(n[(n.FloorHeatingGasWaterHeater = 
3783)] = "FloorHeatingGasWaterHeater"),
(n[(n.FloorHeatingOtherWaterHeater = 369)] = "FloorHeatingOtherWaterHeater"),
(n[(n.UnderfloorHeatingTerminal = 4421)] = "UnderfloorHeatingTerminal"),
```

**é‡‡æš–è®¾å¤‡æ¸…å•**:
1. é‡‡æš–ç‚‰ (FloorHeatingStove = 3258)
2. åˆ†é›†æ°´å™¨ (FloorHeatingDistributionManifold = 3259)
3. æ•£çƒ­å™¨ (FloorHeatingRadiator = 3260)
4. æ¶²å‹æ¨¡å— (FloorHeatingHydraulicModule = 4269)
5. ç©ºæ°”æºçƒ­æ³µ (FloorHeatingAirSourceHeatPump = 4260)
6. çƒ­æ°´å™¨ (FloorHeatingWaterHeater = 4263)
7. æ°´ç®± (FloorHeatingWaterTank = 4264)
8. åœ°æºçƒ­æ³µ (FloorHeatingGroundSourceHeatPump = 4261)
9. æ°´æºçƒ­æ³µ (FloorHeatingWaterSourceHeatPump = 4262)
10. ç‡ƒæ°”çƒ­æ°´å™¨ (FloorHeatingGasWaterHeater = 3783)
11. å…¶ä»–çƒ­æ°´å™¨ (FloorHeatingOtherWaterHeater = 369)
12. åœ°æš–æœ«ç«¯ (UnderfloorHeatingTerminal = 4421)

---

## 6. åœ°æš–ç³»ç»Ÿæ¶æ„

### 6.1 ç³»ç»Ÿç±»å‹å®šä¹‰

**æºç ä½ç½®**: [`module_xbta.js:70`](dist5/static/-fe-pub-cmn-micro-tool-base/micros/kujiale-bim-tool-page-mep-kaf-plugin/entry.3c01bf67dc49a68b970b_dewebpack/module_xbta.js:70)

```javascript
(m[(m.FloorHeating = 15)] = "FloorHeating"),
```

**æºç ä½ç½®**: [`module_9wif.js:36`](dist5/static/-fe-pub-cmn-micro-tool-base/micros/kujiale-bim-tool-page-mep-kaf-plugin/entry.3c01bf67dc49a68b970b_dewebpack/module_9wif.js:36)

```javascript
(A[(A.FloorHeating = 8)] = "FloorHeating"),
```

### 6.2 åœ°æš–ç®¡é“ç±»å‹

**10ç§åœ°æš–ç®¡é“** (ä»£ç 600-610):

**æºç ä½ç½®**: [`module_9wif.js:138-148`](dist5/static/-fe-pub-cmn-micro-tool-base/micros/kujiale-bim-tool-page-mep-kaf-plugin/entry.3c01bf67dc49a68b970b_dewebpack/module_9wif.js:138)

```javascript
(A[(A.FloorHeatingGeneral = 600)] = "FloorHeatingGeneral"),
(A[(A.FloorHeatingLine = 601)] = "FloorHeatingLine"),
(A[(A.FloorHeatingElbow = 602)] = "FloorHeatingElbow"),
(A[(A.FloorHeatingVirtualBox = 603)] = "FloorHeatingVirtualBox"),
(A[(A.FloorHeatingVirtualLine = 604)] = "FloorHeatingVirtualLine"),
(A[(A.FloorHeatingConnectorBox = 605)] = "FloorHeatingConnectorBox"),
(A[(A.FloorHeatingStraightJoint = 606)] = "FloorHeatingStraightJoint"),
(A[(A.FloorHeatingBridge = 607)] = "FloorHeatingBridge"),
(A[(A.FloorHeatingVirtual = 608)] = "FloorHeatingVirtual"),
(A[(A.FloorHeatingLintel = 609)] = "FloorHeatingLintel"),
(A[(A.FloorHeatingTee = 610)] = "FloorHeatingTee"),
```

### 6.3 åœ°æš–å­ç±»å‹

**æºç ä½ç½®**: [`module_xbta.js:101-106`](dist5/static/-fe-pub-cmn-micro-tool-base/micros/kujiale-bim-tool-page-mep-kaf-plugin/entry.3c01bf67dc49a68b970b_dewebpack/module_xbta.js:101)

```javascript
(m[(m.FloorHeatingSupply = 15001)] = "FloorHeatingSupply"),        // ä¾›æ°´
(m[(m.FloorHeatingBack = 15002)] = "FloorHeatingBack"),            // å›æ°´
(m[(m.FloorHeatingPass = 15003)] = "FloorHeatingPass"),            // è¿‡è·¯
(m[(m.FloorHeatingCoil = 15004)] = "FloorHeatingCoil"),            // ç›˜ç®¡
(m[(m.FloorHeatingJointIn = 15005)] = "FloorHeatingJointIn"),      // è¿›æ°´æ¥å¤´
(m[(m.FloorHeatingJointOut = 15006)] = "FloorHeatingJointOut"),    // å‡ºæ°´æ¥å¤´
```

### 6.4 ç¢°æ’æ£€æµ‹é…ç½®

**æºç ä½ç½®**: [`module_uocc.js:59-64`](dist5/static/-fe-pub-cmn-micro-tool-base/micros/kujiale-bim-tool-page-mep-kaf-plugin/entry.3c01bf67dc49a68b970b_dewebpack/module_uocc.js:59)

```javascript
case K.b.FloorHeating:
return {
    detectTube: !1,    // ä¸æ£€æµ‹ç®¡é“ç¢°æ’
    detectBeam: !1     // ä¸æ£€æµ‹æ¢ç¢°æ’
};
```

**è¯´æ˜**: åœ°æš–ç³»ç»Ÿä¸è¿›è¡Œç¢°æ’æ£€æµ‹ï¼Œå› ä¸ºç®¡é“é“ºè®¾åœ¨åœ°é¢ä¸‹æ–¹ã€‚

---

## 7. æ–°é£ç³»ç»Ÿæ¶æ„

### 7.1 ç³»ç»Ÿç±»å‹å®šä¹‰

**æºç ä½ç½®**: [`module_xbta.js:67`](dist5/static/-fe-pub-cmn-micro-tool-base/micros/kujiale-bim-tool-page-mep-kaf-plugin/entry.3c01bf67dc49a68b970b_dewebpack/module_xbta.js:67)

```javascript
(m[(m.VentilationFreshAir = 12)] = "VentilationFreshAir"),
```

**æºç ä½ç½®**: [`module_9wif.js:33`](dist5/static/-fe-pub-cmn-micro-tool-base/micros/kujiale-bim-tool-page-mep-kaf-plugin/entry.3c01bf67dc49a68b970b_dewebpack/module_9wif.js:33)

```javascript
(A[(A.VentilationFresh = 5)] = "VentilationFresh"),
```

### 7.2 æ–°é£ç®¡é“ç±»å‹

**10ç§æ–°é£ç®¡é“** (ä»£ç 500-509):

**æºç ä½ç½®**: [`module_9wif.js:128-137`](dist5/static/-fe-pub-cmn-micro-tool-base/micros/kujiale-bim-tool-page-mep-kaf-plugin/entry.3c01bf67dc49a68b970b_dewebpack/module_9wif.js:128)

```javascript
(A[(A.VentilationGeneral = 500)] = "VentilationGeneral"),
(A[(A.VentilationLine = 501)] = "VentilationLine"),
(A[(A.VentilationElbow = 502)] = "VentilationElbow"),
(A[(A.VentilationTee = 503)] = "VentilationTee"),
(A[(A.VentilationVirtualBox = 504)] = "VentilationVirtualBox"),
(A[(A.VentilationVirtualLine = 505)] = "VentilationVirtualLine"),
(A[(A.VentilationConnectorBox = 506)] = "VentilationConnectorBox"),
(A[(A.VentilationStraightJoint = 507)] = "VentilationStraightJoint"),
(A[(A.VentilationLintel = 508)] = "VentilationLintel"),
(A[(A.VentilationBridge = 509)] = "VentilationBridge"),
```

### 7.3 ç¢°æ’æ£€æµ‹é…ç½®

**æºç ä½ç½®**: [`module_uocc.js:45-51`](dist5/static/-fe-pub-cmn-micro-tool-base/micros/kujiale-bim-tool-page-mep-kaf-plugin/entry.3c01bf67dc49a68b970b_dewebpack/module_uocc.js:45)

```javascript
case K.b.VentilationFresh:
return {
    detectTube: !0,    // æ£€æµ‹ç®¡é“ç¢°æ’
    detectBeam: !0     // æ£€æµ‹æ¢ç¢°æ’
};
```

---

## 8. æ’é£ç³»ç»Ÿæ¶æ„

### 8.1 ç³»ç»Ÿç±»å‹å®šä¹‰

**æºç ä½ç½®**: [`module_xbta.js:68`](dist5/static/-fe-pub-cmn-micro-tool-base/micros/kujiale-bim-tool-page-mep-kaf-plugin/entry.3c01bf67dc49a68b970b_dewebpack/module_xbta.js:68)

```javascript
(m[(m.VentilationDirtyAir = 13)] = "VentilationDirtyAir"),
```

**æºç ä½ç½®**: [`module_9wif.js:34`](dist5/static/-fe-pub-cmn-micro-tool-base/micros/kujiale-bim-tool-page-mep-kaf-plugin/entry.3c01bf67dc49a68b970b_dewebpack/module_9wif.js:34)

```javascript
(A[(A.VentilationDirty = 6)] = "VentilationDirty"),
```

### 8.2 æ’é£ç®¡é“ç±»å‹

**10ç§æ’é£ç®¡é“** (ä¸æ–°é£ç³»ç»Ÿç›¸åŒç»“æ„ï¼Œä»£ç 500-509)

### 8.3 ç¢°æ’æ£€æµ‹é…ç½®

**æºç ä½ç½®**: [`module_uocc.js:45-51`](dist5/static/-fe-pub-cmn-micro-tool-base/micros/kujiale-bim-tool-page-mep-kaf-plugin/entry.3c01bf67dc49a68b970b_dewebpack/module_uocc.js:45)

```javascript
case K.b.VentilationDirty:
return {
    detectTube: !0,    // æ£€æµ‹ç®¡é“ç¢°æ’
    detectBeam: !0     // æ£€æµ‹æ¢ç¢°æ’
};
```

---

## 9. ç©ºè°ƒåˆ¶å†·ç³»ç»Ÿæ¶æ„

### 9.1 ç³»ç»Ÿç±»å‹å®šä¹‰

**æºç ä½ç½®**: [`module_xbta.js:63-66`](dist5/static/-fe-pub-cmn-micro-tool-base/micros/kujiale-bim-tool-page-mep-kaf-plugin/entry.3c01bf67dc49a68b970b_dewebpack/module_xbta.js:63)

```javascript
(m[(m.Refrigerant = 8)] = "Refrigerant"),                    // åˆ¶å†·å‰‚
(m[(m.Refrigerant_Gas = 9)] = "Refrigerant_Gas"),            // æ°”æ€åˆ¶å†·å‰‚
(m[(m.Refrigerant_Liquid = 10)] = "Refrigerant_Liquid"),      // æ¶²æ€åˆ¶å†·å‰‚
(m[(m.Condensation = 11)] = "Condensation"),                  // å†·å‡æ°´
(m[(m.Refrigerant_Pressure = 18)] = "Refrigerant_Pressure"),  // å‹åŠ›åˆ¶å†·å‰‚
```

**æºç ä½ç½®**: [`module_9wif.js:31-32`](dist5/static/-fe-pub-cmn-micro-tool-base/micros/kujiale-bim-tool-page-mep-kaf-plugin/entry.3c01bf67dc49a68b970b_dewebpack/module_9wif.js:31)

```javascript
(A[(A.Refrigerant = 3)] = "Refrigerant"),
(A[(A.Condensation = 4)] = "Condensation"),
```

### 9.2 åˆ¶å†·å‰‚ç®¡é“ç±»å‹

**13ç§åˆ¶å†·å‰‚ç®¡é“** (ä»£ç 300-312):

**æºç ä½ç½®**: [`module_9wif.js:105-117`](dist5/static/-fe-pub-cmn-micro-tool-base/micros/kujiale-bim-tool-page-mep-kaf-plugin/entry.3c01bf67dc49a68b970b_dewebpack/module_9wif.js:105)

```javascript
(A[(A.RefrigerantGeneral = 300)] = "RefrigerantGeneral"),
(A[(A.RefrigerantLine = 301)] = "RefrigerantLine"),
(A[(A.RefrigerantElbow = 302)] = "RefrigerantElbow"),
(A[(A.RefrigerantBranchY = 303)] = "RefrigerantBranchY"),          // Yå‹åˆ†æ”¯
(A[(A.RefrigerantBranchU = 304)] = "RefrigerantBranchU"),          // Uå‹åˆ†æ”¯
(A[(A.RefrigerantVirtualBox = 305)] = "RefrigerantVirtualBox"),
(A[(A.RefrigerantConnectorBox = 306)] = "RefrigerantConnectorBox"),
(A[(A.RefrigerantVirtualLine = 307)] = "RefrigerantVirtualLine"),
(A[(A.RefrigerantStraightJoint = 308)] = "RefrigerantStraightJoint"),
(A[(A.RefrigerantBridge = 309)] = "RefrigerantBridge"),
(A[(A.RefrigerantVirtual = 310)] = "RefrigerantVirtual"),
(A[(A.RefrigerantLintel = 311)] = "RefrigerantLintel"),
(A[(A.RefrigerantTee = 312)] = "RefrigerantTee"),
```

### 9.3 å†·å‡æ°´ç®¡é“ç±»å‹

**10ç§å†·å‡æ°´ç®¡é“** (ä»£ç 400-409):

**æºç ä½ç½®**: [`module_9wif.js:118-127`](dist5/static/-fe-pub-cmn-micro-tool-base/micros/kujiale-bim-tool-page-mep-kaf-plugin/entry.3c01bf67dc49a68b970b_dewebpack/module_9wif.js:118)

```javascript
(A[(A.CondensationGeneral = 400)] = "CondensationGeneral"),
(A[(A.CondensationLine = 401)] = "CondensationLine"),
(A[(A.CondensationElbow = 402)] = "CondensationElbow"),
(A[(A.CondensationTee = 403)] = "CondensationTee"),
(A[(A.CondensationVirtualBox = 404)] = "CondensationVirtualBox"),
(A[(A.CondensationVirtualLine = 405)] = "CondensationVirtualLine"),
(A[(A.CondensationConnectorBox = 406)] = "CondensationConnectorBox"),
(A[(A.CondensationStraightJoint = 407)] = "CondensationStraightJoint"),
(A[(A.CondensationBridge = 408)] = "CondensationBridge"),
(A[(A.CondensationLintel = 409)] = "CondensationLintel"),
```

---

## 10. ç®¡é“ç¢°æ’æ£€æµ‹æœºåˆ¶

### 10.1 ç¢°æ’æ£€æµ‹æ¡†æ¶

**æ ¸å¿ƒæ¨¡å—**: [`module_uocc.js`](dist5/static/-fe-pub-cmn-micro-tool-base/micros/kujiale-bim-tool-page-mep-kaf-plugin/entry.3c01bf67dc49a68b970b_dewebpack/module_uocc.js)

**ç±»å®šä¹‰**: `class Ee` (è¡Œ203-1128)

**æºç ä½ç½®**: [`module_uocc.js:205-210`](dist5/static/-fe-pub-cmn-micro-tool-base/micros/kujiale-bim-tool-page-mep-kaf-plugin/entry.3c01bf67dc49a68b970b_dewebpack/module_uocc.js:205)

```javascript
function at(ke) {
    (this.collisionDetectionMap = new Map()),    // ç¢°æ’æ£€æµ‹æ˜ å°„è¡¨
    (this.vertices = new Set()),                  // é¡¶ç‚¹é›†åˆ
    (this.edges = new Set()),                     // è¾¹é›†åˆ
    (this.generator = ke);                        // ç”Ÿæˆå™¨
}
```

### 10.2 ç¢°æ’æ£€æµ‹é…ç½®

**å‡½æ•°**: `getCollisionConfig(layoutType)`

**æºç ä½ç½®**: [`module_uocc.js:43-73`](dist5/static/-fe-pub-cmn-micro-tool-base/micros/kujiale-bim-tool-page-mep-kaf-plugin/entry.3c01bf67dc49a68b970b_dewebpack/module_uocc.js:43)

```javascript
function l(at) {
    var ke = M.MepPlugin.stateManager.functionPanel.drawTubeFunctionPanel.getShape();
    if (ke && Object(C.j)(ke)) return {
        detectTube: !1,    // æ–¹ç®¡ä¸æ£€æµ‹
        detectBeam: !1
    };
    
    var $require = {
        detectTube: !0,    // é»˜è®¤æ£€æµ‹ç®¡é“
        detectBeam: !1     // é»˜è®¤ä¸æ£€æµ‹æ¢
    };
    
    switch (at) {
        case K.b.VentilationDirty:
        case K.b.VentilationFresh:
            return {
                detectTube: !0,    // æ–°é£/æ’é£æ£€æµ‹ç®¡é“
                detectBeam: !0     // æ–°é£/æ’é£æ£€æµ‹æ¢
            };
        
        case K.b.WaterAirCondition:
        case K.b.DrainWater:
            return {
                detectTube: !0,    // æ°´ç©ºè°ƒ/æ’æ°´æ£€æµ‹ç®¡é“
                detectBeam: !0     // æ°´ç©ºè°ƒ/æ’æ°´æ£€æµ‹æ¢
            };
        
        case K.b.FloorHeating:
            return {
                detectTube: !1,    // åœ°æš–ä¸æ£€æµ‹ç®¡é“
                detectBeam: !1     // åœ°æš–ä¸æ£€æµ‹æ¢
            };
        
        case K.b.MepCommon:
            return {
                detectTube: !1,    // é€šç”¨MEPä¸æ£€æµ‹
                detectBeam: !1
            };
        
        default:
            return $require;
    }
}
```

### 10.3 ç¢°æ’æ£€æµ‹æµç¨‹

**æºç ä½ç½®**: [`module_uocc.js:222-248`](dist5/static/-fe-pub-cmn-micro-tool-base/micros/kujiale-bim-tool-page-mep-kaf-plugin/entry.3c01bf67dc49a68b970b_dewebpack/module_uocc.js:222)

```javascript
(at.prototype.convert = function (ke) {
    var $require = ke.start,
    dt = ke.end,
    pt = ke.layoutType,
    It = ke.vectors,
    Et = ke.referenceLibParameters,
    xt = this.getCollisionConfig(pt);
    
    // æ­¥éª¤1: æ·»åŠ ç®¡é“æ¡¥æ¥ç¢°æ’æ£€æµ‹
    xt.detectTube && this.addBridge(It, pt),
    
    // æ­¥éª¤2: æ·»åŠ æ¢ç¢°æ’æ£€æµ‹
    xt.detectBeam && this.addLintel(It);
    
    // æ­¥éª¤3: å¤„ç†èµ·ç‚¹å’Œç»ˆç‚¹å…ƒç´ 
    var Rt = $require.element,
    Vt = dt.element;
    this.handleStartElementAndEndElement(Rt, Vt, ke),
    
    // æ­¥éª¤4: 
è®¾ç½®è¿æ¥å™¨å‚æ•°æ˜ å°„
    this.setConnectorParameterMap(this.edges, this.vertices, Et),
    
    // æ­¥éª¤5: æ¸…ç©ºç¢°æ’æ£€æµ‹æ˜ å°„
    this.collisionDetectionMap.clear();
    
    // æ­¥éª¤6: è¿”å›è·¯å¾„å¯¹è±¡
    var bt = Array.from(this.vertices),
    Tt = Array.from(this.edges);
    this.reversePathForSquareTube(Tt, bt, Rt, Vt);
    var St = new B.a();
    return (
        St.setVertexes(bt),
        St.setEdges(Tt),
        this.vertices.clear(),
        this.edges.clear(),
        St
    );
})
```

### 10.4 Bridgeç¢°æ’æ£€æµ‹

**æ·»åŠ ç®¡é“æ¡¥æ¥ç¢°æ’**: `addBridge(vectors, layoutType)`

**æºç ä½ç½®**: [`module_uocc.js:774-970`](dist5/static/-fe-pub-cmn-micro-tool-base/micros/kujiale-bim-tool-page-mep-kaf-plugin/entry.3c01bf67dc49a68b970b_dewebpack/module_uocc.js:774)

**æ ¸å¿ƒç®—æ³•**:
```javascript
(at.prototype.addBridge = function (ke, $require) {
    // 1. è·å–ç›¸åŒç±»å‹çš„ç®¡é“ç³»ç»Ÿ
    var xt = [$require];
    $require === K.b.VentilationDirty
        ? xt.push(K.b.VentilationFresh)
        : $require === K.b.VentilationFresh
        ? xt.push(K.b.VentilationDirty)
        : $require === K.b.Refrigerant
        ? xt.push(K.b.Condensation)
        : $require === K.b.Condensation && xt.push(K.b.Refrigerant);
    
    // 2. è·å–æ‰€æœ‰ç›¸å…³çš„ç®¡é“è¾¹
    var Vt = Rt.map(function (Pt) {
        return Pt.getPathArray().map(function (Ut) {
            return Ut.getEdgesArray();
        });
    }).flat(2);
    
    // 3. éå†è·¯å¾„ç‚¹æ£€æµ‹ç¢°æ’
    for (var St = ke.length - 1; St > 0; --St) {
        var ct = a.Point3d.fromObject(ke[St]),
        _t = a.Point3d.fromObject(ke[St - 1]),
        tt = new a.LineSeg3d(_t, ct);
        
        // 4. æ£€æµ‹ä¸æ¯æ¡ç®¡é“çš„äº¤ç‚¹
        Vt.forEach(function (kn) {
            var Nr = kn.getLinkedTube();
            if (!Nr || ee.a.isVirtual(Nr)) return;
            
            var br = Nr.getLocationCurve()?.getCurve();
            if (!br) return;
            
            var Dr = new a.LineSeg3d(
                a.Point3d.fromObject(br.getStartPt()),
                a.Point3d.fromObject(br.getEndPt())
            );
            
            // 5. è®¡ç®—çº¿æ®µäº¤ç‚¹
            var vo = tt.intersectCurve(
                Dr,
                new a.Tolerance.Tolerance(0.001, 10, 0.001)
            );
            
            if (vo.length === 1) {
                var ur = vo[0].point;
                
                // 6. éªŒè¯äº¤ç‚¹æœ‰æ•ˆæ€§
                if (!tt.isPointOnCurve(ur, R.n)) {
                    ur = tt.getProjection(ur);
                }
                
                // 7. æ£€æŸ¥æœ€å°é—´è·ï¼ˆç®¡å¾„çš„1.5å€ï¼‰
                if (ur) {
                    var fr = ur.distanceTo(_t),
                    ci = ur.distanceTo(ct),
                    Wi = (Nr.getDiameter() * 3) / 2;
                    
                    if (fr < Wi || ci < Wi) {
                        ur = null;  // è·ç¦»å¤ªè¿‘ï¼Œå¿½ç•¥
                    } else {
                        // 8. ä¿å­˜ç¢°æ’ç‚¹
                        et.push({
                            intersectEdge: kn,
                            intersectPoint: ur,
                        });
                    }
                }
            }
        });
        
        // 9. ä¿å­˜ç¢°æ’æ£€æµ‹ç»“æœåˆ°Map
        var en = new E.a(Wt);
        Tt.collisionDetectionMap.set(en, {
            type: K.d.Bridge,              // ç¢°æ’ç±»å‹ï¼šæ¡¥æ¥
            collisionObject: Qt,           // ç¢°æ’å¯¹è±¡
            intersectPoint: Wt,            // äº¤ç‚¹
            extraInfo: {
                transform: nn              // å˜æ¢çŸ©é˜µ
            },
        });
    }
})
```

### 10.5 Lintelç¢°æ’æ£€æµ‹

**æ·»åŠ æ¢ç¢°æ’**: `addLintel(vectors)`

**æºç ä½ç½®**: [`module_uocc.js:972-1004`](dist5/static/-fe-pub-cmn-micro-tool-base/micros/kujiale-bim-tool-page-mep-kaf-plugin/entry.3c01bf67dc49a68b970b_dewebpack/module_uocc.js:972)

```javascript
(at.prototype.addLintel = function (ke) {
    // 1. è·å–KAMå…ƒç´ ï¼ˆå»ºç­‘æ„ä»¶ï¼‰
    var $require = this.generator.getMepDesign(),
    dt = $require.getKamElements(),
    pt = dt.kamElements,
    It = dt.levelHeight,
    
    // 2. ç­›é€‰æ¢æ„ä»¶
    Et = pt.filter(function (Ut) {
        return Ut instanceof i.Beam;
    });
    
    // 3. éå†è·¯å¾„ç‚¹æ£€æµ‹ä¸æ¢çš„ç¢°æ’
    for (var xt = ke.length - 1; xt > 0; --xt) {
        var Rt = O.a.detectCollisionWithBeams(
            ke[xt - 1], 
            ke[xt], 
            {
                kamElements: Et,
                levelHeight: It,
            }
        );
        
        // 4. ä¿å­˜ç¢°æ’ç»“æœ
        if (!!Rt.length) {
            for (var Vt = [], bt = Rt.length, Tt = 0; Tt < bt; ++Tt) {
                var St = Rt[Tt],
                Pt = new E.a(St.intersectPoint);
                Vt.push(Pt);
                
                // 5. æ·»åŠ åˆ°ç¢°æ’æ£€æµ‹æ˜ å°„
                this.collisionDetectionMap.set(Pt, St);
            }
            
            // 6. å°†ç¢°æ’ç‚¹æ’å…¥è·¯å¾„
            ke.splice.apply(ke, te([xt, 0], ce(Vt), !1));
        }
    }
})
```

---

## 11. ç®¡é“é¿è®©ç®—æ³•

### 11.1 Bridgeé¿è®©ç®—æ³•

**æ ¸å¿ƒæ¨¡å—**: [`module_9ikq.js`](dist5/static/-fe-pub-cmn-micro-tool-base/micros/kujiale-bim-tool-page-mep-kaf-plugin/entry.3c01bf67dc49a68b970b_dewebpack/module_9ikq.js)

**ç±»å®šä¹‰**: `class a extends m.a`

### 11.2 é¿è®©å‚æ•°é…ç½®

**æºç ä½ç½®**: [`module_9ikq.js:133-144`](dist5/static/-fe-pub-cmn-micro-tool-base/micros/kujiale-bim-tool-page-mep-kaf-plugin/entry.3c01bf67dc49a68b970b_dewebpack/module_9ikq.js:133)

```javascript
(c.prototype.initState = function (b) {
    b === void 0 && (b = {}),
    this.updateState(
        u(u({}, b), {
            avoidPath: [],              // é¿è®©è·¯å¾„
            avoidanceDirection: 0,      // é¿è®©æ–¹å‘ï¼ˆ0, 1, 2...ï¼‰
            angle: 45                   // é¿è®©è§’åº¦ï¼ˆé»˜è®¤45Â°ï¼‰
        })
    );
})
```

**é¿è®©æ–¹å‘åˆ‡æ¢**:

**æºç ä½ç½®**: [`module_9ikq.js:161-168`](dist5/static/-fe-pub-cmn-micro-tool-base/micros/kujiale-bim-tool-page-mep-kaf-plugin/entry.3c01bf67dc49a68b970b_dewebpack/module_9ikq.js:161)

```javascript
(c.prototype.switchAvoidanceDirection = function () {
    var b = this.state.avoidanceDirection;
    this.mergeState({
        avoidanceDirection: b + 1    // å¾ªç¯åˆ‡æ¢æ–¹å‘
    });
})
```

### 11.3 Bridgeé¿è®©è·¯å¾„ç”Ÿæˆ

**æ ¸å¿ƒå‡½æ•°**: `generateAvoidPath(params)`

**æºç ä½ç½®**: [`module_9ikq.js:192-276`](dist5/static/-fe-pub-cmn-micro-tool-base/micros/kujiale-bim-tool-page-mep-kaf-plugin/entry.3c01bf67dc49a68b970b_dewebpack/module_9ikq.js:192)

**ç®—æ³•æ­¥éª¤**:

```javascript
(c.prototype.generateAvoidPath = function (b) {
    var E = this,
    P,
    j = this.tubeCollisionAvoidance.getEditTube(),
    Y = this.collisionResult,
    B = this.tubeCollisionAvoidance.getAllSelectedTubes();
    
    if (!j || !Y || (B == null ? void 0 : B.length) === 0) return [];
    
    var v = Y.intersectPoint,    // ç¢°æ’ç‚¹
    F = Y.extraInfo,
    k = F === void 0 ? {} : F,
    Z = [],                      // é¿è®©è·¯å¾„ç»“æœ
    z = b.avoidanceDirection,    // é¿è®©æ–¹å‘
    $ = b.angle;                 // é¿è®©è§’åº¦
    
    Y.extraInfo = k;
    
    // æ­¥éª¤1: è·å–ç¼–è¾‘ç®¡é“çš„åˆ‡çº¿æ–¹å‘
    var w = j.getLayoutRef(),
    R = w.getTangent(w.getVertices()[0]).clone(),
    
    // æ­¥éª¤2: è®¡ç®—å‚ç›´å¹³é¢
    X = this.getPerpendicularPlane(R, new f.a(v));
    
    return (
        B == null ||
        B.forEach(function (ae) {
            var oe,
            ee,
            ne = ae.getLayoutRef();
            
            if (ne instanceof M.b) {
                // æ­¥éª¤3: è®¡ç®—ç®¡é“åˆ‡çº¿å’Œå°„çº¿
                var pe = ne.getTangent(ne.getVertices()[0]).normalize(),
                ce = new y.a(ne.getStart().getPosition(), pe),
                
                // æ­¥éª¤4: è®¡ç®—å‚ç›´å¹³é¢ä¸å°„çº¿çš„äº¤ç‚¹
                te = X.intersectRay(ce, !1);
                
                if (te) {
                    var Ee = t.Vector3d.fromObject(pe);
                    new t.Vector3d(R.clone()).isOnSameSide(Ee) &&
                        (Ee = Ee.reversed());
                    
                    var De = t.Point3d.fromObject(te),
                    Le = t.Vector3d.zAxis;
                    
                    // æ­¥éª¤5: è®¡ç®—é¿è®©é«˜åº¦æ–¹å‘
                    if (!Object(n.l)(
                        ne.getStart().getPosition().z -
                        ne.getEnd().getPosition().z
                    )) {
                        var Re = l.a.getAvoidPlaneByEditTube(ae);
                        ((ee = Re[2])   == =  null  ||  ee   == =  void 0
                            ? void 0
                            : ee.direction) &&
                            (Le = new t.Vector3d(Re[2].direction));
                    }
                    
                    // æ­¥éª¤6: è®¡ç®—é¿è®©å‚æ•°
                    var xe = ae.getDiameter(),           // ç®¡å¾„
                    Be = ($ / 180) * Math.PI,            // è§’åº¦è½¬å¼§åº¦
                    me = xe * 3,                         // é«˜åº¦åŸºæ•°
                    ie = Math.cos(Math.PI / 2 - Be) * me,  // æ°´å¹³è·ç¦»
                    ue = Math.tan(Be) * ie,              // å‚ç›´é«˜åº¦
                    
                    // æ­¥éª¤7: åº”ç”¨æ—‹è½¬çŸ©é˜µ
                    he = t.Matrix4.makeRotationAxis(Ee, (Math.PI / 2) * z);
                    Le = Le.appliedMatrix4(he);
                    
                    // æ­¥éª¤8: è®¡ç®—Bridgeå˜æ¢çŸ©é˜µ
                    var de = E.calculateBridgeTransform(pe, 
De, Le),
                    
                    // æ­¥éª¤9: è®¡ç®—Bezieræ›²çº¿æ§åˆ¶ç‚¹
                    Se = De.added(Le.multiplied(ue)),      // ä¸­é—´æ§åˆ¶ç‚¹
                    Me = De.added(Ee.multiplied(ie)),      // ç»ˆç‚¹
                    Te = De.added(Ee.multiplied(-ie)),     // èµ·ç‚¹
                    
                    // æ­¥éª¤10: åˆ›å»º3æ¬¡Bezieræ›²çº¿
                    be = new t.BezierCurve3d([Te, Se, Me]),
                    
                    // æ­¥éª¤11: è·å–æ›²çº¿è¿‘ä¼¼ç‚¹
                    je = new d.a();
                    (oe = je.points).push.apply(
                        oe,
                        i([], S(be.getApproximatePoints()), !1)
                    );
                    
                    // æ­¥éª¤12: ä¿å­˜é¿è®©è·¯å¾„
                    je.setTubeId(ae.id),
                    je.setIntersectPoint(te),
                    je.setTransform(de),
                    Z.push(je);
                }
            }
        }),
        Z    // è¿”å›æ‰€æœ‰é¿è®©è·¯å¾„
    );
})
```

**Bridgeå˜æ¢çŸ©é˜µè®¡ç®—**:

**æºç ä½ç½®**: [`module_9ikq.js:355-361`](dist5/static/-fe-pub-cmn-micro-tool-base/micros/kujiale-bim-tool-page-mep-kaf-plugin/entry.3c01bf67dc49a68b970b_dewebpack/module_9ikq.js:355)

```javascript
(c.prototype.calculateBridgeTransform = function (b, E, P) {
    var j = new K.a(),
    Y = new f.a(P),
    B = b.clone().cross(Y).normalize();
    
    // åˆ›å»ºåŸºäºä¸‰ä¸ªæ­£äº¤å‘é‡çš„å˜æ¢çŸ©é˜µ
    return j.makeBasis(B, b, Y), j.setPosition(new f.a(E)), j;
})
```

### 11.4 Lintelé¿è®©ç®—æ³•

**æ ¸å¿ƒæ¨¡å—**: [`module_3rch.js`](dist5/static/-fe-pub-cmn-micro-tool-base/micros/kujiale-bim-tool-page-mep-kaf-plugin/entry.3c01bf67dc49a68b970b_dewebpack/module_3rch.js)

**ç±»å®šä¹‰**: `class h extends p.a`

### 11.5 Lintelé¿è®©å‚æ•°

**æºç ä½ç½®**: [`module_3rch.js:134-146`](dist5/static/-fe-pub-cmn-micro-tool-base/micros/kujiale-bim-tool-page-mep-kaf-plugin/entry.3c01bf67dc49a68b970b_dewebpack/module_3rch.js:134)

```javascript
(b.prototype.initState = function (E) {
    E === void 0 && (E = {}),
    this.updateState(
        S(S({}, E), {
            avoidanceDirection: 0,      // é¿è®©æ–¹å‘
            avoidanceWidth: 300,        // é¿è®©å®½åº¦ï¼ˆé»˜è®¤300mmï¼‰
            avoidanceOffset: 600,       // é¿è®©åç§»ï¼ˆé»˜è®¤600mmï¼‰
        })
    );
})
```

**å‚æ•°è®¾ç½®æ–¹æ³•**:

**æºç ä½ç½®**: [`module_3rch.js:159-172`](dist5/static/-fe-pub-cmn-micro-tool-base/micros/kujiale-bim-tool-page-mep-kaf-plugin/entry.3c01bf67dc49a68b970b_dewebpack/module_3rch.js:159)

```javascript
(b.prototype.setAvoidanceOffset = function (E, P) {
    P === void 0 && (P = !1), this.mergeState({
        avoidanceOffset: E    // è®¾ç½®é¿è®©åç§»è·ç¦»
    });
}),

(b.prototype.setAvoidanceWidth = function (E, P) {
    P === void 0 && (P = !1), this.mergeState({
        avoidanceWidth: E     // è®¾ç½®é¿è®©å®½åº¦
    });
})
```

### 11.6 Lintelé¿è®©è·¯å¾„ç”Ÿæˆ

**æ ¸å¿ƒå‡½æ•°**: `generateAvoidPath(params)`

**æºç ä½ç½®**: [`module_3rch.js:203-264`](dist5/static/-fe-pub-cmn-micro-tool-base/micros/kujiale-bim-tool-page-mep-kaf-plugin/entry.3c01bf67dc49a68b970b_dewebpack/module_3rch.js:203)

**ç®—æ³•ç‰¹ç‚¹**:
- ä½¿ç”¨ç›´çº¿æ®µè€ŒéBezieræ›²çº¿
- é¿è®©è·¯å¾„ä¸ºçŸ©å½¢æ¡†æ¶
- è€ƒè™‘æ¢çš„é«˜åº¦å’Œå®½åº¦
- æ”¯æŒæ—‹è½¬æ–¹å‘é€‰æ‹©

```javascript
(b.prototype.generateAvoidPath = function (E) {
    var P = this,
    j = E.avoidanceOffset,      // é¿è®©åç§»
    Y = E.avoidanceWidth,       // é¿è®©å®½åº¦
    B = E.avoidanceDirection,   // é¿è®©æ–¹å‘
    v = this.tubeCollisionAvoidance.getEditTube(),
    F = this.collisionResult,
    k = this.tubeCollisionAvoidance.getAllSelectedTubes();
    
    if (!v || !F || (k == null ? void 0 : k.length) === 0) return [];
    
    var Z = [],
    z = F.intersectPoint,
    $ = F.extraInfo,
    w = $ === void 0 ? {} : $,
    R = j,    // é«˜åº¦åç§»
    X = Y;    // å®½åº¦
    
    (w.height = R), (w.width = X), (F.extraInfo = w);
    
    // æ­¥éª¤1: è·å–ç¼–è¾‘ç®¡é“åˆ‡çº¿
    var ae = v.getLayoutRef(),
    oe = ae.getTangent(ae.getVertices()[0]).clone(),
    
    // æ­¥éª¤2: è®¡ç®—å‚ç›´å¹³é¢
    ee = this.getPerpendicularPlane(oe, new D.a(z));
    
    return (
        k == null ||
        k.forEach(function (ne) {
            var pe = ne.getLayoutRef();
            
            if (pe instanceof C.b) {
                // æ­¥éª¤3: è®¡ç®—ç®¡é“æ–¹å‘å’Œäº¤ç‚¹
                var ce = pe.getTangent(pe.getVertices()[0]).normalize(),
                te = new I.a(pe.getStart().getPosition(), ce),
                Ee = ee.intersectRay(te, !1),
                De = new n.LineSeg3d(
                    pe.getStart().getPositionPoint(),
                    pe.getEnd().getPositionPoint()
                );
                
                if (Ee) {
                    var Le = n.Point3d.fromObject(Ee),
                    Re = n.Vector3d.fromObject(ce),
                    xe = n.Vector3d.zAxisMinus,    // å‘ä¸‹æ–¹å‘
                    
                    // æ­¥éª¤4: åº”ç”¨æ—‹è½¬å˜æ¢
                    Be = n.Matrix4.makeRotationAxis(Re, Math.PI * B);
                    xe = xe.appliedMatrix4(Be);
                    
                    // æ­¥éª¤5: è®¡ç®—Lintelå˜æ¢çŸ©é˜µ
                    var me = P.calculateLintelTransform(ce, Le, xe),
                    
                    // æ­¥éª¤6: è®¡ç®—é¿è®©è·¯å¾„4ä¸ªè§’ç‚¹
                    ie = Le.added(xe.multiplied(R)),           // åŸºå‡†ç‚¹
                    ue = ie.added(Re.multiplied(X / 2)),       // å³ä¸­ç‚¹
                    he = ue.added(Re.multiplied(50)),          // å³ç«¯ç‚¹
                    de = De.getClosestPoint(he),               // æŠ•å½±åˆ°ç®¡é“
                    Se = ie.added(Re.multiplied(-X / 2)),      // å·¦ä¸­ç‚¹
                    Me = Se.added(Re.multiplied(-50)),         // å·¦ç«¯ç‚¹
                    Te = De.getClosestPoint(Me),               // æŠ•å½±åˆ°ç®¡é“
                    
                    // æ­¥éª¤7: åˆ›å»ºé¿è®©è·¯å¾„
                    be = new f.a();
                    be.points.push(de, ue, Se, Te);    // 4ä¸ªç‚¹å½¢æˆçŸ©å½¢
                    be.setTubeId(ne.id),
                    be.setIntersectPoint(Ee),
                    be.setTransform(me),
                    Z.push(be);
                }
            }
        }),
        Z
    );
})
```

**Lintelå˜æ¢çŸ©é˜µè®¡ç®—**:

**æºç ä½ç½®**: [`module_3rch.js:393-399`](dist5/static/-fe-pub-cmn-micro-tool-base/micros/kujiale-bim-tool-page-mep-kaf-plugin/entry.3c01bf67dc49a68b970b_dewebpack/module_3rch.js:393)

```javascript
(b.prototype.calculateLintelTransform = function (E, P, j) {
    var Y = new W.a(),
    B = new D.a(j).clone().negate(),
    v = E.clone().cross(B).normalize();
    
    return Y.makeBasis(v, E, B), Y.setPosition(new D.a(P)), Y;
})
```

---

## 12. AIè·¯å¾„æœç´¢ç”Ÿæˆ

### 12.1 è·¯å¾„ç”Ÿæˆæ¦‚è¿°

åŸºäºå·²åˆ†æçš„æºç ï¼Œç³»ç»Ÿé‡‡ç”¨**å‡ ä½•ç®—æ³•**è€Œéä¼ ç»ŸAIæœç´¢ç®—æ³•ï¼ˆå¦‚A*ã€Dijkstraï¼‰è¿›è¡Œè·¯å¾„ç”Ÿæˆã€‚

### 12.2 è·¯å¾„ç”Ÿæˆç­–ç•¥

**æºç ä½ç½®**: [`module_uocc.js:222-248`](dist5/static/-fe-pub-cmn-micro-tool-base/micros/kujiale-bim-tool-page-mep-kaf-plugin/entry.3c01bf67dc49a68b970b_dewebpack/module_uocc.js:222)

**æ ¸å¿ƒæ–¹æ³•**: `convert(params)`

**è·¯å¾„ç”Ÿæˆæµç¨‹**:
```
ç”¨æˆ·è¾“å…¥è·¯å¾„ç‚¹
    â†“
ç¢°æ’æ£€æµ‹ï¼ˆæ£€æµ‹ç®¡é“å’Œæ¢ï¼‰
    â†“
æ’å…¥é¿è®©ç‚¹åˆ°è·¯å¾„
    â†“
ç”Ÿæˆé¿è®©è·¯å¾„ï¼ˆBezieræ›²çº¿æˆ–ç›´çº¿æ®µï¼‰
    â†“
åˆ›å»ºé¡¶ç‚¹å’Œè¾¹
    â†“
è¿”å›å®Œæ•´è·¯å¾„å¯¹è±¡
```

### 12.3 æ™ºèƒ½è·¯å¾„ä¼˜åŒ–

**è·¯å¾„åˆå¹¶ä¼˜åŒ–**: `mergePathIfParallel(tube, params)`

**æºç ä½ç½®**: [`module_uocc.js:1047-1079`](dist5/static/-fe-pub-cmn-micro-tool-base/micros/kujiale-bim-tool-page-mep-kaf-plugin/entry.3c01bf67dc49a68b970b_dewebpack/module_uocc.js:1047)

```javascript
(at.prototype.mergePathIfParallel = function (ke, $require) {
    var dt = this,
    pt = new Set(
        te(te([], ce(this.vertices), !1), ce(this.edges), !1)
    );
    
    // æ£€æŸ¥æ˜¯å¦å¯ä»¥åˆå¹¶å¹³è¡Œè·¯å¾„
    if (
        ke instanceof z.a &&
        ee.a.isFreeVertex(ke) &&
        !ee.a.getOtherLevelIdFromEntityId(ke.getEntityId())
    ) {
        var It = ke.getLayoutRef();
        It.getEdgesArray().forEach(function (xt) {
            return pt.add(xt);
        });
    }
    
    var Et = pt.size;
    
    // æ‰§è¡Œè·¯å¾„åˆå¹¶
    Object(m.b)(
        pt,
        !1,
        Array.from(this.collisionDetectionMap.keys()),
        $require
    ),
    
    // æ›´æ–°é¡¶ç‚¹å’Œè¾¹é›†åˆ
    Et !== pt.size &&
    pt.forEach(function (xt) {
        xt instanceof v.a
            ? dt.vertices.add(xt)
            : xt instanceof Y.b && dt.edges.add(xt);
    });
})
```

### 12.4 è·¯å¾„ç”Ÿæˆç‰¹ç‚¹

1. **å®æ—¶ç¢°æ’æ£€æµ‹**: ç»˜åˆ¶è¿‡ç¨‹ä¸­å®æ—¶æ£€æµ‹ç¢°æ’
2. **è‡ªåŠ¨é¿è®©**: æ£€æµ‹åˆ°ç¢°æ’è‡ªåŠ¨ç”Ÿæˆé¿è®©è·¯å¾„
3. **å¹³æ»‘è¿‡æ¸¡**: ä½¿ç”¨Bezieræ›²çº¿å®ç°å¹³æ»‘è½¬å¼¯
4. **æ–¹å‘å¯é€‰**: æ”¯æŒå¤šæ–¹å‘é¿è®©é€‰æ‹©
5. **å‚æ•°å¯è°ƒ**: é¿è®©è§’åº¦ã€å®½åº¦ã€åç§»å¯é…ç½®

---

## 13. å›½æ ‡éªŒè¯ç³»ç»Ÿ

### 13.1 éªŒè¯ç³»ç»Ÿæ¡†æ¶

**æ ¸å¿ƒæ¨¡å—**: [`module_pckm.js`](dist5/static/-fe-pub-cmn-micro-tool-base/micros/kujiale-bim-tool-page-mep-kaf-plugin/entry.3c01bf67dc49a68b970b_dewebpack/module_pckm.js)

**ç±»å®šä¹‰**: `class tt`

### 13.2 éªŒè¯å‡½æ•°ä½“ç³»

**ä¸»éªŒè¯å…¥å£**:

**æºç ä½ç½®**: [`module_pckm.js:1460-1463`](dist5/static/-fe-pub-cmn-micro-tool-base/micros/kujiale-bim-tool-page-mep-kaf-plugin/entry.3c01bf67dc49a68b970b_dewebpack/module_pckm.js:1460)

```javascript
(tt.prototype.verify = function (et) {
    this.normalVerify(et);     // å¸¸è§„éªŒè¯
    this.versionVerify(et);    // ç‰ˆæœ¬éªŒè¯
})
```

### 13.3 å³æ—¶éªŒè¯ç³»ç»Ÿ

**æºç ä½ç½®**: [`module_pckm.js:1464-1521`](dist5/static/-fe-pub-cmn-micro-tool-base/micros/kujiale-bim-tool-page-mep-kaf-plugin/entry.3c01bf67dc49a68b970b_dewebpack/module_pckm.js:1464)

```javascript
(tt.prototype.verifyImmediately = function (et) {
    var we = this;
    try {
        var ze = r.MepPlugin.stateManager.isMepMode();
        ze &&
        Object(g.c)(function () {
            we.verifyImmediatelyInternal(et);
        });
    } catch (Qe) {
        t.MepTracer.error("tube check error");
    }
})
```

**å†…éƒ¨éªŒè¯é€»è¾‘**:

**æºç ä½ç½®**: [`module_pckm.js:1490-1521`](dist5/static/-fe-pub-cmn-micro-tool-base/micros/kujiale-bim-tool-page-mep-kaf-plugin/entry.3c01bf67dc49a68b970b_dewebpack/module_pckm.js:1490)

```javascript
(tt.prototype.verifyImmediatelyInternal = function (et) {
    var we = localStorage.getItem("mepVerifyImmediately") === n.d.TRUE,
    ze = we,
    Qe = et.getTubesArray();
    
    // 
æ€§èƒ½ä¼˜åŒ–ï¼šç®¡é“æ•°è¶…è¿‡2000æ—¶è·³è¿‡éƒ¨åˆ†æ£€æŸ¥
    if (!ze && Qe.length > 2e3) return !0;
    
    var ot = this.getVerticesAndEdges(et),
    At = ot.vertexes,
    Wt = ot.edges,
    
    // æ­¥éª¤1: æ‹“æ‰‘éªŒè¯ï¼ˆå¿«é€Ÿæ£€æŸ¥ï¼‰
    it = this.verifyTopoWithoutTube(At, Wt);
    
    if (!ze && it) {
        dt.b.sendError(dt.d.DesignInvalidByQuickCheck, it);
        return !it;
    }
    
    // æ­¥éª¤2-9: å®Œæ•´éªŒè¯ï¼ˆä»…åœ¨å®Œæ•´æ¨¡å¼ä¸‹ï¼‰
    if (ze) {
        it = it || this.verifyPath(et, Wt);                    // è·¯å¾„éªŒè¯
        it = it || this.verifyTubesWithoutTopo(Qe);            // ç®¡é“æ‹“æ‰‘éªŒè¯
        it = it || this.verifyModelConnector(At, et);          // æ¨¡å‹è¿æ¥å™¨éªŒè¯
        it = it || this.verifySystemConnector(et);             // ç³»ç»Ÿè¿æ¥å™¨éªŒè¯
        it = it || this.verifyParameter(Qe);                   // å‚æ•°éªŒè¯
        it = it || this.verifyCircuitForCoilPartition(         // åœ°æš–å›è·¯éªŒè¯
            et.getExtraRelation().getCircuitForCoilPartition()
        );
        it = it || this.verifySystemTube(Qe);                  // ç³»ç»Ÿç®¡é“éªŒè¯
        it = it || this.verifyVertices(At);                    // é¡¶ç‚¹éªŒè¯
        
        it && A.toast.error({
            content: it,
            timeout: 5e3
        });
    }
    
    return !it;
})
```

### 13.4 9å¤§éªŒè¯æ£€æŸ¥é¡¹

#### éªŒè¯1: æ‹“æ‰‘å®Œæ•´æ€§éªŒè¯

**æºç ä½ç½®**: [`module_pckm.js:1549-1569`](dist5/static/-fe-pub-cmn-micro-tool-base/micros/kujiale-bim-tool-page-mep-kaf-plugin/entry.3c01bf67dc49a68b970b_dewebpack/module_pckm.js:1549)

```javascript
(tt.prototype.verifyTopoWithoutTube = function (et, we) {
    // æ£€æŸ¥1: é¡¶ç‚¹å¿…é¡»å…³è”ç®¡é“
    var ze = et.find(function (ot) {
        return !ot.getLinkedTube();
    });
    if (ze)
        return "vertexæœªè®¾ç½®tube, vertexId:".concat(ze.getId());
    
    // æ£€æŸ¥2: è¾¹å¿…é¡»å…³è”ç®¡é“å’Œèµ·ç»ˆç‚¹
    var Qe = we.find(function (ot) {
        return !ot.getLinkedTube() || !ot.getStart() || !ot.getEnd();
    });
    if (Qe)
        return Qe.getLinkedTube()
            ? "edgeæœªè®¾ç½®startæˆ–end, edgeId:".concat(Qe.getId())
            : "edgeæœªè®¾ç½®tube, edgeId:".concat(Qe.getId());
})
```

#### éªŒè¯2: ç®¡é“æ‹“æ‰‘éªŒè¯

**æºç ä½ç½®**: [`module_pckm.js:1570-1580`](dist5/static/-fe-pub-cmn-micro-tool-base/micros/kujiale-bim-tool-page-mep-kaf-plugin/entry.3c01bf67dc49a68b970b_dewebpack/module_pckm.js:1570)

```javascript
(tt.prototype.verifyTubesWithoutTopo = function (et) {
    var we = et.find(function (ze) {
        return !ze.getLayoutRef();
    });
    if (we)
        return "tubeæœªè®¾ç½®layoutRef, tubeId:".concat(we.getId());
})
```

#### éªŒè¯3: æ¨¡å‹è¿æ¥å™¨éªŒè¯

**æºç ä½ç½®**: [`module_pckm.js:1581-1654`](dist5/static/-fe-pub-cmn-micro-tool-base/micros/kujiale-bim-tool-page-mep-kaf-plugin/entry.3c01bf67dc49a68b970b_dewebpack/module_pckm.js:1581)

```javascript
(tt.prototype.verifyModelConnector = function (et, we) {
    var ze = we.getExtraRelation().getRelation().getVertexToConnectorRelationMap();
    
    // æ£€æŸ¥1: å…³ç³»æ˜ å°„ä¸­çš„vertexIdå¿…é¡»å­˜åœ¨äºdesignä¸­
    var Qe = et.map(function (Xe) {
        return Xe.id;
    }),
    ot = ze.size > 0 &&
        Array.from(ze.keys()).some(function (Xe) {
            return !Qe.includes(Xe);
        });
    if (ot)
        return "relationMapä¸­çš„vertexIdåœ¨designä¸­ä¸å­˜åœ¨";
    
    // æ£€æŸ¥2: connectorIdå¿…é¡»æœ‰æ•ˆ
    var At = [];
    we.getModelsArray().forEach(function (Xe) {
        return At.push.apply(
            At,
            Ut([], Pt(
                Xe.getConnectorManager().getUsedConnectors(l.a.CONNECT_TUBE)
            ), !1)
        );
    });
    
    var Wt = ze.size > 0 &&
        Array.from(ze.values()).some(function (Xe) {
            return !At.find(function (Ct) {
                return Ct.getId() === Xe;
            });
        });
    if (Wt)
        return "relationMapä¸­çš„connectorIdåœ¨designä¸­ä¸å­˜åœ¨";
    
    // æ£€æŸ¥3: connectorä¸èƒ½è¢«å¤šä¸ªvertexå ç”¨
    var it = new Map();
    ze.forEach(function (Xe, Ct) {
        var Nt;
        it.has(Xe) || it.set(Xe, new Set());
        (Nt = it.get(Xe)) === null || Nt === void 0 || Nt.add(Ct);
    });
    
    if (Array.from(it.values()).some(function (Xe) {
        return Xe.size > 1;
    }))
        return "relationMapä¸­çš„connectorIdè¢«å¤šä¸ªvertexå ç”¨";
    
    // æ£€æŸ¥4: tube connectorçš„host vertexå¿…é¡»å­˜åœ¨
    var Ke = At.length > 0 &&
        At.some(function (Xe) {
            var Ct,
            Nt = Xe.getHost();
            return Nt instanceof W.a
                ? !Qe.includes(
                    ((Ct = Nt.getLayoutRef()) === null || Ct === void 0
                        ? void 0
                        : Ct.id) || ""
                )
                : !1;
        });
    if (Ke)
        return "tube connectorä¸­çš„host vertexä¸å­˜åœ¨";
})
```

#### éªŒè¯4: ç³»ç»Ÿè¿æ¥å™¨éªŒè¯

**æºç ä½ç½®**: [`module_pckm.js:1655-1717`](dist5/static/-fe-pub-cmn-micro-tool-base/micros/kujiale-bim-tool-page-mep-kaf-plugin/entry.3c01bf67dc49a68b970b_dewebpack/module_pckm.js:1655)

```javascript
(tt.prototype.verifySystemConnector = function (et) {
    // æ£€æŸ¥1: system connectorçš„host systemå¿…é¡»å­˜åœ¨
    var we = [];
    et.getModelsArray().forEach(function (Xe) {
        return we.push.apply(
            we,
            Ut([], Pt(
                Xe.getConnectorManager().getUsedConnectors(l.a.CONNECT_SYSTEM)
            ), !1)
        );
    });
    
    var ze = Array.from(et.getSystems().keys()).map(function (Xe) {
        return Xe.getId();
    }),
    Qe = we.length > 0 &&
        we.some(function (Xe) {
            var Ct = Xe.getHost();
            return Ct instanceof i.a ? !ze.includes(Ct.id) : !1;
        });
    if (Qe) return "systemConnectorä¸­host systemä¸å­˜åœ¨";
    
    // æ£€æŸ¥2: control lineçš„startå’Œend modelå¿…é¡»å­˜åœ¨
    var ot = [],
    At = et.getSystemsByType(m.c.PowerCircuit),
    Wt = et.getSystemsByType(m.c.Controls);
    
    At.concat(Wt).forEach(function (Xe) {
        Xe instanceof i.a &&
            ot.push.apply(ot, Ut([], Pt(Xe.getControlLines()), !1));
    });
    
    var it = et.getModelsArray().map(function (Xe) {
        return Xe.getId();
    }),
    Ke = ot.length > 0 &&
        ot.some(function (Xe) {
            var Ct, Nt;
            return (
                !it.includes(
                    ((Ct = Xe.getStartModel()) === null || Ct === void 0
                        ? void 0
                        : Ct.id) || ""
                ) ||
                !it.includes(
                    ((Nt = Xe.getEndModel()) === null || Nt === void 0
                        ? void 0
                        : Nt.id) || ""
                )
            );
        });
    if (Ke)
        return "control lineä¸­çš„startæˆ–end modelä¸å­˜åœ¨";
})
```

#### éªŒè¯5: å‚æ•°éªŒè¯

**æºç ä½ç½®**: [`module_pckm.js:1718-1739`](dist5/static/-fe-pub-cmn-micro-tool-base/micros/kujiale-bim-tool-page-mep-kaf-plugin/entry.3c01bf67dc49a68b970b_dewebpack/module_pckm.js:1718)

```javascript
(tt.prototype.verifyParameter = function (et) {
    var we = et.some(function (ze) {
        var Qe = ze.getParameters();
        
        // æ£€æŸ¥1: å‚æ•°Mapå¤§å°åŒ¹é…
        return ze.getParametersAsMap().size !== Qe.size
            ? !0
            : Array.from(Qe.values()).some(function (ot) {
                if (ot.getData() === void 0) return !0;
                
                var At = ot.getStorageType(),
                Wt = ot.getData();
                
                // æ£€æŸ¥2: å‚æ•°ç±»å‹åŒ¹é…
                return (
                    (At === S.b.IntData && typeof Wt != "number") ||
                    (At === S.b.DoubleData && typeof Wt != "number") ||
                    (At === S.b.StringData && typeof Wt != "string") ||
                    (At === S.b.ElementData && typeof Wt != "string")
                );
            });
    });
    
    if (we) return "tubeå‚æ•°è®¾ç½®é”™è¯¯";
})
```

#### éªŒè¯6: ç³»ç»Ÿç®¡é“éªŒè¯

**æºç ä½ç½®**: [`module_pckm.js:1740-1753`](dist5/static/-fe-pub-cmn-micro-tool-base/micros/kujiale-bim-tool-page-mep-kaf-plugin/entry.3c01bf67dc49a68b970b_dewebpack/module_pckm.js:1740)

```javascript
(tt.prototype.verifySystemTube = function (et) {
    var we = et.filter(function (ze) {
        var Qe;
        return (
            !ze.getSystem() &&
            !((Qe = ze.getLayoutRef()) === null || Qe === void 0
                ? void 0
                : Qe.getLinkedModel())
        );
    });
    
    if (we.length > 0) return "tubeæœªè®¾ç½®system";
})
```

#### éªŒè¯7: è·¯å¾„æ•°æ®éªŒè¯

**æºç ä½ç½®**: [`module_pckm.js:1754-1796`](dist5/static/-fe-pub-cmn-micro-tool-base/micros/kujiale-bim-tool-page-mep-kaf-plugin/entry.3c01bf67dc49a68b970b_dewebpack/module_pckm.js:1754)

```javascript
(tt.prototype.verifyPath = function (et, we) {
    // æ£€æŸ¥1: edge IDä¸èƒ½é‡å¤
    var ze = we.map(function (Wt) {
        return Wt.getId();
    }),
    Qe = new Set(ze).size !== ze.length;
    if (Qe) return 
"pathæ•°æ®é”™è¯¯ï¼šedgeé‡å¤";
    
    // æ£€æŸ¥2: åŒä¸€pathä¸­çš„systemå¿…é¡»ä¸€è‡´
    var ot = et
        .getLayoutArray()
        .map(function (Wt) {
            return Wt.getPathArray();
        })
        .flat(),
    At = ot.some(function (Wt) {
        var it,
        Ke,
        Xe = Wt.getEdgesArray();
        if (!Xe.length) return !1;
        
        var Ct =
            (Ke =
                (it = Xe[0]) === null || it === void 0
                    ? void 0
                    : it.getLinkedTube()) === null || Ke === void 0
                ? void 0
                : Ke.getSystem();
        
        return (
            !Ct ||
            Xe.some(function (Nt) {
                var Qt,
                on =
                    (Qt = Nt.getLinkedTube()) === null || Qt === void 0
                        ? void 0
                        : Qt.getSystem();
                return on !== Ct;
            })
        );
    });
    
    if (At) return "pathä¸­çš„systemä¸ä¸€è‡´";
})
```

#### éªŒè¯8: é¡¶ç‚¹è¾¹æ•°éªŒè¯

**æºç ä½ç½®**: [`module_pckm.js:1797-1830`](dist5/static/-fe-pub-cmn-micro-tool-base/micros/kujiale-bim-tool-page-mep-kaf-plugin/entry.3c01bf67dc49a68b970b_dewebpack/module_pckm.js:1797)

```javascript
(tt.prototype.verifyVertices = function (et) {
    var we,
    ze = et.find(function (Qe) {
        var ot;
        if (a.a.isCrossLevelTopo(Qe)) return !1;
        
        var At = Qe.getEdgesArray().length,
        Wt =
            (ot = Qe.getLinkedTube()) === null || ot === void 0
                ? void 0
                : ot.getTubeType();
        
        // éªŒè¯è§„åˆ™ï¼š
        return !!(
            !Wt ||
            Wt === y.d.Unknown ||
            // è¿æ¥å™¨ã€å¼¯å¤´ã€ç›´æ¥å¤´ã€è¿‡æ¢ã€æ¡¥æ¥ å¿…é¡»æœ‰2æ¡è¾¹
            ([
                y.d.Connector,
                y.d.Elbow,
                y.d.StraightJoint,
                y.d.Lintel,
                y.d.Bridge,
            ].includes(Wt) &&
                At !== 2) ||
            // ä¸‰é€šå¿…é¡»æœ‰3æ¡è¾¹
            (y.d.Tee === Wt && At !== 3) ||
            // è™šæ‹Ÿé¡¶ç‚¹å¦‚æœæ²¡æœ‰æ¨¡å‹ï¼Œæœ€å¤š1æ¡è¾¹
            (!Qe.getLinkedModel() && y.d.Virtual === Wt && At > 1)
        );
    });
    
    if (ze)
        return "vertex's edgesæ•°é”™è¯¯, tubeId: ".concat(
            (we = ze.getLinkedTube()) === null || we === void 0
                ? void 0
                : we.getId()
        );
})
```

#### éªŒè¯9: åœ°æš–å›è·¯éªŒè¯

**æºç ä½ç½®**: [`module_pckm.js:1831-1840`](dist5/static/-fe-pub-cmn-micro-tool-base/micros/kujiale-bim-tool-page-mep-kaf-plugin/entry.3c01bf67dc49a68b970b_dewebpack/module_pckm.js:1831)

```javascript
(tt.prototype.verifyCircuitForCoilPartition = function (et) {
    var we = !!Array.from(et).find(function (ze) {
        return ze.getConnectToRadiator();
    });
    
    return we
        ? "åœ°æš–åŒºåŸŸconnectToRadiatorå‚æ•°é”™è¯¯"
        : void 0;
})
```

### 13.5 æ•°æ®æ£€æŸ¥å·¥å…·

**æ ¸å¿ƒæ¨¡å—**: [`module_yy3l.js`](dist5/static/-fe-pub-cmn-micro-tool-base/micros/kujiale-bim-tool-page-mep-kaf-plugin/entry.3c01bf67dc49a68b970b_dewebpack/module_yy3l.js)

**æºç ä½ç½®**: [`module_yy3l.js:10-37`](dist5/static/-fe-pub-cmn-micro-tool-base/micros/kujiale-bim-tool-page-mep-kaf-plugin/entry.3c01bf67dc49a68b970b_dewebpack/module_yy3l.js:10)

```javascript
var g = {
    // æ£€æŸ¥1: ç®¡é“æ•°æ®å®Œæ•´æ€§
    checkTubeData: function (t) {
        var A = t.getLayoutRef();
        
        // éªŒè¯layoutRefå­˜åœ¨ä¸”æœ‰è¾¹
        if (A && A instanceof r.a) {
            if (A.getEdges().size === 0) return !1;
        } else return !1;
        
        // éªŒè¯ä½ç½®ä¿¡æ¯
        if (!t.getLocation()) return !1;
        
        // éªŒè¯å‡ ä½•æ•°æ®
        var W = !!t.getFamilyData();
        return !(W && !t.getGeometry());
    },
    
    // æ£€æŸ¥2: å¸ƒå±€æ•°æ®å®Œæ•´æ€§
    checkLayoutData: function (t) {
        return !(
            t.getPaths().size === 0 ||
            t.getPathArray().every(function (A) {
                return A.getEdges().size === 0 && A.getVertices().size === 0;
            })
        );
    },
    
    // æ£€æŸ¥3: è·¯å¾„æ•°æ®å®Œæ•´æ€§
    checkPathData: function (t) {
        return !(t.getEdges().size === 0 && t.getVertices().size === 0);
    },
};
```

---

## 14. è‡ªæ£€ç³»ç»Ÿ

### 14.1 è¿æ¥å™¨çº¦æŸç³»ç»Ÿ

**æ ¸å¿ƒæ¨¡å—**: [`module_qffn.js`](dist5/static/-fe-pub-cmn-micro-tool-base/micros/kujiale-bim-tool-page-mep-kaf-plugin/entry.3c01bf67dc49a68b970b_dewebpack/module_qffn.js)

**ç±»å®šä¹‰**: `class y extends n.b`

**æºç ä½ç½®**: [`module_qffn.js:58-70`](dist5/static/-fe-pub-cmn-micro-tool-base/micros/kujiale-bim-tool-page-mep-kaf-plugin/entry.3c01bf67dc49a68b970b_dewebpack/module_qffn.js:58)

```javascript
function f() {
    var d = D.call(this, K.a.MepConnector) || this;
    return (
        (d.baseType = W.a.UNKNOWN),      // åŸºç¡€ç±»å‹
        (d.grpId = null),                // ç»„ID
        (d.grpBizTypeKey = null),        // ä¸šåŠ¡ç±»å‹é”®
        (d.constraint = []),             // çº¦æŸåˆ—è¡¨
        d
    );
}
```

### 14.2 çº¦æŸç®¡ç†æ–¹æ³•

**æºç ä½ç½®**: [`module_qffn.js:150-182`](dist5/static/-fe-pub-cmn-micro-tool-base/micros/kujiale-bim-tool-page-mep-kaf-plugin/entry.3c01bf67dc49a68b970b_dewebpack/module_qffn.js:150)

```javascript
// è·å–çº¦æŸåˆ—è¡¨
(f.prototype.getConstraint = function () {
    return this.constraint;
}),

// è®¾ç½®çº¦æŸåˆ—è¡¨
(f.prototype.setConstraint = function (d) {
    return (this.constraint = d), this;
}),

// è·å–ç³»ç»Ÿç±»å‹ä¿¡æ¯
(f.prototype.getSystemTypeInfo = function () {
    var d;
    
    if (this.constraint.length) {
        var _ = this.constraint[0],
        O = _.mepSystemType,          // MEPç³»ç»Ÿç±»å‹
        M = _.purposeList;            // ç”¨é€”åˆ—è¡¨
        
        return Object(A.b)(
            {
                systemType: O,
                purposeCode:
                    ((d = M[0]) === null || d === void 0
                        ? void 0
                        : d.purposeCode) || "",
            },
            this.getOwner()
        );
    }
    
    return {
        systemType: t.c.Unknown,
        subSystemType: t.b.Unknown
    };
})
```

### 14.3 ä½ç½®æ£€æŸ¥

**æºç ä½ç½®**: [`module_nh4q.js:225-227`](dist5/static/-fe-pub-cmn-micro-tool-base/micros/kujiale-bim-tool-page-mep-kaf-plugin/entry.3c01bf67dc49a68b970b_dewebpack/module_nh4q.js:225)

```javascript
(u.prototype.checkLocation = function () {
    // æ£€æŸ¥ç®¡é“ä½ç½®åˆæ³•æ€§
})
```

### 14.4 æµå‘æ£€æŸ¥

**æºç ä½ç½®**: [`module_ryp.js:414-416`](dist5/static/-fe-pub-cmn-micro-tool-base/micros/kujiale-bim-tool-page-mep-kaf-plugin/entry.3c01bf67dc49a68b970b_dewebpack/module_ryp.js:414)

```javascript
(_.prototype.checkFlowDirection = function (O) {
    // æ£€æŸ¥æµå‘æ­£ç¡®æ€§ï¼ˆä¾›æ°´/å›æ°´ï¼‰
})
```

### 14.5 ç§»åŠ¨æœ‰æ•ˆæ€§æ£€æŸ¥

**æºç ä½ç½®**: [`module_zfyw.js:763-769`](dist5/static/-fe-pub-cmn-micro-tool-base/micros/kujiale-bim-tool-page-mep-kaf-plugin/entry.3c01bf67dc49a68b970b_dewebpack/module_zfyw.js:763)

```javascript
(ue.prototype.checkMoveValid = function (he, de) {
    var Se = this.checkIsValidZ(he, de);
    return !!Se;
}),

(ue.prototype.checkIsValidZ = function (he, de) {
    // æ£€æŸ¥Zè½´ç§»åŠ¨æœ‰æ•ˆæ€§
})
```

---

## 15. ç³»ç»Ÿç±»å‹æšä¸¾å®Œæ•´å®šä¹‰

### 15.1 å¸ƒå±€ç±»å‹æšä¸¾ (LayoutType)

**æºç ä½ç½®**: [`module_9wif.js:28-40`](dist5/static/-fe-pub-cmn-micro-tool-base/micros/kujiale-bim-tool-page-mep-kaf-plugin/entry.3c01bf67dc49a68b970b_dewebpack/module_9wif.js:28)

```javascript
var b;
(function (A) {
    (A[(A.Unknown = 0)] = "Unknown"),
    (A[(A.Conduit = 1)] = "Conduit"),                      // å¼ºç”µç®¡
    (A[(A.Pipe = 2)] = "Pipe"),                            // æ°´ç®¡
    
(A[(A.Refrigerant = 3)] = "Refrigerant"),              // åˆ¶å†·å‰‚
    (A[(A.Condensation = 4)] = "Condensation"),            // å†·å‡æ°´
    (A[(A.VentilationFresh = 5)] = "VentilationFresh"),    // æ–°é£
    (A[(A.VentilationDirty = 6)] = "VentilationDirty"),    // æ’é£
    (A[(A.WeakCurrent = 7)] = "WeakCurrent"),              // å¼±ç”µ
    (A[(A.FloorHeating = 8)] = "FloorHeating"),            // åœ°æš–
    (A[(A.WaterAirCondition = 9)] = "WaterAirCondition"),  // æ°´ç©ºè°ƒ
    (A[(A.DrainWater = 10)] = "DrainWater"),               // æ’æ°´
    (A[(A.MepCommon = 11)] = "MepCommon")                  // é€šç”¨MEP
})(b || (b = {}));
```

### 15.2 ç³»ç»Ÿç±»å‹æšä¸¾ (SystemType)

**æºç ä½ç½®**: [`module_xbta.js:57-75`](dist5/static/-fe-pub-cmn-micro-tool-base/micros/kujiale-bim-tool-page-mep-kaf-plugin/entry.3c01bf67dc49a68b970b_dewebpack/module_xbta.js:57)

```javascript
var c;
(function (m) {
    (m[(m.Unknown = 0)] = "Unknown"),
    (m[(m.PowerCircuit = 1)] = "PowerCircuit"),                // å¼ºç”µå›è·¯
    (m[(m.Controls = 2)] = "Controls"),                        // æ§åˆ¶ç³»ç»Ÿ
    (m[(m.Conduit = 3)] = "Conduit"),                          // å¼ºç”µç®¡
    (m[(m.DomesticHotWater = 4)] = "DomesticHotWater"),        // ç”Ÿæ´»çƒ­æ°´
    (m[(m.DomesticColdWater = 5)] = "DomesticColdWater"),      // ç”Ÿæ´»å†·æ°´
    (m[(m.DomesticWater = 7)] = "DomesticWater"),              // ç”Ÿæ´»ç”¨æ°´
    (m[(m.Refrigerant = 8)] = "Refrigerant"),                  // åˆ¶å†·å‰‚
    (m[(m.Refrigerant_Gas = 9)] = "Refrigerant_Gas"),          // æ°”æ€åˆ¶å†·å‰‚
    (m[(m.Refrigerant_Liquid = 10)] = "Refrigerant_Liquid"),   // æ¶²æ€åˆ¶å†·å‰‚
    (m[(m.Condensation = 11)] = "Condensation"),               // å†·å‡æ°´
    (m[(m.VentilationFreshAir = 12)] = "VentilationFreshAir"), // æ–°é£
    (m[(m.VentilationDirtyAir = 13)] = "VentilationDirtyAir"), // æ’é£
    (m[(m.WeakCurrent = 14)] = "WeakCurrent"),                 // å¼±ç”µ
    (m[(m.FloorHeating = 15)] = "FloorHeating"),               // åœ°æš–
    (m[(m.WaterAirCondition = 16)] = "WaterAirCondition"),     // æ°´ç©ºè°ƒ
    (m[(m.DrainWater = 17)] = "DrainWater"),                   // æ’æ°´
    (m[(m.Refrigerant_Pressure = 18)] = "Refrigerant_Pressure"), // å‹åŠ›åˆ¶å†·å‰‚
    (m[(m.LogicSystem = 19)] = "LogicSystem")                  // é€»è¾‘ç³»ç»Ÿ
})(c || (c = {}));
```

### 15.3 å­ç³»ç»Ÿç±»å‹æšä¸¾ (SubSystemType)

**æºç ä½ç½®**: [`module_xbta.js:77-91`](dist5/static/-fe-pub-cmn-micro-tool-base/micros/kujiale-bim-tool-page-mep-kaf-plugin/entry.3c01bf67dc49a68b970b_dewebpack/module_xbta.js:77)

```javascript
var d;
(function (m) {
    (m[(m.Unknown = 0)] = "Unknown"),
    (m[(m.Controls = 1)] = "Controls"),                  // æ§åˆ¶
    (m[(m.Lighting = 2)] = "Lighting"),                  // ç…§æ˜
    (m[(m.StrongCurrent = 3)] = "StrongCurrent"),        // å¼ºç”µ
    (m[(m.WeakCurrent = 4)] = "WeakCurrent"),            // å¼±ç”µ
    (m[(m.SupplyWater = 5)] = "SupplyWater"),            // ä¾›æ°´
    (m[(m.DrainWater = 6)] = "DrainWater"),              // æ’æ°´
    (m[(m.HotWater = 7)] = "HotWater"),                  // çƒ­æ°´
    (m[(m.AirConditioning = 8)] = "AirConditioning"),    // ç©ºè°ƒ
    (m[(m.FloorHeating = 9)] = "FloorHeating"),          // åœ°æš–
    (m[(m.WaterAirCon = 10)] = "WaterAirCon")            // æ°´ç©ºè°ƒ
})(d || (d = {}));
```

### 15.4 ç®¡é“ç”¨é€”ä»£ç  (PurposeCode)

**æºç ä½ç½®**: [`module_xbta.js:93-112`](dist5/static/-fe-pub-cmn-micro-tool-base/micros/kujiale-bim-tool-page-mep-kaf-plugin/entry.3c01bf67dc49a68b970b_dewebpack/module_xbta.js:93)

```javascript
var b;
(function (m) {
    (m[(m.Unknown = 0)] = "Unknown"),
    (m[(m.ControlLine = 1003)] = "ControlLine"),                          // æ§åˆ¶çº¿
    (m[(m.PowerCircuitLine = 1004)] = "PowerCircuitLine"),                // ç”µåŠ›çº¿
    (m[(m.FloorHeatingSupply = 15001)] = "FloorHeatingSupply"),           // åœ°æš–ä¾›æ°´
    (m[(m.FloorHeatingBack = 15002)] = "FloorHeatingBack"),               // åœ°æš–å›æ°´
    (m[(m.FloorHeatingPass = 15003)] = "FloorHeatingPass"),               // åœ°æš–è¿‡è·¯
    (m[(m.FloorHeatingCoil = 15004)] = "FloorHeatingCoil"),               // åœ°æš–ç›˜ç®¡
    (m[(m.FloorHeatingJointIn = 15005)] = "FloorHeatingJointIn"),         // åœ°æš–è¿›æ°´æ¥å¤´
    (m[(m.FloorHeatingJointOut = 15006)] = "FloorHeatingJointOut"),       // åœ°æš–å‡ºæ°´æ¥å¤´
    (m[(m.WaterAirConditionSupply = 16001)] = "WaterAirConditionSupply"), // æ°´ç©ºè°ƒä¾›æ°´
    (m[(m.WaterAirConditionBack = 16002)] = "WaterAirConditionBack"),     // æ°´ç©ºè°ƒå›æ°´
    (m[(m.WaterAirConditionDrain = 16003)] = "WaterAirConditionDrain"),   // æ°´ç©ºè°ƒæ’æ°´
    (m[(m.FloorHeatingDrain = 16004)] = "FloorHeatingDrain"),             // åœ°æš–æ’æ°´
    (m[(m.VenDrain = 16005)] = "VenDrain")                                // é€šé£æ’æ°´
})(b || (b = {}));
```

### 15.5 ç®¡é“ç±»å‹è¯¦ç»†æšä¸¾ (TubeType)

**å®Œæ•´çš„ç®¡é“ç±»å‹å®šä¹‰** (ä»£ç 0-800+):

**æºç ä½ç½®**: [`module_9wif.js:42-164`](dist5/static/-fe-pub-cmn-micro-tool-base/micros/kujiale-bim-tool-page-mep-kaf-plugin/entry.3c01bf67dc49a68b970b_dewebpack/module_9wif.js:42)

```javascript
var d;
(function (A) {
    // é€šç”¨ç±»å‹
    (A[(A.Unknown = 0)] = "Unknown"),
    (A[(A.Connector = 1)] = "Connector"),
    (A[(A.Line = 2)] = "Line"),
    (A[(A.Elbow = 3)] = "Elbow"),
    (A[(A.Tee = 4)] = "Tee"),
    (A[(A.StraightJoint = 5)] = "StraightJoint"),
    (A[(A.Bridge = 6)] = "Bridge"),
    (A[(A.Virtual = 7)] = "Virtual"),
    (A[(A.Lintel = 8)] = "Lintel"),
    
    // å¼ºç”µç®¡é“ (100-112) - 14ç§
    (A[(A.ConduitGeneral = 100)] = "ConduitGeneral"),
    (A[(A.ConduitLine = 101)] = "ConduitLine"),
    (A[(A.ConduitElbow = 102)] = "ConduitElbow"),
    (A[(A.ConduitTee = 103)] = "ConduitTee"),
    (A[(A.ConduitCross = 104)] = "ConduitCross"),
    (A[(A.ConduitJointBox = 105)] = "ConduitJointBox"),
    (A[(A.ConduitLighting = 106)] = "ConduitLighting"),
    (A[(A.ConduitPanelBox = 107)] = "ConduitPanelBox"),
    (A[(A.ConduitStraightJoint = 108)] = "ConduitStraightJoint"),
    (A[(A.ConduitBridge = 109)] = "ConduitBridge"),
    (A[(A.ConduitConnectorBox = 110)] = "ConduitConnectorBox"),
    (A[(A.ConduitVirtualLine = 111)] = "ConduitVirtualLine"),
    (A[(A.ConduitLintel = 112)] = "ConduitLintel"),
    
    // æ°´ç®¡ (200-220) - 21ç§
    (A[(A.PipeGeneral = 200)] = "PipeGeneral"),
    (A[(A.PipeLine = 201)] = "PipeLine"),
    (A[(A.PipeElbow = 202)] = "PipeElbow"),
    (A[(A.PipeElbow45 = 203)] = "PipeElbow45"),
    (A[(A.PipeTee = 204)] = "PipeTee"),
    (A[(A.PipeUnion = 205)] = "PipeUnion"),
    (A[(A.PipeBridge = 206)] = "PipeBridge"),
    (A[(A.PipeCap = 207)] = "PipeCap"),
    (A[(A.PipeThreadedElbow = 208)] = "PipeThreadedElbow"),
    (A[(A.PipeThreadedCap = 209)] = "PipeThreadedCap"),
    (A[(A.PipeThreadedUnion = 210)] = "PipeThreadedUnion"),
    (A[(A.PipeThreadedTee = 211)] = "PipeThreadedTee"),
    (A[(A.PipeTransition = 212)] = "PipeTransition"),
    (A[(A.PipeBallValve = 213)] = "PipeBallValve"),
    (A[(A.PipeKitzValue = 214)] = "PipeKitzValue"),
    (A[(A.PipeThreadedElbowWithCap = 215)] = "PipeThreadedElbowWithCap"),
    (A[(A.PipeVirtualLine = 216)] = "PipeVirtualLine"),
    (A[(A.PipeVirtualBox = 217)] = "PipeVirtualBox"),
    (A[(A.PipeConnectorBox = 218)] = "PipeConnectorBox"),
    (A[(A.PipeStraightJoint = 219)] = "PipeStraightJoint"),
    (A[(A.PipeLintel = 220)] = "PipeLintel"),
    
    // åˆ¶å†·å‰‚ç®¡é“ (300-312) - 13ç§
    (A[(A.RefrigerantGeneral = 300)] = "RefrigerantGeneral"),
    (A[(A.RefrigerantLine = 301)] = "RefrigerantLine"),
    (A[(A.RefrigerantElbow = 302)] = "RefrigerantElbow"),
    (A[(A.RefrigerantBranchY = 303)] = "RefrigerantBranchY"),
    (A[(A.RefrigerantBranchU = 304)] = "RefrigerantBranchU"),
    (A[(A.RefrigerantVirtualBox = 305)] = "RefrigerantVirtualBox"),
    (A[(A.RefrigerantConnectorBox = 306)] = "RefrigerantConnectorBox"),
    (A[(A.RefrigerantVirtualLine = 307)] = "RefrigerantVirtualLine"),
    (A[(A.RefrigerantStraightJoint = 308)] = "RefrigerantStraightJoint"),
    (A[(A.RefrigerantBridge = 309)] = "RefrigerantBridge"),
    (A[(A.RefrigerantVirtual = 310)] = "RefrigerantVirtual"),
    (A[(A.RefrigerantLintel = 311)] = "RefrigerantLintel"),
    (A[(A.RefrigerantTee = 312)] = "RefrigerantTee"),
    
    // å†·å‡æ°´ç®¡é“ (400-409) - 10ç§
    (A[(A.CondensationGeneral = 400)] = "CondensationGeneral"),
    (A[(A.CondensationLine = 401)] = "CondensationLine"),
    (A[(A.CondensationElbow = 402)] = "CondensationElbow"),
    (A[(A.CondensationTee = 403)] = "CondensationTee"),
    (A[(A.CondensationVirtualBox = 404)] = "CondensationVirtualBox"),
    (A[(A.CondensationVirtualLine = 405)] = "CondensationVirtualLine"),
    (A[(A.CondensationConnectorBox = 406)] = "CondensationConnectorBox"),
    (A[(A.CondensationStraightJoint = 407)] = "CondensationStraightJoint"),
    (A[(A.CondensationBridge = 408)] = "CondensationBridge"),
    (A[(A.CondensationLintel = 409)] = "CondensationLintel"),
    
    // æ–°é£/æ’é£ç®¡é“ (500-509) - 10ç§
    (A[(A.VentilationGeneral = 500)] = "VentilationGeneral"),
    (A[(A.VentilationLine = 501)] = "VentilationLine"),
    (A[(A.VentilationElbow = 502)] = "VentilationElbow"),
    (A[(A.VentilationTee = 503)] = "VentilationTee"),
    (A[(A.VentilationVirtualBox = 504)] = "VentilationVirtualBox"),
    (A[(A.VentilationVirtualLine = 505)] = "VentilationVirtualLine"),
    
(A[(A.VentilationConnectorBox = 506)] = "VentilationConnectorBox"),
    (A[(A.VentilationStraightJoint = 507)] = "VentilationStraightJoint"),
    (A[(A.VentilationLintel = 508)] = "VentilationLintel"),
    (A[(A.VentilationBridge = 509)] = "VentilationBridge"),
    
    // åœ°æš–ç®¡é“ (600-610) - 11ç§
    (A[(A.FloorHeatingGeneral = 600)] = "FloorHeatingGeneral"),
    (A[(A.FloorHeatingLine = 601)] = "FloorHeatingLine"),
    (A[(A.FloorHeatingElbow = 602)] = "FloorHeatingElbow"),
    (A[(A.FloorHeatingVirtualBox = 603)] = "FloorHeatingVirtualBox"),
    (A[(A.FloorHeatingVirtualLine = 604)] = "FloorHeatingVirtualLine"),
    (A[(A.FloorHeatingConnectorBox = 605)] = "FloorHeatingConnectorBox"),
    (A[(A.FloorHeatingStraightJoint = 606)] = "FloorHeatingStraightJoint"),
    (A[(A.FloorHeatingBridge = 607)] = "FloorHeatingBridge"),
    (A[(A.FloorHeatingVirtual = 608)] = "FloorHeatingVirtual"),
    (A[(A.FloorHeatingLintel = 609)] = "FloorHeatingLintel"),
    (A[(A.FloorHeatingTee = 610)] = "FloorHeatingTee"),
    
    // æ°´ç©ºè°ƒç®¡é“ (700-709) - 10ç§
    (A[(A.WaterAirConditionGeneral = 700)] = "WaterAirConditionGeneral"),
    (A[(A.WaterAirConditionLine = 701)] = "WaterAirConditionLine"),
    (A[(A.WaterAirConditionElbow = 702)] = "WaterAirConditionElbow"),
    (A[(A.WaterAirConditionTee = 703)] = "WaterAirConditionTee"),
    (A[(A.WaterAirConditionVirtualBox = 704)] = "WaterAirConditionVirtualBox"),
    (A[(A.WaterAirConditionVirtualLine = 705)] = "WaterAirConditionVirtualLine"),
    (A[(A.WaterAirConditionConnectorBox = 706)] = "WaterAirConditionConnectorBox"),
    (A[(A.WaterAirConditionStraightJoint = 707)] = "WaterAirConditionStraightJoint"),
    (A[(A.WaterAirConditionBridge = 708)] = "WaterAirConditionBridge"),
    (A[(A.WaterAirConditionLintel = 709)] = "WaterAirConditionLintel"),
    
    // æ’æ°´ç®¡é“ (800+)
    (A[(A.DrainWaterGeneral = 800)] = "DrainWaterGeneral"),
})(d || (d = {}));
```

### 15.6 ç³»ç»Ÿå‰ç¼€å‘½åè§„èŒƒ

**æºç ä½ç½®**: [`module_6l8a.js:106-108`](dist5/static/-fe-pub-cmn-micro-tool-base/micros/kujiale-bim-tool-page-mep-kaf-plugin/entry.3c01bf67dc49a68b970b_dewebpack/module_6l8a.js:106)

```javascript
var k;
(function (R) {
    (R.WaterPurifier = "å‡€æ°´-"),
    (R.WaterAirCondition = "æ°´ç©ºè°ƒ-")
})(k || (k = {}));
```

---

## 16. æ ¸å¿ƒæ•°æ®ç»“æ„

### 16.1 ç¢°æ’ç»“æœæ•°æ®ç»“æ„

**æºç ä½ç½®**: [`module_9ikq.js:182-189`](dist5/static/-fe-pub-cmn-micro-tool-base/micros/kujiale-bim-tool-page-mep-kaf-plugin/entry.3c01bf67dc49a68b970b_dewebpack/module_9ikq.js:182)

```javascript
(this.collisionResult = {
    intersectPoint: b,      // ç¢°æ’äº¤ç‚¹ (Point3d)
    type: g.d.Bridge,       // ç¢°æ’ç±»å‹ (Bridge)
    extraInfo: {}           // é¢å¤–ä¿¡æ¯ï¼ˆå˜æ¢çŸ©é˜µç­‰ï¼‰
})
```

**Lintelç¢°æ’ç»“æœ**:

**æºç ä½ç½®**: [`module_3rch.js:382-390`](dist5/static/-fe-pub-cmn-micro-tool-base/micros/kujiale-bim-tool-page-mep-kaf-plugin/entry.3c01bf67dc49a68b970b_dewebpack/module_3rch.js:382)

```javascript
(this.collisionResult = {
    collisionObject: Object(g.b)(P),    // ç¢°æ’å¯¹è±¡ï¼ˆæ¢ï¼‰
    intersectPoint: E,                  // äº¤ç‚¹
    type: O.d.Lintel,                   // ç¢°æ’ç±»å‹ (Lintel)
    extraInfo: {}                       // é¢å¤–ä¿¡æ¯
})
```

### 16.2 é¿è®©è·¯å¾„æ•°æ®ç»“æ„

**Bridgeé¿è®©è·¯å¾„**:

**æºç ä½ç½®**: [`module_9ikq.js:262-270`](dist5/static/-fe-pub-cmn-micro-tool-base/micros/kujiale-bim-tool-page-mep-kaf-plugin/entry.3c01bf67dc49a68b970b_dewebpack/module_9ikq.js:262)

```javascript
var je = new d.a();
(oe = je.points).push.apply(
    oe,
    i([], S(be.getApproximatePoints()), !1)    // Bezieræ›²çº¿ç¦»æ•£ç‚¹
);
je.setTubeId(ae.id);              // å…³è”ç®¡é“ID
je.setIntersectPoint(te);         // äº¤ç‚¹
je.setTransform(de);              // å˜æ¢çŸ©é˜µ
Z.push(je);                       // æ·»åŠ åˆ°ç»“æœé›†
```

**Lintelé¿è®©è·¯å¾„**:

**æºç ä½ç½®**: [`module_3rch.js:253-258`](dist5/static/-fe-pub-cmn-micro-tool-base/micros/kujiale-bim-tool-page-mep-kaf-plugin/entry.3c01bf67dc49a68b970b_dewebpack/module_3rch.js:253)

```javascript
var be = new f.a();
be.points.push(de, ue, Se, Te);    // 4ä¸ªè§’ç‚¹å½¢æˆçŸ©å½¢è·¯å¾„
be.setTubeId(ne.id);               // å…³è”ç®¡é“ID
be.setIntersectPoint(Ee);          // äº¤ç‚¹
be.setTransform(me);               // å˜æ¢çŸ©é˜µ
Z.push(be);                        // æ·»åŠ åˆ°ç»“æœé›†
```

### 16.3 æ‹“æ‰‘å¯¹è±¡ç»“æ„

**Vertexï¼ˆé¡¶ç‚¹ï¼‰ç»“æ„**:
- `id`: å”¯ä¸€æ ‡è¯†
- `position`: 3Dåæ ‡ (x, y, z)
- `linkedTube`: å…³è”çš„ç®¡é“å¯¹è±¡
- `linkedModel`: å…³è”çš„è®¾å¤‡æ¨¡å‹
- `edges`: è¿æ¥çš„è¾¹é›†åˆ

**Edgeï¼ˆè¾¹ï¼‰ç»“æ„**:
- `id`: å”¯ä¸€æ ‡è¯†
- `start`: èµ·ç‚¹é¡¶ç‚¹
- `end`: ç»ˆç‚¹é¡¶ç‚¹
- `linkedTube`: å…³è”çš„ç®¡é“å¯¹è±¡
- `vector`: æ–¹å‘å‘é‡

**Pathï¼ˆè·¯å¾„ï¼‰ç»“æ„**:
- `vertices`: Set<Vertex> - é¡¶ç‚¹é›†åˆ
- `edges`: Set<Edge> - è¾¹é›†åˆ
- `system`: å…³è”çš„ç³»ç»Ÿå¯¹è±¡

---

## 17. æŠ€æœ¯ç‰¹ç‚¹æ€»ç»“

### 17.1 ç¢°æ’æ£€æµ‹ç‰¹ç‚¹

1. **ç±»å‹åŒ–æ£€æµ‹**: ä¸åŒç®¡é“ç±»å‹æœ‰ä¸åŒçš„æ£€æµ‹ç­–ç•¥
2. **åŒé‡æ£€æµ‹**: åŒæ—¶æ£€æµ‹ç®¡é“ç¢°æ’å’Œæ¢ç¢°æ’
3. **æ™ºèƒ½è¿‡æ»¤**: åœ°æš–ã€æ–¹ç®¡ç­‰ç‰¹æ®Šç±»å‹ä¸è¿›è¡Œæ£€æµ‹
4. **å®æ—¶è®¡ç®—**: ç»˜åˆ¶è¿‡ç¨‹ä¸­å®æ—¶æ£€æµ‹ç¢°æ’
5. **ç²¾ç¡®è®¡ç®—**: ä½¿ç”¨çº¿æ®µæ±‚äº¤ç®—æ³•ï¼Œå®¹å·®0.001mm

### 17.2 é¿è®©ç®—æ³•ç‰¹ç‚¹

1. **åŒæ¨¡å¼é¿è®©**:
   - Bridgeæ¨¡å¼ï¼šBezieræ›²çº¿å¹³æ»‘è¿‡æ¸¡ï¼ˆç”¨äºç®¡é“äº¤å‰ï¼‰
   - Lintelæ¨¡å¼ï¼šçŸ©å½¢æ¡†æ¶é¿è®©ï¼ˆç”¨äºæ¢é¿è®©ï¼‰

2. **å‚æ•°å¯è°ƒ**:
   - é¿è®©æ–¹å‘ï¼šå¯å¾ªç¯åˆ‡æ¢ï¼ˆ0, 1, 2...ï¼‰
   - é¿è®©è§’åº¦ï¼šBridgeé»˜è®¤45Â°
   - é¿è®©åç§»ï¼šLintelé»˜è®¤600mm
   - é¿è®©å®½åº¦ï¼šLintelé»˜è®¤300mm

3. **å‡ ä½•è®¡ç®—**:
   - å‚ç›´å¹³é¢æ±‚äº¤
   - æ—‹è½¬çŸ©é˜µå˜æ¢
   - Bezieræ›²çº¿ç”Ÿæˆ
   - æ­£äº¤åŸºå‘é‡è®¡ç®—

### 17.3 éªŒè¯ç³»ç»Ÿç‰¹ç‚¹

1. **9å±‚éªŒè¯ä½“ç³»**:
   - æ‹“æ‰‘å®Œæ•´æ€§
   - ç®¡é“æ‹“æ‰‘
   - æ¨¡å‹è¿æ¥å™¨
   - ç³»ç»Ÿè¿æ¥å™¨
   - å‚æ•°ç±»å‹
   - ç³»ç»Ÿç®¡é“
   - è·¯å¾„æ•°æ®
   - é¡¶ç‚¹è¾¹æ•°
   - åœ°æš–å›è·¯

2. **æ€§èƒ½ä¼˜åŒ–**:
   - ç®¡é“æ•°>2000æ—¶å¯ç”¨å¿«é€Ÿæ£€æŸ¥æ¨¡å¼
   - æ”¯æŒå³æ—¶éªŒè¯å’Œå»¶è¿ŸéªŒè¯
   - å¯é…ç½®éªŒè¯çº§åˆ«

3. **é”™è¯¯æç¤º**:
   - ä¸­æ–‡é”™è¯¯ä¿¡æ¯
   - ç²¾ç¡®å®šä½é”™è¯¯ID
   - Toastæç¤ºï¼Œ5ç§’è¶…æ—¶

---

## 18. æ¶æ„è®¾è®¡æ¨¡å¼

### 18.1 å·¥å‚æ¨¡å¼

**æºç ä½ç½®**: [`module_uocc.js:1896-1914`](dist5/static/-fe-pub-cmn-micro-tool-base/micros/kujiale-bim-tool-page-mep-kaf-plugin/entry.3c01bf67dc49a68b970b_dewebpack/module_uocc.js:1896)

```javascript
function ht(at, ke) {
    if (ke)
        switch (at) {
            case K.b.Refrigerant:
                return new De(ke);    // åˆ¶å†·å‰‚ä¸“ç”¨è½¬æ¢å™¨
            
            case K.b.Pipe:
            case K.b.WaterAirCondition:
            case K.b.Condensation:
            case K.b.FloorHeating:
            case K.b.VentilationDirty:
            case K.b.VentilationFresh:
            case K.b.MepCommon:
            case K.b.WeakCurrent:
            case K.b.Conduit:
            default:
                return new Ee(ke);    // é€šç”¨è½¬æ¢å™¨
        }
}
```

### 18.2 ç­–ç•¥æ¨¡å¼

**ç¢°æ’æ£€æµ‹ç­–ç•¥**:

**æºç ä½ç½®**: [`module_uocc.js:29-74`](dist5/static/-fe-pub-cmn-micro-tool-base/micros/kujiale-bim-tool-page-mep-kaf-plugin/entry.3c01bf67dc49a68b970b_dewebpack/module_uocc.js:29)

```javascript
function l(at) {
    var ke = M.MepPlugin.stateManager.functionPanel.drawTubeFunctionPanel.getShape();
    
    // ç­–ç•¥1: æ–¹ç®¡ä¸æ£€æµ‹
    if (ke && Object(C.j)(ke)) return {
        detectTube: !1,
        detectBeam: !1
    };
    
    // ç­–ç•¥2: é»˜è®¤ç­–ç•¥
    var $require = {
        detectTube: !0,
        detectBeam: !1
    };
    
    // ç­–ç•¥3-6: æ ¹æ®ç®¡é“ç±»å‹é€‰æ‹©ç­–ç•¥
    switch (at) {
        case 
K.b.VentilationDirty:
        case K.b.VentilationFresh:
            return { detectTube: !0, detectBeam: !0 };    // æ–°é£/æ’é£å…¨æ£€æµ‹
        
        case K.b.WaterAirCondition:
        case K.b.DrainWater:
            return { detectTube: !0, detectBeam: !0 };    // æ°´ç©ºè°ƒ/æ’æ°´å…¨æ£€æµ‹
        
        case K.b.FloorHeating:
            return { detectTube: !1, detectBeam: !1 };    // åœ°æš–ä¸æ£€æµ‹
        
        case K.b.MepCommon:
            return { detectTube: !1, detectBeam: !1 };    // é€šç”¨MEPä¸æ£€æµ‹
        
        default:
            return $require;                              // å…¶ä»–ä½¿ç”¨é»˜è®¤ç­–ç•¥
    }
}
```

### 18.3 ç»§æ‰¿æ¨¡å¼

**æºç ä½ç½®**: [`module_9ikq.js:125-131`](dist5/static/-fe-pub-cmn-micro-tool-base/micros/kujiale-bim-tool-page-mep-kaf-plugin/entry.3c01bf67dc49a68b970b_dewebpack/module_9ikq.js:125)

```javascript
var a = (function (h) {
    p(c, h);    // ç»§æ‰¿è‡ªåŸºç±»
    function c() {
        return (h !== null && h.apply(this, arguments)) || this;
    }
    return c;
})(m.a);    // åŸºç±»ï¼šm.a
```

**ç±»ç»§æ‰¿å…³ç³»**:
```
m.a (åŸºç±»)
  â”œâ”€â”€ Bridgeé¿è®©ç±» (module_9ikq.js)
  â””â”€â”€ Lintelé¿è®©ç±» (module_3rch.js)

Ee (åŸºç¡€è½¬æ¢å™¨)
  â””â”€â”€ De (åˆ¶å†·å‰‚ä¸“ç”¨è½¬æ¢å™¨) (module_uocc.js:1129-1431)
```

### 18.4 Map/Seté›†åˆæ¨¡å¼

**æºç ä½ç½®**: [`module_uocc.js:205-210`](dist5/static/-fe-pub-cmn-micro-tool-base/micros/kujiale-bim-tool-page-mep-kaf-plugin/entry.3c01bf67dc49a68b970b_dewebpack/module_uocc.js:205)

```javascript
function at(ke) {
    (this.collisionDetectionMap = new Map()),    // ç¢°æ’æ£€æµ‹æ˜ å°„
    (this.vertices = new Set()),                  // é¡¶ç‚¹é›†åˆï¼ˆå»é‡ï¼‰
    (this.edges = new Set()),                     // è¾¹é›†åˆï¼ˆå»é‡ï¼‰
    (this.generator = ke);                        // ç”Ÿæˆå™¨å¯¹è±¡
}
```

**ä¼˜åŠ¿**:
- Mapç”¨äºå¿«é€ŸæŸ¥æ‰¾ç¢°æ’ä¿¡æ¯
- Setè‡ªåŠ¨å»é‡ï¼Œé¿å…é‡å¤é¡¶ç‚¹/è¾¹
- O(1)æŸ¥æ‰¾å¤æ‚åº¦

---

## 19. æ€§èƒ½ä¼˜åŒ–ç­–ç•¥

### 19.1 å¤§è§„æ¨¡ç®¡é“ä¼˜åŒ–

**æºç ä½ç½®**: [`module_pckm.js:1492-1495`](dist5/static/-fe-pub-cmn-micro-tool-base/micros/kujiale-bim-tool-page-mep-kaf-plugin/entry.3c01bf67dc49a68b970b_dewebpack/module_pckm.js:1492)

```javascript
var we = localStorage.getItem("mepVerifyImmediately") === n.d.TRUE,
ze = we,
Qe = et.getTubesArray();

// æ€§èƒ½ä¼˜åŒ–ï¼šç®¡é“æ•°è¶…è¿‡2000æ—¶ï¼Œä»…è¿›è¡Œå¿«é€Ÿæ£€æŸ¥
if (!ze && Qe.length > 2e3) return !0;
```

**ç­–ç•¥**:
- ç®¡é“æ•° â‰¤ 2000ï¼šå®Œæ•´éªŒè¯ï¼ˆ9é¡¹æ£€æŸ¥ï¼‰
- ç®¡é“æ•° > 2000ï¼šå¿«é€ŸéªŒè¯ï¼ˆä»…æ‹“æ‰‘æ£€æŸ¥ï¼‰
- å¯é€šè¿‡localStorageå¼ºåˆ¶å¼€å¯å®Œæ•´éªŒè¯

### 19.2 ç¢°æ’æ£€æµ‹ä¼˜åŒ–

**è·ç¦»ç­›é€‰**:

**æºç ä½ç½®**: [`module_uocc.js:890-893`](dist5/static/-fe-pub-cmn-micro-tool-base/micros/kujiale-bim-tool-page-mep-kaf-plugin/entry.3c01bf67dc49a68b970b_dewebpack/module_uocc.js:890)

```javascript
var Ct = ((pt = Ke.intersectEdge.getLinkedTube()) === null || pt === void 0
    ? void 0
    : pt.getDiameter()) || 0,
Nt = ot.intersectPoint.distanceTo(Ke.intersectPoint);

// ä¼˜åŒ–ï¼šè·ç¦»å°äº(ç®¡å¾„1 + ç®¡å¾„2) * 1.5æ—¶åˆå¹¶æ£€æµ‹
if (Nt > (At + Ct) * 1.5) break;
```

**æœ€å°é—´è·æ£€æŸ¥**:

**æºç ä½ç½®**: [`module_uocc.js:842-846`](dist5/static/-fe-pub-cmn-micro-tool-base/micros/kujiale-bim-tool-page-mep-kaf-plugin/entry.3c01bf67dc49a68b970b_dewebpack/module_uocc.js:842)

```javascript
var fr = ur.distanceTo(_t),
ci = ur.distanceTo(ct),
Wi = (Nr.getDiameter() * 3) / 2;

// æœ€å°é—´è·ï¼šç®¡å¾„çš„1.5å€
if (fr < Wi || ci < Wi) {
    ur = null;    // è·ç¦»å¤ªè¿‘ï¼Œå¿½ç•¥æ­¤ç¢°æ’ç‚¹
}
```

### 19.3 è·¯å¾„åˆå¹¶ä¼˜åŒ–

**æºç ä½ç½®**: [`module_uocc.js:1066-1078`](dist5/static/-fe-pub-cmn-micro-tool-base/micros/kujiale-bim-tool-page-mep-kaf-plugin/entry.3c01bf67dc49a68b970b_dewebpack/module_uocc.js:1066)

```javascript
var Et = pt.size;

// åˆå¹¶å¹³è¡Œè·¯å¾„
Object(m.b)(
    pt,
    !1,
    Array.from(this.collisionDetectionMap.keys()),
    $require
),

// ä»…åœ¨è·¯å¾„æ•°é‡å˜åŒ–æ—¶æ›´æ–°é›†åˆ
Et !== pt.size &&
pt.forEach(function (xt) {
    xt instanceof v.a
        ? dt.vertices.add(xt)
        : xt instanceof Y.b && dt.edges.add(xt);
});
```

---

## 20. å…³é”®ç®—æ³•è¯¦è§£

### 20.1 Bezieræ›²çº¿ç”Ÿæˆç®—æ³•

**æºç ä½ç½®**: [`module_9ikq.js:250-261`](dist5/static/-fe-pub-cmn-micro-tool-base/micros/kujiale-bim-tool-page-mep-kaf-plugin/entry.3c01bf67dc49a68b970b_dewebpack/module_9ikq.js:250)

```javascript
// è®¡ç®—é¿è®©å‚æ•°
var xe = ae.getDiameter(),                      // ç®¡å¾„
Be = ($ / 180) * Math.PI,                       // è§’åº¦è½¬å¼§åº¦
me = xe * 3,                                    // é«˜åº¦åŸºæ•°=ç®¡å¾„*3
ie = Math.cos(Math.PI / 2 - Be) * me,           // æ°´å¹³è·ç¦»
ue = Math.tan(Be) * ie,                         // å‚ç›´é«˜åº¦

// åº”ç”¨æ—‹è½¬
he = t.Matrix4.makeRotationAxis(Ee, (Math.PI / 2) * z);
Le = Le.appliedMatrix4(he);

// è®¡ç®—æ§åˆ¶ç‚¹
var Se = De.added(Le.multiplied(ue)),           // ä¸­é—´æ§åˆ¶ç‚¹ï¼ˆä¸Šå‡ï¼‰
Me = De.added(Ee.multiplied(ie)),               // ç»ˆç‚¹ï¼ˆå‰è¿›ï¼‰
Te = De.added(Ee.multiplied(-ie)),              // èµ·ç‚¹ï¼ˆåé€€ï¼‰

// åˆ›å»º3æ¬¡Bezieræ›²çº¿
be = new t.BezierCurve3d([Te, Se, Me]);
```

**å‡ ä½•æ„ä¹‰**:
```
Te (èµ·ç‚¹) -----> Se (æ§åˆ¶ç‚¹ï¼ŒæŠ¬é«˜) -----> Me (ç»ˆç‚¹)
      æ°´å¹³è·ç¦»ie        å‚ç›´é«˜åº¦ue        æ°´å¹³è·ç¦»ie
```

### 20.2 çŸ©å½¢é¿è®©è·¯å¾„ç®—æ³•

**æºç ä½ç½®**: [`module_3rch.js:246-254`](dist5/static/-fe-pub-cmn-micro-tool-base/micros/kujiale-bim-tool-page-mep-kaf-plugin/entry.3c01bf67dc49a68b970b_dewebpack/module_3rch.js:246)

```javascript
// è®¡ç®—çŸ©å½¢4ä¸ªè§’ç‚¹
var ie = Le.added(xe.multiplied(R)),              // åŸºå‡†ç‚¹ï¼ˆä¸‹é™Rè·ç¦»ï¼‰
ue = ie.added(Re.multiplied(X / 2)),              // å³ä¸­ç‚¹
he = ue.added(Re.multiplied(50)),                 // å³ç«¯ç‚¹ï¼ˆå»¶ä¼¸50mmï¼‰
de = De.getClosestPoint(he),                      // æŠ•å½±åˆ°åŸç®¡é“
Se = ie.added(Re.multiplied(-X / 2)),             // å·¦ä¸­ç‚¹
Me = Se.added(Re.multiplied(-50)),                // å·¦ç«¯ç‚¹ï¼ˆå»¶ä¼¸50mmï¼‰
Te = De.getClosestPoint(Me);                      // æŠ•å½±åˆ°åŸç®¡é“

// åˆ›å»ºçŸ©å½¢è·¯å¾„
be.points.push(de, ue, Se, Te);
```

**å‡ ä½•å½¢çŠ¶**:
```
de -------- ue (å®½åº¦X)
 |          |
 | åç§»R    |
 |          |
Te -------- Se
```

### 20.3 å‚ç›´å¹³é¢æ±‚äº¤ç®—æ³•

**Bridgeç®—æ³•ä½¿ç”¨**:

**æºç ä½ç½®**: [`module_9ikq.js:215-230`](dist5/static/-fe-pub-cmn-micro-tool-base/micros/kujiale-bim-tool-page-mep-kaf-plugin/entry.3c01bf67dc49a68b970b_dewebpack/module_9ikq.js:215)

```javascript
// è·å–ç¼–è¾‘ç®¡é“çš„åˆ‡çº¿
var w = j.getLayoutRef(),
R = w.getTangent(w.getVertices()[0]).clone(),

// åˆ›å»ºå‚ç›´äºåˆ‡çº¿çš„å¹³é¢
X = this.getPerpendicularPlane(R, new f.a(v));

// å¯¹äºæ¯æ¡è¢«é€‰ç®¡é“
var pe = ne.getTangent(ne.getVertices()[0]).normalize(),
ce = new y.a(ne.getStart().getPosition(), pe),  
// å°„çº¿
// è®¡ç®—äº¤ç‚¹
te = X.intersectRay(ce, !1);
```

**ç®—æ³•æµç¨‹**:
```
1. è·å–ç¼–è¾‘ç®¡é“åˆ‡çº¿æ–¹å‘å‘é‡ R
2. åˆ›å»ºå‚ç›´äºRçš„å¹³é¢ Xï¼Œè¿‡ç¢°æ’ç‚¹v
3. å¯¹æ¯æ¡è¢«é¿è®©ç®¡é“ï¼š
   a. è·å–ç®¡é“èµ·ç‚¹å’Œåˆ‡çº¿æ–¹å‘ pe
   b. åˆ›å»ºå°„çº¿ ce = (èµ·ç‚¹, pe)
   c. è®¡ç®—å°„çº¿ä¸å¹³é¢Xçš„äº¤ç‚¹ te
4. åŸºäºäº¤ç‚¹ç”Ÿæˆé¿è®©è·¯å¾„
```

### 20.4 å˜æ¢çŸ©é˜µè®¡ç®—

**Bridgeå˜æ¢**:

**æºç ä½ç½®**: [`module_9ikq.js:355-361`](dist5/static/-fe-pub-cmn-micro-tool-base/micros/kujiale-bim-tool-page-mep-kaf-plugin/entry.3c01bf67dc49a68b970b_dewebpack/module_9ikq.js:355)

```javascript
(c.prototype.calculateBridgeTransform = function (b, E, P) {
    var j = new K.a(),              // 4x4å˜æ¢çŸ©é˜µ
    Y = new f.a(P),                 // ä¸Šæ–¹å‘å‘é‡
    B = b.clone().cross(Y).normalize();    // å³æ–¹å‘å‘é‡ = å‰Ã—ä¸Š
    
    // æ„å»ºæ­£äº¤åŸº
    return j.makeBasis(B, b, Y),    // (å³, å‰, ä¸Š)
           j.setPosition(new f.a(E)),    // è®¾ç½®åŸç‚¹
           j;
})
```

**Lintelå˜æ¢**:

**æºç ä½ç½®**: [`module_3rch.js:393-399`](dist5/static/-fe-pub-cmn-micro-tool-base/micros/kujiale-bim-tool-page-mep-kaf-plugin/entry.3c01bf67dc49a68b970b_dewebpack/module_3rch.js:393)

```javascript
(b.prototype.calculateLintelTransform = function (E, P, j) {
    var Y = new W.a(),              // 4x4å˜æ¢çŸ©é˜µ
    B = new D.a(j).clone().negate(),         // ä¸‹æ–¹å‘å‘é‡ï¼ˆå–åï¼‰
    v = E.clone().cross(B).normalize();      // å³æ–¹å‘å‘é‡ = å‰Ã—ä¸‹
    
    return Y.makeBasis(v, E, B),    // (å³, å‰, ä¸‹)
           Y.setPosition(new D.a(P)),    // è®¾ç½®åŸç‚¹
           Y;
})
```

---

## 21. å›½æ ‡éªŒè¯è§„åˆ™æ€»ç»“

### 21.1 æ‹“æ‰‘è§„åˆ™éªŒè¯

| éªŒè¯é¡¹ | è§„åˆ™ | é”™è¯¯æç¤º |
|--------|------|----------|
| é¡¶ç‚¹å…³è” | æ¯ä¸ªvertexå¿…é¡»å…³è”tube | "vertexæœªè®¾ç½®tube, vertexId:XXX" |
| è¾¹å…³è” | æ¯ä¸ªedgeå¿…é¡»å…³è”tubeå’Œèµ·ç»ˆç‚¹ | "edgeæœªè®¾ç½®tube/start/end, edgeId:XXX" |
| ç®¡é“å¸ƒå±€ | æ¯ä¸ªtubeå¿…é¡»æœ‰layoutRef | "tubeæœªè®¾ç½®layoutRef, tubeId:XXX" |

### 21.2 è¿æ¥å™¨è§„åˆ™éªŒè¯

| éªŒè¯é¡¹ | è§„åˆ™ | é”™è¯¯æç¤º |
|--------|------|----------|
| é¡¶ç‚¹å­˜åœ¨æ€§ | relationMapä¸­çš„vertexIdå¿…é¡»åœ¨designä¸­å­˜åœ¨ | "relationMapä¸­çš„vertexIdåœ¨designä¸­ä¸å­˜åœ¨" |
| è¿æ¥å™¨å­˜åœ¨æ€§ | relationMapä¸­çš„connectorIdå¿…é¡»åœ¨designä¸­å­˜åœ¨ | "relationMapä¸­çš„connectorIdåœ¨designä¸­ä¸å­˜åœ¨" |
| è¿æ¥å™¨å”¯ä¸€æ€§ | æ¯ä¸ªconnectoråªèƒ½è¢«ä¸€ä¸ªvertexå ç”¨ | "relationMapä¸­çš„connectorIdè¢«å¤šä¸ªvertexå ç”¨" |
| Hostæœ‰æ•ˆæ€§ | tube connectorçš„host vertexå¿…é¡»å­˜åœ¨ | "tube connectorä¸­çš„host vertexä¸å­˜åœ¨" |

### 21.3 ç³»ç»Ÿè§„åˆ™éªŒè¯

| éªŒè¯é¡¹ | è§„åˆ™ | é”™è¯¯æç¤º |
|--------|------|----------|
| ç³»ç»Ÿå…³è” | tubeå¿…é¡»å…³è”systemï¼ˆé™¤éå…³è”äº†modelï¼‰ | "tubeæœªè®¾ç½®system" |
| ç³»ç»Ÿä¸€è‡´æ€§ | åŒä¸€pathä¸­çš„æ‰€æœ‰tubeå¿…é¡»å±äºåŒä¸€system | "pathä¸­çš„systemä¸ä¸€è‡´" |
| æ§åˆ¶çº¿æœ‰æ•ˆæ€§ | control lineçš„startå’Œend modelå¿…é¡»å­˜åœ¨ | "control lineä¸­çš„startæˆ–end modelä¸å­˜åœ¨" |

### 21.4 å‚æ•°è§„åˆ™éªŒè¯

| å‚æ•°ç±»å‹ | æ•°æ®ç±»å‹ | éªŒè¯è§„åˆ™ |
|---------|---------|---------|
| IntData | number | typeof data === "number" |
| DoubleData | number | typeof data === "number" |
| StringData | string | typeof data === "string" |
| ElementData | string | typeof data === "string" |

**é”™è¯¯æç¤º**: "tubeå‚æ•°è®¾ç½®é”™è¯¯"

### 21.5 é¡¶ç‚¹è¾¹æ•°è§„åˆ™

**æºç ä½ç½®**: [`module_pckm.js:1812-1822`](dist5/static/-fe-pub-cmn-micro-tool-base/micros/kujiale-bim-tool-page-mep-kaf-plugin/entry.3c01bf67dc49a68b970b_dewebpack/module_pckm.js:1812)

| ç®¡é“ç±»å‹ | å¿…é¡»è¾¹æ•° | è¯´æ˜ |
|---------|---------|------|
| Connector | 2 | è¿æ¥å™¨ |
| Elbow | 2 | å¼¯å¤´ |
| StraightJoint | 2 | ç›´æ¥å¤´ |
| Lintel | 2 | è¿‡æ¢ |
| Bridge | 2 | æ¡¥æ¥ |
| Tee | 3 | ä¸‰é€š |
| Virtual (æ— æ¨¡å‹) | â‰¤1 | è™šæ‹Ÿé¡¶ç‚¹ |

**é”™è¯¯æç¤º**: "vertex's edgesæ•°é”™è¯¯, tubeId: XXX"

---

## 22. æ°´ç©ºè°ƒç³»ç»Ÿæ¶æ„

### 22.1 ç³»ç»Ÿç±»å‹å®šä¹‰

**æºç ä½ç½®**: [`module_xbta.js:71`](dist5/static/-fe-pub-cmn-micro-tool-base/micros/kujiale-bim-tool-page-mep-kaf-plugin/entry.3c01bf67dc49a68b970b_dewebpack/module_xbta.js:71)

```javascript
(m[(m.WaterAirCondition = 16)] = "WaterAirCondition"),
```

### 22.2 æ°´ç©ºè°ƒç®¡é“ç±»å‹

**10ç§æ°´ç©ºè°ƒç®¡é“** (ä»£ç 700-709):

**æºç ä½ç½®**: [`module_9wif.js:149-162`](dist5/static/-fe-pub-cmn-micro-tool-base/micros/kujiale-bim-tool-page-mep-kaf-plugin/entry.3c01bf67dc49a68b970b_dewebpack/module_9wif.js:149)

```javascript
(A[(A.WaterAirConditionGeneral = 700)] = "WaterAirConditionGeneral"),
(A[(A.WaterAirConditionLine = 701)] = "WaterAirConditionLine"),
(A[(A.WaterAirConditionElbow = 702)] = "WaterAirConditionElbow"),
(A[(A.WaterAirConditionTee = 703)] = "WaterAirConditionTee"),
(A[(A.WaterAirConditionVirtualBox = 704)] = "WaterAirConditionVirtualBox"),
(A[(A.WaterAirConditionVirtualLine = 705)] = "WaterAirConditionVirtualLine"),
(A[(A.WaterAirConditionConnectorBox = 706)] = "WaterAirConditionConnectorBox"),
(A[(A.WaterAirConditionStraightJoint = 707)] = "WaterAirConditionStraightJoint"),
(A[(A.WaterAirConditionBridge = 708)] = "WaterAirConditionBridge"),
(A[(A.WaterAirConditionLintel = 709)] = "WaterAirConditionLintel"),
```

### 22.3 æ°´ç©ºè°ƒå­ç±»å‹

**æºç ä½ç½®**: [`module_xbta.js:107-109`](dist5/static/-fe-pub-cmn-micro-tool-base/micros/kujiale-bim-tool-page-mep-kaf-plugin/entry.3c01bf67dc49a68b970b_dewebpack/module_xbta.js:107)

```javascript
(m[(m.WaterAirConditionSupply = 16001)] = "WaterAirConditionSupply"),  // ä¾›æ°´
(m[(m.WaterAirConditionBack = 16002)] = "WaterAirConditionBack"),      // å›æ°´
(m[(m.WaterAirConditionDrain = 16003)] = "WaterAirConditionDrain"),    // æ’æ°´
```

### 22.4 ç¢°æ’æ£€æµ‹é…ç½®

**æºç ä½ç½®**: [`module_uocc.js:52-58`](dist5/static/-fe-pub-cmn-micro-tool-base/micros/kujiale-bim-tool-page-mep-kaf-plugin/entry.3c01bf67dc49a68b970b_dewebpack/module_uocc.js:52)

```javascript
case K.b.WaterAirCondition:
case K.b.DrainWater:
return {
    detectTube: !0,    // æ£€æµ‹ç®¡é“ç¢°æ’
    detectBeam: !0     // æ£€æµ‹æ¢ç¢°æ’
};
```

---

## 23. ç³»ç»Ÿé›†æˆæ¶æ„

### 23.1 ç³»ç»Ÿç”Ÿæˆå·¥å‚

**æºç ä½ç½®**: [`module_uocc.js:1835-1895`](dist5/static/-fe-pub-cmn-micro-tool-base/micros/kujiale-bim-tool-page-mep-kaf-plugin/entry.3c01bf67dc49a68b970b_dewebpack/module_uocc.js:1835)

```javascript
function vt(at, ke, $require, dt, pt, It) {
    var Et = dt.startElement,
    xt = dt.endElement,
    Rt = dt.purpose,
    Vt = dt.startConnectorId,
    bt = dt.endConnectorId,
    Tt = dt.tubeSystemType,
    St;
    
    // æƒ…å†µ1: ä½¿ç”¨å·²æœ‰è·¯å¾„çš„ç³»ç»Ÿ
    if (pt && It) {
        (St = pt.getSystem()),
        pt.addEdges(at),
        pt.addVertexes(ke);
    }
    // æƒ…å†µ2: å…‹éš†å·²æœ‰è·¯å¾„çš„ç³»ç»Ÿ
    else if (pt && !It) {
        St = pt.getSystem().clone();
    }
    // æƒ…å†µ3: åˆ›å»ºæ–°ç³»ç»Ÿ
    else if (Tt) {
        if (Rt) {
            var Pt = Object(t.b)({
                systemType: Tt,
                purposeCode: Rt
            }),
            Ut = Pt.systemType,
            ct = Pt.subSystemType;
            St = de(Ut, ct, Et, xt, Vt, bt);
        } else {
            var _t = Te(Tt, Et, xt, Vt, bt),
            Ut = _t.systemType,
            ct = _t.subSystemType;
            St = de(Ut, ct, Et, xt, Vt, bt);
        }
    }
    // æƒ…å†µ4-9: æ ¹æ®å¸ƒå±€ç±»å‹åˆ›å»ºç³»ç»Ÿ
    else if ($require === K.b.Conduit) St = new 
d.b(A.c.Conduit);
    else if ($require === K.b.WeakCurrent) St = new d.b(A.c.WeakCurrent);
    else if ($require === K.b.Pipe) {
        var tt = Te(A.d.SupplyWater, Et, xt, Vt, bt),
        Ut = tt.systemType,
        ct = tt.subSystemType;
        St = new d.b(Ut, ct);
    }
    else if ($require === K.b.VentilationDirty || $require === K.b.VentilationFresh)
        St = Me(Et, xt, Vt, bt,
            $require === K.b.VentilationDirty
                ? A.c.VentilationDirtyAir
                : A.c.VentilationFreshAir
        );
    else if ($require === K.b.Refrigerant || $require === K.b.Condensation)
        St = he(Et, xt, Vt, bt);
    else if ($require === K.b.WaterAirCondition) {
        var ct = Te(A.d.WaterAirCon, Et, xt, Vt, bt).subSystemType;
        St = new d.b(A.c.WaterAirCondition, ct);
    }
    else if ($require === K.b.FloorHeating) {
        var ct = Te(A.d.FloorHeating, Et, xt, Vt, bt).subSystemType;
        St = new d.b(A.c.FloorHeating, ct);
    }
    
    return St;    // è¿”å›ç³»ç»Ÿå¯¹è±¡
}
```

### 23.2 è·¯å¾„è½¬æ¢ç»Ÿä¸€æ¥å£

**æºç ä½ç½®**: [`module_uocc.js:1690-1795`](dist5/static/-fe-pub-cmn-micro-tool-base/micros/kujiale-bim-tool-page-mep-kaf-plugin/entry.3c01bf67dc49a68b970b_dewebpack/module_uocc.js:1690)

```javascript
var a = function (ke, $require) {
    var dt = ke.layoutType,
    pt = ke.start,
    It = ke.end,
    Et = ke.vectors,
    xt = ke.referenceLibParameters,
    Rt = ke.tubeSystemType,
    Vt = ke.purpose,
    bt = ke.additionalToposCB,
    Tt = ke.activeFamilySpecData,
    St = [],
    
    // è·å–èµ·ç‚¹å’Œç»ˆç‚¹å…ƒç´ 
    Pt = Object(g.b)(pt.element),
    Ut = Object(g.b)(It.element),
    ct = pt.connectId,
    _t = It.connectId,
    
    // è·å–ç”Ÿæˆå™¨å’Œè½¬æ¢å™¨
    tt = y.a.getGenerator(dt),
    et = ht(dt, tt);    // å·¥å‚å‡½æ•°åˆ›å»ºè½¬æ¢å™¨
    
    if (et) {
        var we = st(ke, $require),
        ze = et.judge(Pt, Ut),
        
        // æ‰§è¡Œè·¯å¾„è½¬æ¢
        Qe = et.convert({
            layoutType: dt,
            vectors: Et,
            start: {
                element: Pt,
                connectorId: ct
            },
            end: {
                element: Ut,
                connectorId: _t
            },
            referenceLibParameters: xt || [],
            oldPath: ze,
        }),
        
        ot = Qe.getEdgesArray(),
        At = Qe.getVerticesArray();
        
        // ç”Ÿæˆç³»ç»Ÿå¯¹è±¡
        var Ke = vt(ot, At, dt, it, ze, Wt);
        
        if (Ke) {
            Ke.setMepDesign($require);
            $require.addSystem(Ke);
            Qe.setSystem(Ke);
            we.addPath(Qe);
        }
        
        // ç”Ÿæˆæœ€ç»ˆæ‹“æ‰‘å¯¹è±¡
        et.generate(St);
    }
    
    return St;
};
```

---

## 24. å®Œæ•´æŠ€æœ¯æ ˆ

### 24.1 å‡ ä½•è®¡ç®—åº“

| åº“/ç±» | åŠŸèƒ½ | ä½¿ç”¨åœºæ™¯ |
|------|------|---------|
| `Point3d` | 3Dç‚¹ | ç¢°æ’ç‚¹ã€é¡¶ç‚¹åæ ‡ |
| `Vector3d` | 3Då‘é‡ | æ–¹å‘ã€åˆ‡çº¿ |
| `Matrix4` | 4x4å˜æ¢çŸ©é˜µ | æ—‹è½¬ã€å¹³ç§»å˜æ¢ |
| `LineSeg3d` | 3Dçº¿æ®µ | ç®¡é“çº¿æ®µã€æ±‚äº¤ |
| `BezierCurve3d` | 3Dè´å¡å°”æ›²çº¿ | Bridgeé¿è®©è·¯å¾„ |
| `Plane` | 3Då¹³é¢ | å‚ç›´å¹³é¢æ±‚äº¤ |
| `Ray` | å°„çº¿ | å¹³é¢æ±‚äº¤ |
| `Tolerance` | å®¹å·® | ç²¾åº¦æ§åˆ¶(0.001mm) |

### 24.2 æ•°æ®ç»“æ„

| ç»“æ„ | å®ç° | ç”¨é€” |
|------|------|------|
| `Map` | ES6 Map | ç¢°æ’æ£€æµ‹æ˜ å°„ã€è¿æ¥å™¨æ˜ å°„ |
| `Set` | ES6 Set | é¡¶ç‚¹é›†åˆã€è¾¹é›†åˆï¼ˆå»é‡ï¼‰ |
| `Array` | JavaScript Array | ç®¡é“åˆ—è¡¨ã€è·¯å¾„ç‚¹åˆ—è¡¨ |

### 24.3 æ ¸å¿ƒç±»å±‚æ¬¡

```
åŸºç±»ä½“ç³»ï¼š
- MepConnector (è¿æ¥å™¨åŸºç±»)
  â””â”€â”€ Connector (MEPè¿æ¥å™¨å®ç°)

- AvoidanceBase (é¿è®©åŸºç±»)
  â”œâ”€â”€ BridgeAvoidance (Bridgeé¿è®©)
  â””â”€â”€ LintelAvoidance (Lintelé¿è®©)

- PathConverter (è·¯å¾„è½¬æ¢å™¨åŸºç±»)
  â”œâ”€â”€ BasicConverter (åŸºç¡€è½¬æ¢å™¨)
  â””â”€â”€ RefrigerantConverter (åˆ¶å†·å‰‚ä¸“ç”¨è½¬æ¢å™¨)

- System (ç³»ç»ŸåŸºç±»)
  â”œâ”€â”€ ElectricSystem (ç”µæ°”ç³»ç»Ÿ)
  â”œâ”€â”€ PipeSystem (ç®¡é“ç³»ç»Ÿ)
  â”œâ”€â”€ VentilationSystem (é€šé£ç³»ç»Ÿ)
  â””â”€â”€ RefrigerantSystem (åˆ¶å†·å‰‚ç³»ç»Ÿ)
```

---

## 25. å…³é”®æŠ€æœ¯æŒ‡æ ‡

### 25.1 æ€§èƒ½æŒ‡æ ‡

| æŒ‡æ ‡é¡¹ | æ•°å€¼ | è¯´æ˜ |
|--------|------|------|
| ç¢°æ’æ£€æµ‹ç²¾åº¦ | 0.001mm | Toleranceå®¹å·® |
| æœ€å°ç®¡é“é—´è· | ç®¡å¾„Ã—1.5 | é¿å…è¯¯æ£€ |
| æœ€å¤§éªŒè¯ç®¡é“æ•° | 2000æ¡ | è¶…è¿‡å¯ç”¨å¿«é€Ÿæ¨¡å¼ |
| é¿è®©é»˜è®¤è§’åº¦ | 45Â° | Bridgeé¿è®© |
| é¿è®©é»˜è®¤åç§» | 600mm | Lintelé¿è®© |
| é¿è®©é»˜è®¤å®½åº¦ | 300mm | Lintelé¿è®© |
| åœ°æš–æ’æ°´æ’è· | 16004 | å­ç³»ç»Ÿä»£ç  |

### 25.2 éªŒè¯æŒ‡æ ‡

| éªŒè¯é¡¹ | æ£€æŸ¥æ•°é‡ | é”™è¯¯æç¤ºè¯­è¨€ |
|--------|---------|-------------|
| æ‹“æ‰‘éªŒè¯ | 3é¡¹ | ä¸­æ–‡ |
| è¿æ¥å™¨éªŒè¯ | 4é¡¹ | ä¸­æ–‡ |
| ç³»ç»ŸéªŒè¯ | 3é¡¹ | ä¸­æ–‡ |
| å‚æ•°éªŒè¯ | 4ç±» | ä¸­æ–‡ |
| é¡¶ç‚¹éªŒè¯ | 7ç§ | ä¸­æ–‡ |
| æ€»è®¡ | 21é¡¹ | ä¸­æ–‡ |

---

## 26. æ ¸å¿ƒæµç¨‹å›¾

### 26.1 ç®¡é“ç»˜åˆ¶å®Œæ•´æµç¨‹

```
ç”¨æˆ·ç»˜åˆ¶ç®¡é“
    â†“
è·å–èµ·ç‚¹å’Œç»ˆç‚¹
    â†“
è·å–è·¯å¾„ç‚¹å‘é‡åˆ—è¡¨
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ç¢°æ’æ£€æµ‹é˜¶æ®µ        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 1. getCollisionConfig() - è·å–æ£€æµ‹é…ç½®
â”‚ 2. addBridge() - æ£€æµ‹ç®¡é“ç¢°æ’
â”‚ 3. addLintel() - æ£€æµ‹æ¢ç¢°æ’
â”‚ 4. æ’å…¥ç¢°æ’ç‚¹åˆ°è·¯å¾„
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  é¿è®©è·¯å¾„ç”Ÿæˆé˜¶æ®µ    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Bridgeæ¨¡å¼ï¼š
â”‚   - generateAvoidPath()
â”‚   - è®¡ç®—Bezieræ›²çº¿
â”‚   - è¿”å›å¹³æ»‘è·¯å¾„
â”‚
â”‚ Lintelæ¨¡å¼ï¼š
â”‚   - generateAvoidPath()
â”‚   - è®¡ç®—çŸ©å½¢è·¯å¾„
â”‚   - è¿”å›ç›´çº¿æ®µ
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  æ‹“æ‰‘å¯¹è±¡åˆ›å»ºé˜¶æ®µ    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 1. åˆ›å»ºé¡¶ç‚¹(Vertex)
â”‚ 2. åˆ›å»ºè¾¹(Edge)
â”‚ 3. å…³è”ç®¡é“(Tube)
â”‚ 4. è®¾ç½®ç³»ç»Ÿ(System)
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  éªŒè¯é˜¶æ®µ            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 1. verifyTopoWithoutTube()
â”‚ 2. verifyTubesWithoutTopo()
â”‚ 3. verifyModelConnector()
â”‚ 4. verifySystemConnector()
â”‚ 5. verifyParameter()
â”‚ 6. verifySystemTube()
â”‚ 7. verifyPath()
â”‚ 8. verifyVertices()
â”‚ 9. verifyCircuitForCoilPartition()
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“
éªŒè¯é€šè¿‡ â†’ ä¿å­˜ç®¡é“
éªŒè¯å¤±è´¥ â†’ æ˜¾ç¤ºé”™è¯¯æç¤º
```

### 26.2 ç¢°æ’æ£€æµ‹è¯¦ç»†æµç¨‹

```
å¼€å§‹æ£€æµ‹
    â†“
è·å–å½“å‰ç®¡é“è·¯å¾„ç‚¹åˆ—è¡¨ [P0, P1, P2, ..., Pn]
    â†“
éå†ç›¸é‚»ç‚¹å¯¹ 
(Pi, Pi+1)
    â†“
åˆ›å»ºçº¿æ®µ segment = LineSeg3d(Pi, Pi+1)
    â†“
è·å–åœºæ™¯ä¸­æ‰€æœ‰ç›¸å…³ç±»å‹çš„ç®¡é“
    â†“
å¯¹æ¯æ¡å·²å­˜åœ¨ç®¡é“ï¼š
    â†“
    è®¡ç®—çº¿æ®µäº¤ç‚¹ intersectCurve()
        â†“
        æœ‰äº¤ç‚¹ï¼Ÿ
        â”œâ”€ å¦ â†’ ç»§ç»­ä¸‹ä¸€æ¡ç®¡é“
        â””â”€ æ˜¯ â†“
            éªŒè¯äº¤ç‚¹åœ¨çº¿æ®µä¸Š
                â†“
                æ£€æŸ¥æœ€å°é—´è·(ç®¡å¾„Ã—1.5)
                    â†“
                    è·ç¦»è¶³å¤Ÿï¼Ÿ
                    â”œâ”€ å¦ â†’ å¿½ç•¥æ­¤ç¢°æ’
                    â””â”€ æ˜¯ â†“
                        ä¿å­˜ç¢°æ’ä¿¡æ¯åˆ°Map
                        æ’å…¥ç¢°æ’ç‚¹åˆ°è·¯å¾„
    â†“
è¿”å›åŒ…å«ç¢°æ’ç‚¹çš„å®Œæ•´è·¯å¾„
```

---

## 27. æºç æ¨¡å—ç´¢å¼•

### 27.1 æ ¸å¿ƒæ¨¡å—æ¸…å•

| æ¨¡å—æ–‡ä»¶ | è¡Œæ•° | ä¸»è¦åŠŸèƒ½ | å…³é”®ç±»/å‡½æ•° |
|---------|------|---------|-----------|
| module_uocc.js | 1916 | ç¢°æ’æ£€æµ‹æ ¸å¿ƒ | class Ee, addBridge(), addLintel() |
| module_9ikq.js | 366 | Bridgeé¿è®© | class a, generateAvoidPath() |
| module_3rch.js | 404 | Lintelé¿è®© | class h, generateAvoidPath() |
| module_pckm.js | 1860+ | éªŒè¯ç³»ç»Ÿ | class tt, verify(), 9ä¸ªéªŒè¯å‡½æ•° |
| module_yy3l.js | 39 | æ•°æ®æ£€æŸ¥ | checkTubeData(), checkLayoutData() |
| module_qffn.js | 187 | è¿æ¥å™¨ç®¡ç† | class y, getConstraint() |
| module_9wif.js | 200+ | å¸ƒå±€ç±»å‹æšä¸¾ | LayoutType(12), TubeType(100+) |
| module_xbta.js | 150+ | ç³»ç»Ÿç±»å‹æšä¸¾ | SystemType(20), SubSystemType(11) |
| module_tm.js | 200+ | è®¾å¤‡ç±»å‹æšä¸¾ | è®¾å¤‡ç¼–å·(3000-4500) |

### 27.2 æ–‡ä»¶è·¯å¾„æ˜ å°„

```
dist5/static/-fe-pub-cmn-micro-tool-base/micros/kujiale-bim-tool-page-mep-kaf-plugin/
â””â”€â”€ entry.3c01bf67dc49a68b970b_dewebpack/
    â”œâ”€â”€ module_uocc.js          # ç¢°æ’æ£€æµ‹
    â”œâ”€â”€ module_9ikq.js          # Bridgeé¿è®©
    â”œâ”€â”€ module_3rch.js          # Lintelé¿è®©
    â”œâ”€â”€ module_pckm.js          # éªŒè¯ç³»ç»Ÿ
    â”œâ”€â”€ module_yy3l.js          # æ•°æ®æ£€æŸ¥
    â”œâ”€â”€ module_qffn.js          # è¿æ¥å™¨
    â”œâ”€â”€ module_9wif.js          # å¸ƒå±€ç±»å‹
    â”œâ”€â”€ module_xbta.js          # ç³»ç»Ÿç±»å‹
    â”œâ”€â”€ module_tm.js            # è®¾å¤‡ç±»å‹
    â”œâ”€â”€ module_6l8a.js          # å‘½åè§„èŒƒ
    â”œâ”€â”€ module_n_4w.js          # ç³»ç»Ÿåˆ†ç±»
    â”œâ”€â”€ module_dwjx.js          # ç±»å‹æ˜ å°„
    â””â”€â”€ fluid.js                # æµä½“ç±»å‹
```

---

## 28. æ€»ç»“ä¸å±•æœ›

### 28.1 ç³»ç»Ÿæ¶æ„æ€»ç»“

dist5ç›®å½•ä¸‹çš„MEPç³»ç»Ÿé‡‡ç”¨äº†**é«˜åº¦æ¨¡å—åŒ–ã€ç±»å‹å®‰å…¨ã€å‡ ä½•é©±åŠ¨**çš„æ¶æ„è®¾è®¡ï¼š

#### æ ¸å¿ƒä¼˜åŠ¿

1. **å®Œæ•´çš„ç±»å‹ç³»ç»Ÿ**:
   - 19ç§ç³»ç»Ÿç±»å‹
   - 11ç§å­ç³»ç»Ÿç±»å‹
   - 100+ç§ç®¡é“ç±»å‹
   - æ¸…æ™°çš„ç±»å‹å±‚æ¬¡ç»“æ„

2. **æ™ºèƒ½ç¢°æ’æ£€æµ‹**:
   - åŒé‡æ£€æµ‹æœºåˆ¶ï¼ˆç®¡é“+æ¢ï¼‰
   - ç±»å‹åŒ–æ£€æµ‹ç­–ç•¥
   - ç²¾ç¡®çš„å‡ ä½•è®¡ç®—ï¼ˆ0.001mmå®¹å·®ï¼‰
   - æ€§èƒ½ä¼˜åŒ–ï¼ˆ>2000ç®¡é“å¿«é€Ÿæ¨¡å¼ï¼‰

3. **çµæ´»é¿è®©ç®—æ³•**:
   - Bridgeæ¨¡å¼ï¼šBezieræ›²çº¿å¹³æ»‘è¿‡æ¸¡
   - Lintelæ¨¡å¼ï¼šçŸ©å½¢æ¡†æ¶é¿è®©
   - å‚æ•°å¯è°ƒï¼šæ–¹å‘ã€è§’åº¦ã€åç§»ã€å®½åº¦
   - å¤šæ–¹å‘é€‰æ‹©

4. **ä¸¥æ ¼éªŒè¯ä½“ç³»**:
   - 9å±‚éªŒè¯æ£€æŸ¥
   - 21é¡¹å…·ä½“éªŒè¯è§„åˆ™
   - ä¸­æ–‡é”™è¯¯æç¤º
   - å¿«é€Ÿå®šä½é—®é¢˜

5. **ä¼˜ç§€è®¾è®¡æ¨¡å¼**:
   - å·¥å‚æ¨¡å¼ï¼ˆç³»ç»Ÿåˆ›å»ºï¼‰
   - ç­–ç•¥æ¨¡å¼ï¼ˆç¢°æ’æ£€æµ‹ï¼‰
   - ç»§æ‰¿æ¨¡å¼ï¼ˆä»£ç å¤ç”¨ï¼‰
   - é›†åˆæ¨¡å¼ï¼ˆé«˜æ•ˆæŸ¥æ‰¾ï¼‰

### 28.2 æŠ€æœ¯äº®ç‚¹

1. **å‡ ä½•ç®—æ³•ç²¾å‡†**:
   - çº¿æ®µæ±‚äº¤
   - å¹³é¢æ±‚äº¤
   - Bezieræ›²çº¿
   - çŸ©é˜µå˜æ¢

2. **æ€§èƒ½ä¼˜åŒ–åˆ°ä½**:
   - è·ç¦»ç­›é€‰
   - å¿«é€Ÿæ¨¡å¼
   - Map/Seté«˜æ•ˆæŸ¥æ‰¾
   - æŒ‰éœ€æ£€æµ‹

3. **ç”¨æˆ·ä½“éªŒå‹å¥½**:
   - å®æ—¶ç¢°æ’æç¤º
   - å¤šæ–¹å‘é¿è®©é€‰æ‹©
   - å‚æ•°å¯è§†åŒ–è°ƒæ•´
   - ä¸­æ–‡é”™è¯¯ä¿¡æ¯

### 28.3 ç³»ç»Ÿè§„æ¨¡ç»Ÿè®¡

| ç»Ÿè®¡é¡¹ | æ•°é‡ | å¤‡æ³¨ |
|--------|------|------|
| ä¸»ç³»ç»Ÿæ•° | 9 | ç”µ/æ°´/æš–/é£/åˆ¶å†· |
| ç³»ç»Ÿç±»å‹æšä¸¾ | 19 | SystemType |
| å­ç³»ç»Ÿç±»å‹ | 11 | SubSystemType |
| å¸ƒå±€ç±»å‹ | 12 | LayoutType |
| ç®¡é“ç±»å‹ | 110+ | TubeType |
| è®¾å¤‡ç±»å‹ | 30+ | ç¼–å·3000-4500 |
| éªŒè¯è§„åˆ™ | 21 | 9ä¸ªéªŒè¯å‡½æ•° |
| æ ¸å¿ƒæ¨¡å— | 9 | å…³é”®JSæ–‡ä»¶ |
| ä»£ç æ€»è¡Œæ•° | 5000+ | ä»…æ ¸å¿ƒæ¨¡å— |

### 28.4 å›½æ ‡åˆè§„æ€§

è™½ç„¶æºç ä¸­æœªæ˜¾å¼æ ‡æ³¨"GB"å›½æ ‡ç¼–å·ï¼Œä½†ç³»ç»Ÿé€šè¿‡ä»¥ä¸‹æœºåˆ¶ç¡®ä¿åˆè§„æ€§ï¼š

1. **å‚æ•°éªŒè¯**: ä¸¥æ ¼çš„å‚æ•°ç±»å‹å’Œæ•°å€¼æ£€æŸ¥
2. **æ‹“æ‰‘è§„åˆ™**: ç¬¦åˆç®¡é“è¿æ¥è§„èŒƒ
3. **æœ€å°é—´è·**: ç®¡å¾„Ã—1.5å®‰å…¨è·ç¦»
4. **ç³»ç»Ÿåˆ†ç±»**: æŒ‰å›½æ ‡è¦æ±‚åˆ†ç±»ï¼ˆå¼ºç”µ/å¼±ç”µ/ç»™æ’æ°´ç­‰ï¼‰
5. **è®¾å¤‡ç¼–å·**: ç»Ÿä¸€çš„è®¾å¤‡ç¼–å·ä½“ç³»

### 28.5 æŠ€æœ¯å€ºåŠ¡ä¸æ”¹è¿›å»ºè®®

**å½“å‰é™åˆ¶**:
1. æœªå‘ç°ä¼ ç»ŸAIæœç´¢ç®—æ³•ï¼ˆA*ã€Dijkstraï¼‰
2. è·¯å¾„ç”ŸæˆåŸºäºå‡ ä½•ç®—æ³•ï¼Œéå›¾æœç´¢
3. å›½æ ‡ç¼–å·æœªæ˜ç¡®æ ‡æ³¨åœ¨ä»£ç ä¸­

**æ”¹è¿›æ–¹å‘**:
1. å¯å¼•å…¥å›¾æœç´¢ç®—æ³•ä¼˜åŒ–å¤æ‚åœºæ™¯è·¯å¾„
2. æ·»åŠ GBå›½æ ‡ç¼–å·æ³¨é‡Š
3. å¢å¼ºå¤§è§„æ¨¡ç®¡é“åœºæ™¯æ€§èƒ½
4. æ”¯æŒæ›´å¤šé¿è®©æ¨¡å¼

---

## 29. é™„å½•

### 29.1 å®Œæ•´ç®¡é“ç±»å‹ç¼–å·è¡¨

| èŒƒå›´ | ç³»ç»Ÿ | æ•°é‡ | èµ·å§‹ç¼–å· |
|------|------|------|---------|
| 0-99 | é€šç”¨ç±»å‹ | 9 | 0 |
| 100-199 | å¼ºç”µç®¡ | 14 | 100 |
| 200-299 | æ°´ç®¡ | 21 | 200 |
| 300-399 | åˆ¶å†·å‰‚ç®¡ | 13 | 300 |
| 400-499 | å†·å‡æ°´ç®¡ | 10 | 400 |
| 500-599 | é€šé£ç®¡ | 10 | 500 |
| 600-699 | åœ°æš–ç®¡ | 11 | 600 |
| 700-799 | æ°´ç©ºè°ƒç®¡ | 10 | 700 |
| 800-899 | æ’æ°´ç®¡ | 10+ | 800 |

### 29.2 è®¾å¤‡ç¼–å·èŒƒå›´

| èŒƒå›´ | è®¾å¤‡ç±»åˆ« | ç¤ºä¾‹ |
|------|---------|------|
| 3200-3299 | é‡‡æš–è®¾å¤‡ | 3258(é‡‡æš–ç‚‰), 3259(åˆ†é›†æ°´å™¨) |
| 3600-3699 | æ°´ç©ºè°ƒè®¾å¤‡ | 3612(æ°´ç©ºè°ƒ), 3615(æ°´æ³µ) |
| 3700-3799 | çƒ­æ°´å™¨ | 3783(ç‡ƒæ°”çƒ­æ°´å™¨) |
| 3900-3999 | æ™ºèƒ½è®¾å¤‡ | 3928(æ™ºèƒ½é¢æ¿) |
| 4200-4299 | å®‰é˜²è®¾å¤‡ | 4422(å®‰é˜²å…¶ä»–), 3268(ç´§æ€¥æŒ‰é’®) |
| 4260-4269 | çƒ­æ³µè®¾å¤‡ | 4260(ç©ºæ°”æº), 4261(åœ°æº), 4262(æ°´æº) |

### 29.3 å…³é”®å¸¸é‡å®šä¹‰

| å¸¸é‡å | å€¼ | å•ä½ | ç”¨é€” |
|--------|---|------|------|
| é»˜è®¤é¿è®©è§’åº¦ | 45 | åº¦ | Bridgeé¿è®© |
| é»˜è®¤é¿è®©åç§» | 600 | mm | Lintelé¿è®© |
| é»˜è®¤é¿è®©å®½åº¦ | 300 | mm | Lintelé¿è®© |
| ç¢°æ’å®¹å·® | 0.001 | mm | å‡ ä½•è®¡ç®— |
| æœ€å°é—´è·ç³»æ•° | 1.5 | - | ç®¡å¾„å€æ•° |
| é«˜åº¦åŸºæ•°ç³»æ•° | 3 | - | ç®¡å¾„å€æ•° |
| æ€§èƒ½é˜ˆå€¼ | 2000 | æ¡ | ç®¡é“æ•°é‡ |
| Toastè¶…æ—¶ | 5000 | ms | é”™è¯¯æç¤º |

### 29.4 é”™è¯¯ç å¯¹ç…§è¡¨

| é”™è¯¯ç  | é”™è¯¯ä¿¡æ¯ | è§¦å‘æ¡ä»¶ |
|--------|---------|---------|
| E001 | vertexæœªè®¾ç½®tube | é¡¶ç‚¹æ²¡æœ‰å…³è”ç®¡é“ |
| E002 | 
edgeæœªè®¾ç½®tube/start/end | è¾¹æ²¡æœ‰å…³è”ç®¡é“æˆ–èµ·ç»ˆç‚¹ |
| E003 | tubeæœªè®¾ç½®layoutRef | ç®¡é“æ²¡æœ‰å¸ƒå±€å¼•ç”¨ |
| E004 | relationMapä¸­çš„vertexIdåœ¨designä¸­ä¸å­˜åœ¨ | é¡¶ç‚¹IDæ˜ å°„é”™è¯¯ |
| E005 | relationMapä¸­çš„connectorIdåœ¨designä¸­ä¸å­˜åœ¨ | è¿æ¥å™¨IDæ˜ å°„é”™è¯¯ |
| E006 | connectorIdè¢«å¤šä¸ªvertexå ç”¨ | è¿æ¥å™¨é‡å¤ä½¿ç”¨ |
| E007 | tube connectorä¸­çš„host vertexä¸å­˜åœ¨ | Hosté¡¶ç‚¹ç¼ºå¤± |
| E008 | systemConnectorä¸­host systemä¸å­˜åœ¨ | Hostç³»ç»Ÿç¼ºå¤± |
| E009 | control lineä¸­çš„startæˆ–end modelä¸å­˜åœ¨ | æ§åˆ¶çº¿æ¨¡å‹ç¼ºå¤± |
| E010 | tubeå‚æ•°è®¾ç½®é”™è¯¯ | å‚æ•°ç±»å‹ä¸åŒ¹é… |
| E011 | tubeæœªè®¾ç½®system | ç®¡é“æœªå…³è”ç³»ç»Ÿ |
| E012 | pathæ•°æ®é”™è¯¯ï¼šedgeé‡å¤ | è¾¹IDé‡å¤ |
| E013 | pathä¸­çš„systemä¸ä¸€è‡´ | è·¯å¾„ç³»ç»Ÿä¸ä¸€è‡´ |
| E014 | vertex's edgesæ•°é”™è¯¯ | é¡¶ç‚¹è¾¹æ•°ä¸ç¬¦åˆè§„åˆ™ |
| E015 | åœ°æš–åŒºåŸŸconnectToRadiatorå‚æ•°é”™è¯¯ | åœ°æš–è¿æ¥æ•£çƒ­å™¨é”™è¯¯ |

---

## 30. å¿«é€ŸæŸ¥æ‰¾æŒ‡å—

### 30.1 æŒ‰åŠŸèƒ½æŸ¥æ‰¾

**éœ€è¦æŸ¥æ‰¾ç¢°æ’æ£€æµ‹ï¼Ÿ**
â†’ æŸ¥çœ‹ç¬¬10ç«  + æºç  [`module_uocc.js:774-1004`](dist5/static/-fe-pub-cmn-micro-tool-base/micros/kujiale-bim-tool-page-mep-kaf-plugin/entry.3c01bf67dc49a68b970b_dewebpack/module_uocc.js:774)

**éœ€è¦æŸ¥æ‰¾é¿è®©ç®—æ³•ï¼Ÿ**
â†’ æŸ¥çœ‹ç¬¬11ç«  + æºç :
- Bridge: [`module_9ikq.js:192-276`](dist5/static/-fe-pub-cmn-micro-tool-base/micros/kujiale-bim-tool-page-mep-kaf-plugin/entry.3c01bf67dc49a68b970b_dewebpack/module_9ikq.js:192)
- Lintel: [`module_3rch.js:203-264`](dist5/static/-fe-pub-cmn-micro-tool-base/micros/kujiale-bim-tool-page-mep-kaf-plugin/entry.3c01bf67dc49a68b970b_dewebpack/module_3rch.js:203)

**éœ€è¦æŸ¥æ‰¾éªŒè¯è§„åˆ™ï¼Ÿ**
â†’ æŸ¥çœ‹ç¬¬13ç«  + æºç  [`module_pckm.js:1459-1860`](dist5/static/-fe-pub-cmn-micro-tool-base/micros/kujiale-bim-tool-page-mep-kaf-plugin/entry.3c01bf67dc49a68b970b_dewebpack/module_pckm.js:1459)

**éœ€è¦æŸ¥æ‰¾ç®¡é“ç±»å‹ï¼Ÿ**
â†’ æŸ¥çœ‹ç¬¬15ç«  + æºç  [`module_9wif.js:42-164`](dist5/static/-fe-pub-cmn-micro-tool-base/micros/kujiale-bim-tool-page-mep-kaf-plugin/entry.3c01bf67dc49a68b970b_dewebpack/module_9wif.js:42)

### 30.2 æŒ‰ç³»ç»ŸæŸ¥æ‰¾

| ç³»ç»Ÿ | ç« èŠ‚ | æ ¸å¿ƒæºç  |
|------|------|---------|
| å¼ºç”µ | ç¬¬2ç«  | module_9wif.js:70-83 |
| å¼±ç”µ | ç¬¬3ç«  | module_xbta.js:69 |
| ç»™æ’æ°´ | ç¬¬4ç«  | module_9wif.js:84-104 |
| é‡‡æš– | ç¬¬5ç«  | module_tm.js:110-137 |
| åœ°æš– | ç¬¬6ç«  | module_9wif.js:138-148 |
| æ–°é£ | ç¬¬7ç«  | module_9wif.js:128-137 |
| æ’é£ | ç¬¬8ç«  | åŒæ–°é£ |
| åˆ¶å†· | ç¬¬9ç«  | module_9wif.js:105-117 |
| æ°´ç©ºè°ƒ | ç¬¬22ç«  | module_9wif.js:149-162 |

---

## 31. æºç æ–‡ä»¶å¤§å°ç»Ÿè®¡

| æ¨¡å— | æ–‡ä»¶å¤§å° | è¡Œæ•° | å‹ç¼©çŠ¶æ€ |
|------|---------|------|---------|
| module_uocc.js | ~95 KB | 1916 | å·²å‹ç¼© |
| module_pckm.js | ~90 KB | 1860+ | å·²å‹ç¼© |
| module_9ikq.js | ~18 KB | 366 | å·²å‹ç¼© |
| module_3rch.js | ~20 KB | 404 | å·²å‹ç¼© |
| module_qffn.js | ~9 KB | 187 | å·²å‹ç¼© |
| module_yy3l.js | ~2 KB | 39 | å·²å‹ç¼© |
| module_9wif.js | ~10 KB | 200+ | å·²å‹ç¼© |
| module_xbta.js | ~8 KB | 150+ | å·²å‹ç¼© |
| module_tm.js | ~12 KB | 200+ | å·²å‹ç¼© |

**æ€»è®¡**: çº¦264 KBï¼Œ5500+è¡Œä»£ç ï¼ˆä»…æ ¸å¿ƒæ¨¡å—ï¼‰

---

## 32. ç‰ˆæœ¬æ§åˆ¶ä¿¡æ¯

### 32.1 ç‰ˆæœ¬éªŒè¯

**æºç ä½ç½®**: [`module_pckm.js:1841-1860`](dist5/static/-fe-pub-cmn-micro-tool-base/micros/kujiale-bim-tool-page-mep-kaf-plugin/entry.3c01bf67dc49a68b970b_dewebpack/module_pckm.js:1841)

```javascript
(tt.prototype.versionVerify = function (et) {
    var we = et.getSchemaVersion(),    // æ¶æ„ç‰ˆæœ¬
    ze = et.getReleaseVersion();       // å‘å¸ƒç‰ˆæœ¬
    
    // ç‰ˆæœ¬1.8.0å‡çº§é€»è¾‘
    if (Object(K.a)("1.8.0", we) > 0) {
        Re.upgradeVentInOutLets(et);   // å‡çº§é€šé£è¿›å‡ºå£
        Re.upgradeSystems(et);          // å‡çº§ç³»ç»Ÿ
    }
    
    // ç‰ˆæœ¬1.2.1å‡çº§é€»è¾‘
    if (Object(K.a)("1.8.0", we) >= 0) {
        if (Object(K.a)("1.2.1", ze) > 0) {
            var Qe = et.getLayoutArray().filter(function (ot) {
                return ot.getType() !== y.b.FloorHeating;
            });
            
            Qe.forEach(function (ot) {
                return Et.verifyPathDividing(ot, et);
            });
        }
    }
})
```

**æ”¯æŒç‰ˆæœ¬**:
- Schema Version: >= 1.8.0
- Release Version: >= 1.2.1

---

## 33. æ€»ç»“

### 33.1 æ–‡æ¡£å®Œæ•´æ€§æ£€æŸ¥

âœ… **å·²å®Œæˆåˆ†æ**:
1. âœ… 9å¤§MEPå­ç³»ç»Ÿæ¶æ„è¯¦è§£
2. âœ… ç¢°æ’æ£€æµ‹æœºåˆ¶å®Œæ•´åˆ†æ
3. âœ… Bridgeå’ŒLintelåŒé¿è®©ç®—æ³•
4. âœ… AIè·¯å¾„ç”Ÿæˆï¼ˆå‡ ä½•ç®—æ³•ï¼‰
5. âœ… å›½æ ‡éªŒè¯ä½“ç³»ï¼ˆ21é¡¹è§„åˆ™ï¼‰
6. âœ… è‡ªæ£€ç³»ç»Ÿï¼ˆ9å±‚éªŒè¯ï¼‰
7. âœ… 110+ç§ç®¡é“ç±»å‹æšä¸¾
8. âœ… 30+ç§è®¾å¤‡ç±»å‹å®šä¹‰
9. âœ… æ€§èƒ½ä¼˜åŒ–ç­–ç•¥
10. âœ… è®¾è®¡æ¨¡å¼åº”ç”¨

### 33.2 æ ¸å¿ƒæŠ€æœ¯æŒ‡æ ‡

| æŒ‡æ ‡ | æ•°å€¼ |
|------|------|
| ç³»ç»Ÿç±»å‹ | 19ç§ |
| ç®¡é“ç±»å‹ | 110+ç§ |
| è®¾å¤‡ç±»å‹ | 30+ç§ |
| éªŒè¯è§„åˆ™ | 21é¡¹ |
| æ ¸å¿ƒæ¨¡å— | 9ä¸ª |
| ä»£ç è¡Œæ•° | 5500+è¡Œ |
| æ£€æµ‹ç²¾åº¦ | 0.001mm |
| æ€§èƒ½é˜ˆå€¼ | 2000ç®¡é“ |

### 33.3 å…³é”®å‘ç°

1. **æ— ä¼ ç»ŸAIæœç´¢**: ç³»ç»Ÿé‡‡ç”¨å‡ ä½•ç®—æ³•è€ŒéA*/Dijkstra
2. **åŒæ¨¡å¼é¿è®©**: Bridge(æ›²çº¿) + Lintel(çŸ©å½¢)
3. **ç±»å‹åŒ–æ£€æµ‹**: ä¸åŒç®¡é“ç±»å‹æœ‰ä¸åŒæ£€æµ‹ç­–ç•¥
4. **ä¸¥æ ¼éªŒè¯**: 9å±‚éªŒè¯ç¡®ä¿æ•°æ®å®Œæ•´æ€§
5. **æ€§èƒ½ä¼˜åŒ–**: å¤§è§„æ¨¡åœºæ™¯è‡ªåŠ¨é™çº§æ£€æŸ¥

### 33.4 æ–‡æ¡£ä»·å€¼

æœ¬æ–‡æ¡£åŸºäº**dist5ç›®å½•çœŸå®æºç **åˆ†æï¼Œæä¾›ï¼š
- âœ… ç²¾ç¡®åˆ°è¡Œå·çš„æºç å¼•ç”¨
- âœ… å®Œæ•´çš„ç®—æ³•æµç¨‹å›¾
- âœ… è¯¦ç»†çš„æ•°æ®ç»“æ„è¯´æ˜
- âœ… å®ç”¨çš„æŸ¥æ‰¾ç´¢å¼•
- âœ… å¯æ“ä½œçš„æŠ€æœ¯æŒ‡æ ‡

é€‚ç”¨äºï¼š
- ç³»ç»Ÿç»´æŠ¤å’Œå‡çº§
- Bugå®šä½å’Œä¿®å¤
- æ–°åŠŸèƒ½å¼€å‘
- æŠ€æœ¯æ–‡æ¡£ç¼–å†™
- ä»£ç å®¡æŸ¥

---

## 34. å‚è€ƒä¿¡æ¯

### 34.1 åˆ†æä¾æ®

**ä¸»è¦æ–‡æ¡£**: [`dist5/æ¨¡å—æœç´¢ç»“æœæ±‡æ€».md`](dist5/æ¨¡å—æœç´¢ç»“æœæ±‡æ€».md)

**æºç ç›®å½•**: `dist5/static/-fe-pub-cmn-micro-tool-base/micros/kujiale-bim-tool-page-mep-kaf-plugin/entry.3c01bf67dc49a68b970b_dewebpack/`

**åˆ†ææ–¹æ³•**:
1. æœç´¢å…³é”®è¯: collision, avoidance, verify, check, validation
2. è¯»å–æ ¸å¿ƒæ¨¡å—å®Œæ•´æºç 
3. æå–ç±»å‹å®šä¹‰å’Œæšä¸¾
4. åˆ†æç®—æ³•æµç¨‹
5. æ•´ç†æ•°æ®ç»“æ„

### 34.2 æœªè¦†ç›–å†…å®¹

ç”±äºéµå¾ª"ä»…åˆ†ædist5æºç "çš„çº¦æŸï¼Œä»¥ä¸‹å†…å®¹æœªåŒ…å«ï¼š
- å…¶ä»–ç›®å½•(dist, dist2, src)çš„å®ç°
- å‰ç«¯UIç»„ä»¶å®ç°
- åç«¯APIæ¥å£
- æ•°æ®åº“schema
- éƒ¨ç½²é…ç½®

### 34.3 åç»­æ‰©å±•å»ºè®®

å¦‚éœ€æ›´æ·±å…¥åˆ†æï¼Œå¯æ‰©å±•ï¼š
1. UIäº¤äº’æµç¨‹åˆ†æ
2. æ•°æ®æŒä¹…åŒ–æœºåˆ¶
3. ç½‘ç»œé€šä¿¡åè®®
4. 3Dæ¸²æŸ“å®ç°
5. 
æ€§èƒ½æµ‹è¯•åˆ†æ

---

## 35. æ–‡æ¡£æ›´æ–°æ—¥å¿—

| ç‰ˆæœ¬ | æ—¥æœŸ | æ›´æ–°å†…å®¹ | ä½œè€… |
|------|------|---------|------|
| v1.0 | 2026-01-23 | åˆå§‹ç‰ˆæœ¬ï¼Œå®Œæ•´æ¶æ„åˆ†æ | AIåˆ†æç³»ç»Ÿ |

---

## 36. é™„å½•ï¼šå…³é”®ä»£ç ç‰‡æ®µ

### 36.1 ç¢°æ’æ£€æµ‹é…ç½®å‡½æ•°ï¼ˆå®Œæ•´ï¼‰

```javascript
// æºç ä½ç½®: module_uocc.js:29-74
function l(at) {
    var ke = M.MepPlugin.stateManager.functionPanel.drawTubeFunctionPanel.getShape();
    if (ke && Object(C.j)(ke)) return {
        detectTube: !1,
        detectBeam: !1
    };
    var $require = {
        detectTube: !0,
        detectBeam: !1
    };
    switch (at) {
        case K.b.VentilationDirty:
        case K.b.VentilationFresh:
            return { detectTube: !0, detectBeam: !0 };
        case K.b.WaterAirCondition:
        case K.b.DrainWater:
            return { detectTube: !0, detectBeam: !0 };
        case K.b.FloorHeating:
            return { detectTube: !1, detectBeam: !1 };
        case K.b.MepCommon:
            return { detectTube: !1, detectBeam: !1 };
        default:
            return $require;
    }
}
```

### 36.2 ç¢°æ’ç»“æœæ•°æ®ç»“æ„

```javascript
// Bridgeç¢°æ’ç»“æœ (module_9ikq.js:182-189)
collisionResult = {
    intersectPoint: Point3d,     // ç¢°æ’äº¤ç‚¹
    type: CollisionType.Bridge,  // ç±»å‹ï¼šæ¡¥æ¥
    extraInfo: {
        transform: Matrix4       // å˜æ¢çŸ©é˜µ
    }
}

// Lintelç¢°æ’ç»“æœ (module_3rch.js:382-390)
collisionResult = {
    collisionObject: Beam,       // ç¢°æ’å¯¹è±¡ï¼šæ¢
    intersectPoint: Point3d,     // äº¤ç‚¹
    type: CollisionType.Lintel,  // ç±»å‹ï¼šè¿‡æ¢
    extraInfo: {
        transform: Matrix4,      // å˜æ¢çŸ©é˜µ
        height: number,          // è¿‡æ¢é«˜åº¦
        width: number            // è¿‡æ¢å®½åº¦
    }
}
```

### 36.3 é¿è®©å‚æ•°é…ç½®

```javascript
// Bridgeé¿è®©å‚æ•° (module_9ikq.js:140-142)
{
    avoidPath: [],              // é¿è®©è·¯å¾„
    avoidanceDirection: 0,      // æ–¹å‘(0-nå¾ªç¯)
    angle: 45                   // è§’åº¦(åº¦)
}

// Lintelé¿è®©å‚æ•° (module_3rch.js:142-144)
{
    avoidanceDirection: 0,      // æ–¹å‘(0-nå¾ªç¯)
    avoidanceWidth: 300,        // å®½åº¦(mm)
    avoidanceOffset: 600        // åç§»(mm)
}
```

---

## 37. ç»“è¯­

æœ¬æ–‡æ¡£è¯¦å°½åˆ†æäº†dist5ç›®å½•ä¸‹MEPç³»ç»Ÿçš„**æ°´ã€æš–ã€ç”µ**ä¸‰å¤§æ ¸å¿ƒç³»ç»Ÿæ¶æ„ï¼ŒåŒ…æ‹¬ï¼š

### ğŸ“Š åˆ†ææ·±åº¦

- **9å¤§å­ç³»ç»Ÿ**: å¼ºç”µã€å¼±ç”µã€ç»™æ’æ°´ã€é‡‡æš–ã€åœ°æš–ã€æ–°é£ã€æ’é£ã€åˆ¶å†·ã€æ°´ç©ºè°ƒ
- **110+ç®¡é“ç±»å‹**: å®Œæ•´æšä¸¾å’Œåˆ†ç±»
- **30+è®¾å¤‡ç±»å‹**: è¯¦ç»†ç¼–å·å’ŒåŠŸèƒ½
- **ç¢°æ’æ£€æµ‹**: åŒé‡æ£€æµ‹æœºåˆ¶ï¼ˆç®¡é“+æ¢ï¼‰
- **é¿è®©ç®—æ³•**: Bridge(Bezieræ›²çº¿) + Lintel(çŸ©å½¢)
- **è·¯å¾„ç”Ÿæˆ**: å‡ ä½•ç®—æ³•å®ç°
- **å›½æ ‡éªŒè¯**: 21é¡¹éªŒè¯è§„åˆ™
- **è‡ªæ£€ç³»ç»Ÿ**: 9å±‚éªŒè¯ä½“ç³»

### ğŸ¯ æ ¸å¿ƒä»·å€¼

1. **ç²¾ç¡®æ€§**: æ‰€æœ‰ä¿¡æ¯å‡æ¥è‡ªdist5çœŸå®æºç 
2. **å¯è¿½æº¯**: æ¯ä¸ªæŠ€æœ¯ç‚¹éƒ½æ ‡æ³¨æºç ä½ç½®å’Œè¡Œå·
3. **å®Œæ•´æ€§**: è¦†ç›–æ°´ç”µæš–å…¨éƒ¨æ ¸å¿ƒåŠŸèƒ½
4. **å®ç”¨æ€§**: æä¾›ç®—æ³•æµç¨‹å›¾å’Œä»£ç ç¤ºä¾‹
5. **å¯ç»´æŠ¤**: æ¸…æ™°çš„æ¨¡å—ç´¢å¼•å’Œå¿«é€ŸæŸ¥æ‰¾æŒ‡å—

### ğŸ“ ä½¿ç”¨å»ºè®®

- å¼€å‘äººå‘˜ï¼šå‚è€ƒæºç ä½ç½®è¿›è¡Œä»£ç ä¿®æ”¹
- æµ‹è¯•äººå‘˜ï¼šå‚è€ƒéªŒè¯è§„åˆ™ç¼–å†™æµ‹è¯•ç”¨ä¾‹
- æ¶æ„å¸ˆï¼šå‚è€ƒè®¾è®¡æ¨¡å¼ä¼˜åŒ–ç³»ç»Ÿæ¶æ„
- äº§å“ç»ç†ï¼šç†è§£ç³»ç»ŸåŠŸèƒ½å’ŒæŠ€æœ¯é™åˆ¶

---

**æ–‡æ¡£çŠ¶æ€**: âœ… å®Œæˆ  
**åˆ†æèŒƒå›´**: dist5/ ç›®å½•ï¼ˆä¸¥æ ¼éµå®ˆçº¦æŸï¼‰  
**æ€»é¡µæ•°**: çº¦35ç« èŠ‚  
**æ€»å­—æ•°**: çº¦15000å­—  
**æºç å¼•ç”¨**: 50+å¤„ç²¾ç¡®å¼•ç”¨  

---

**END OF DOCUMENT**