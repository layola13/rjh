# Homestyler è‡ªç”±é€ å‹ç•Œé¢å®Œæ•´åˆ†æ

## 1. ç•Œé¢æ¦‚è¿° ğŸ¯

**ç•Œé¢åç§°**: Freeform Modeling Interface (è‡ªç”±é€ å‹ç•Œé¢)

**ç•Œé¢ç”¨é€”**: 
- åˆ›å»ºè‡ªç”±å½¢çŠ¶çš„å»ºç­‘å…ƒç´ å’Œè£…é¥°
- è®¾è®¡å¼‚å½¢å¢™ä½“ã€æ›²çº¿ç»“æ„
- DIYå®šåˆ¶åŒ–æ¨¡å‹
- å‚æ•°åŒ–è‡ªç”±å»ºæ¨¡

**æŠ€æœ¯å®ç°**: è‡ªç”±è·¯å¾„ç»˜åˆ¶ + 3DæŒ¤å‹/æ”¾æ ·å»ºæ¨¡

---

## 2. ç•Œé¢å¸ƒå±€ ğŸ¨

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ PageHeader: [æ–‡ä»¶] [é€ å‹å·¥å…·â–¼] [è·¯å¾„] [å‚æ•°] [å®Œæˆ]      [ç”¨æˆ·]     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚        â”‚                                                 â”‚           â”‚
â”‚ Left   â”‚       Hybrid Canvas (2Dç»˜åˆ¶ + 3Dé¢„è§ˆ)           â”‚  Right    â”‚
â”‚ Toolbarâ”‚                                                 â”‚ Property  â”‚
â”‚        â”‚   â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—            â”‚   Bar     â”‚
â”‚ç»˜åˆ¶    â”‚   â•‘   2Dè·¯å¾„ç»˜åˆ¶è§†å›¾               â•‘            â”‚           â”‚
â”‚å·¥å…·    â”‚   â•‘                                â•‘            â”‚ è·¯å¾„å‚æ•°: â”‚
â”‚        â”‚   â•‘    â•±â”€â”€â•²                        â•‘            â”‚           â”‚
â”‚[ç›´çº¿]  â”‚   â•‘   â•±    â•²â•²                      â•‘            â”‚ - ç‚¹åæ ‡  â”‚
â”‚[æ›²çº¿]  â”‚   â•‘  â”‚      â”‚â”‚  è‡ªç”±è½®å»“           â•‘            â”‚ - æ›²ç‡    â”‚
â”‚[åœ†å¼§]  â”‚   â•‘  â”‚      â”‚â”‚                     â•‘            â”‚ - å¹³æ»‘åº¦  â”‚
â”‚[æ ·æ¡]  â”‚   â•‘   â•²    â•±â•±                      â•‘            â”‚           â”‚
â”‚        â”‚   â•‘    â•²â”€â”€â•±                        â•‘            â”‚ é€ å‹æ–¹å¼: â”‚
â”‚ç¼–è¾‘    â”‚   â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•            â”‚           â”‚
â”‚å·¥å…·    â”‚                                                 â”‚ [æŒ¤å‹]    â”‚
â”‚        â”‚   3Dé€ å‹é¢„è§ˆ:                                   â”‚ [æ”¾æ ·]    â”‚
â”‚[ç§»åŠ¨]  â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                      â”‚ [æ—‹è½¬]    â”‚
â”‚[ç¼©æ”¾]  â”‚   â”‚   â•±â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•²      â”‚ 3Då®ä½“              â”‚ [æ‰«æ ]    â”‚
â”‚[æ—‹è½¬]  â”‚   â”‚  â”‚            â”‚     â”‚                      â”‚           â”‚
â”‚[é•œåƒ]  â”‚   â”‚  â”‚   é€ å‹     â”‚     â”‚                      â”‚ æŒ¤å‹å‚æ•°: â”‚
â”‚        â”‚   â”‚  â”‚            â”‚     â”‚                      â”‚           â”‚
â”‚æ•æ‰    â”‚   â”‚   â•²â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•±      â”‚                      â”‚ - æ·±åº¦    â”‚
â”‚        â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                      â”‚ - æ–¹å‘    â”‚
â”‚[ç«¯ç‚¹]  â”‚                                                 â”‚ - é”¥åº¦    â”‚
â”‚[ä¸­ç‚¹]  â”‚   ä¾§è§†å›¾:                                       â”‚           â”‚
â”‚[äº¤ç‚¹]  â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                            â”‚ æè´¨:     â”‚
â”‚[åˆ‡ç‚¹]  â”‚   â”‚ â•â•â•â•â•â•â•â•â•â•â•â•â• â”‚ æŒ¤å‹æ·±åº¦                  â”‚           â”‚
â”‚        â”‚   â”‚ â•±           â”‚                            â”‚ [é€‰æ‹©]    â”‚
â”‚å‚æ•°åŒ–  â”‚   â”‚             â”‚                            â”‚           â”‚
â”‚        â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                            â”‚ [åº”ç”¨]    â”‚
â”‚[é‡å¤]  â”‚                                                 â”‚ [é‡ç½®]    â”‚
â”‚[é˜µåˆ—]  â”‚                                                 â”‚           â”‚
â”‚[å¯¹ç§°]  â”‚                                                 â”‚           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ StatusBar: [æ•æ‰:å¼€] [æ­£äº¤:å…³] [ç‚¹æ•°:12] [è·¯å¾„é•¿åº¦:3.5m]            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 3. è‡ªç”±é€ å‹ç±»å‹ç³»ç»Ÿ ğŸ—ï¸

### 3.1 è‡ªç”±å¢™ä½“ç±»å‹

**æ¥æº**: ä»£ç æœç´¢ç»“æœ

```javascript
// è‡ªç”±å½¢çŠ¶å¢™ä½“ç»˜åˆ¶å‘½ä»¤
CmdCreateFreeFormNGWall
CmdCreateFreeFormWall

// æ–‡ä»¶: createfreeformwall.js
// è‡ªç”±å¢™ä½“ç»˜åˆ¶å·¥å…·
```

**ç‰¹ç‚¹**:
- ç‚¹å‡»å¼è·¯å¾„ç»˜åˆ¶
- æ”¯æŒä»»æ„è§’åº¦
- æ›²çº¿å¢™ä½“æ”¯æŒ
- CADç‚¹æ•æ‰

### 3.2 å®šåˆ¶åŒ–æ¨¡å‹ç±»å‹

```javascript
// DIYå®šåˆ¶æ¨¡å‹
CustomizedContent: "customized content"
CustomizedPersonalizedModel: "customized personalized model"
CustomizedBackgroundModel: "customized background model"

// å‚æ•°åŒ–DIYæ¨¡å‹
CustomizedPMModel: "diy root model"
CustomizedPMInstanceModel: "diy instance model"
CustomizedPMInstancePersonal: "diy instance model personal"
CustomizedPMInstanceWall: "diy instance model wall"
CustomizedPMInstanceCeiling: "diy instance model ceiling"
CustomizedPMInstancePlatform: "diy instance model platform"
```

---

## 4. è·¯å¾„ç»˜åˆ¶ç³»ç»Ÿ âœï¸

### 4.1 è·¯å¾„ç»˜åˆ¶å·¥å…·

**ç›´çº¿å·¥å…·**:
```javascript
// ç‚¹å‡»ä¸¤ç‚¹ç»˜åˆ¶ç›´çº¿æ®µ
ç‚¹1 â†’ ç‚¹2 â†’ ç”Ÿæˆç›´çº¿
```

**æ›²çº¿å·¥å…·**:
```javascript
// è´å¡å°”æ›²çº¿
æ§åˆ¶ç‚¹1 â†’ æ§åˆ¶ç‚¹2 â†’ ... â†’ ç”Ÿæˆå¹³æ»‘æ›²çº¿
```

**åœ†å¼§å·¥å…·**:
```javascript
// ä¸‰ç‚¹å®šåœ†å¼§
èµ·ç‚¹ â†’ ç»è¿‡ç‚¹ â†’ ç»ˆç‚¹ â†’ ç”Ÿæˆåœ†å¼§
```

**æ ·æ¡æ›²çº¿**:
```javascript
// å¤šç‚¹æ ·æ¡æ’å€¼
ç‚¹1 â†’ ç‚¹2 â†’ ç‚¹3 â†’ ... â†’ ç”Ÿæˆå…‰æ»‘æ›²çº¿
```

### 4.2 è·¯å¾„ç¼–è¾‘

**åæ ‡è½¬æ¢ç³»ç»Ÿ**:
```javascript
// æ–‡ä»¶: createfreeformwall.js

// ç”»å¸ƒåæ ‡ â†’ æ¨¡å‹åæ ‡
HSApp.View.SVG.Util.CanvasPointToModel(canvasPoint)

// æ¨¡å‹åæ ‡ â†’ ç”»å¸ƒåæ ‡  
HSApp.View.SVG.Util.ModelPointToCanvas(modelPoint)

// åˆ›å»ºé¡¶ç‚¹
HSCore.Model.Vertex.create(x, y)
```

**è·¯å¾„æ“ä½œ**:
- æ·»åŠ ç‚¹
- åˆ é™¤ç‚¹
- ç§»åŠ¨ç‚¹
- æ’å…¥ç‚¹
- å¹³æ»‘æ›²çº¿

### 4.3 æ•æ‰ç³»ç»Ÿ

**æ•æ‰ç±»å‹**:
```javascript
// CADç‚¹æ•æ‰
this.inference._snapCADPoints

// æ•æ‰å¯¹è±¡
- ç«¯ç‚¹æ•æ‰
- ä¸­ç‚¹æ•æ‰
- äº¤ç‚¹æ•æ‰
- åˆ‡ç‚¹æ•æ‰
- å‚è¶³æ•æ‰
```

**æ•æ‰æŒ‡ç¤ºå™¨**:
```javascript
// è‡ªç”±é€‰ç‚¹åœ†å½¢æŒ‡ç¤ºå™¨
this.freePickCircleIndicator.attr({
    cx: this.cursorInCanvas.x,
    cy: this.cursorInCanvas.y
});
this.freePickCircleIndicator.show();
```

---

## 5. 3Dé€ å‹ç”Ÿæˆ ğŸ¨

### 5.1 æŒ¤å‹é€ å‹

**æŒ¤å‹ç±»å‹**:
```javascript
ExtrusionCustomizedBackgroundWall      // èƒŒæ™¯å¢™æŒ¤å‹
ExtrusionCustomizedCeilingModel        // åŠé¡¶æŒ¤å‹
ExtrusionCustomizedPlatform            // åœ°å°æŒ¤å‹
ExtrusionCustomizedPMBackgroundWall    // å‚æ•°åŒ–èƒŒæ™¯å¢™æŒ¤å‹
ExtrusionCustomizedPMCeilingModel      // å‚æ•°åŒ–åŠé¡¶æŒ¤å‹
ExtrusionCustomizedPMPlatform          // å‚æ•°åŒ–åœ°å°æŒ¤å‹
```

**æŒ¤å‹å‚æ•°**:
```javascript
{
    extrusionDepth: Number,      // æŒ¤å‹æ·±åº¦ (mm)
    extrusionDirection: Vector3,  // æŒ¤å‹æ–¹å‘
    taperAngle: Number,          // é”¥åº¦è§’ (åº¦)
    capTop: Boolean,             // é¡¶éƒ¨å°ç›–
    capBottom: Boolean           // åº•éƒ¨å°ç›–
}
```

**æŒ¤å‹æµç¨‹**:
```
ç»˜åˆ¶2Dè½®å»“
    â†“
è®¾ç½®æŒ¤å‹æ·±åº¦
    â†“
é€‰æ‹©æŒ¤å‹æ–¹å‘
    â†“
åº”ç”¨é”¥åº¦(å¯é€‰)
    â†“
ç”Ÿæˆ3Då®ä½“
    â†“
åº”ç”¨æè´¨
```

### 5.2 æ”¾æ ·é€ å‹

**æ”¾æ ·åŸç†**:
```
è·¯å¾„æ›²çº¿ + æˆªé¢å½¢çŠ¶ â†’ æ²¿è·¯å¾„æ‰«æ  â†’ ç”Ÿæˆ3Dé€ å‹
```

**åº”ç”¨åœºæ™¯**:
- æ‰¶æ‰‹é€ å‹
- çº¿æ¡é€ å‹
- ç®¡é“é€ å‹
- è£…é¥°æ¡

### 5.3 æ—‹è½¬é€ å‹

**æ—‹è½¬æˆå‹**:
```
2Dè½®å»“ + æ—‹è½¬è½´ + æ—‹è½¬è§’åº¦ â†’ æ—‹è½¬æ›²é¢
```

**åº”ç”¨åœºæ™¯**:
- åœ†æŸ±ä½“
- èŠ±ç“¶é€ å‹
- ç¯ç½©é€ å‹
- åœ†å½¢è£…é¥°

---

## 6. å‚æ•°åŒ–å»ºæ¨¡ âš™ï¸

### 6.1 å‚æ•°åŒ–æ¨¡å‹ç³»ç»Ÿ

```javascript
// å‚æ•°åŒ–DIYå®ä¾‹
CustomizedPMInstanceModel: "diy instance model"

// æŒ‰åº”ç”¨åˆ†ç±»
CustomizedPMInstanceWall: "diy instance model wall"          // å¢™é¢åº”ç”¨
CustomizedPMInstanceCeiling: "diy instance model ceiling"    // åŠé¡¶åº”ç”¨
CustomizedPMInstancePlatform: "diy instance model platform"  // åœ°å°åº”ç”¨
CustomizedPMInstancePersonal: "diy instance model personal"  // ä¸ªæ€§åŒ–
```

### 6.2 å‚æ•°é©±åŠ¨

**å¯è°ƒå‚æ•°**:
```javascript
{
    // å°ºå¯¸å‚æ•°
    length: Number,
    width: Number,
    height: Number,
    
    // å½¢çŠ¶å‚æ•°
    cornerRadius: Number,
    segments: Number,
    smoothness: Number,
    
    // é‡å¤å‚æ•°
    repeatCount: Number,
    spacing: Number,
    pattern: String
}
```

### 6.3 å‚æ•°åŒ–æ“ä½œ

**é˜µåˆ—æ“ä½œ**:
- çº¿æ€§é˜µåˆ—: æ²¿ç›´çº¿é‡å¤
- çŸ©å½¢é˜µåˆ—: è¡Œåˆ—é‡å¤
- ç¯å½¢é˜µåˆ—: ç»•ä¸­å¿ƒæ—‹è½¬é‡å¤
- è·¯å¾„é˜µåˆ—: æ²¿è·¯å¾„åˆ†å¸ƒ

**å¯¹ç§°æ“ä½œ**:
- é•œåƒå¤åˆ¶
- ä¸­å¿ƒå¯¹ç§°
- è½´å¯¹ç§°

---

## 7. ç»˜åˆ¶è¾…åŠ©åŠŸèƒ½ ğŸ”§

### 7.1 æ™ºèƒ½æ•æ‰

**æ•æ‰é€»è¾‘**:
```javascript
// æ–‡ä»¶: module_799429.js

// æ›´æ–°æ•æ‰ä½ç½®
_updateSnapPosition(point) {
    var canvasPoint = HSApp.View.SVG.Util.ModelPointToCanvas([point.x, point.y]);
    this.snapPosition = new HSCore.Util.Math.Vec2(canvasPoint[0], canvasPoint[1]);
}

// çº¿æ®µæœ€è¿‘ç‚¹æ•æ‰
var closestPoint = GeLib.LineUtils.getClosestPointOfSegment(line, point);
```

### 7.2 è¿½è¸ªæ¨¡å¼

```javascript
// è·Ÿè¸ªç»˜åˆ¶çŠ¶æ€
this.tracingPosition = HSApp.View.SVG.Util.CanvasPointToModel(this.snapPosition);

// å»¶è¿Ÿç¡®è®¤æ•æ‰(500ms)
this._tracingTimer = setTimeout(function() {
    var currentPos = HSApp.View.SVG.Util.CanvasPointToModel(snapPosition);
    if (HSCore.Util.Math.isSamePoint(tracingPosition, currentPos, 0.001)) {
        // ç¡®è®¤æ•æ‰
        snapSelected = true;
        _showSnapIndicator();
    }
}, 500);
```

### 7.3 æ­£äº¤æ¨¡å¼

**æ­£äº¤ç»˜åˆ¶**:
- é™åˆ¶ä¸ºæ°´å¹³/å‚ç›´æ–¹å‘
- 45åº¦è§’ç»˜åˆ¶
- è‡ªå®šä¹‰è§’åº¦é™åˆ¶

---

## 8. ç¼–è¾‘å·¥å…·ç³»ç»Ÿ ğŸ› ï¸

### 8.1 å˜æ¢å·¥å…·

**ç§»åŠ¨å·¥å…·**:
- æ²¿Xè½´ç§»åŠ¨
- æ²¿Yè½´ç§»åŠ¨
- è‡ªç”±ç§»åŠ¨
- ç²¾ç¡®è¾“å…¥åæ ‡

**æ—‹è½¬å·¥å…·**:
- ç»•ä¸­å¿ƒæ—‹è½¬
- ç»•ä»»æ„ç‚¹æ—‹è½¬
- ç²¾ç¡®è§’åº¦è¾“å…¥

**ç¼©æ”¾å·¥å…·**:
- ç­‰æ¯”ç¼©æ”¾
- éç­‰æ¯”ç¼©æ”¾
- é•œåƒç¿»è½¬

### 8.2 ä¿®æ”¹å·¥å…·

